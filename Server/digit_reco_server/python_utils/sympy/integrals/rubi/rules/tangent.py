from sympy.external import import_module
matchpy = import_module("matchpy")
from sympy.utilities.decorator import doctest_depends_on

if matchpy:
    from matchpy import Pattern, ReplacementRule, CustomConstraint
    from sympy.integrals.rubi.utility_function import (Int, Set, With, Module, Scan, MapAnd, FalseQ, ZeroQ, NegativeQ, NonzeroQ, FreeQ, NFreeQ, List, Log, PositiveQ, PositiveIntegerQ, NegativeIntegerQ, IntegerQ, IntegersQ, ComplexNumberQ, PureComplexNumberQ, RealNumericQ, PositiveOrZeroQ, NegativeOrZeroQ, FractionOrNegativeQ, NegQ, Equal, Unequal, IntPart, FracPart, RationalQ, ProductQ, SumQ, NonsumQ, Subst, First, Rest, SqrtNumberQ, SqrtNumberSumQ, LinearQ, Sqrt, ArcCosh, Coefficient, Denominator, Hypergeometric2F1, Not, Simplify, FractionalPart, IntegerPart, AppellF1, EllipticPi, EllipticE, EllipticF, ArcTan, ArcCot, ArcCoth, ArcTanh, ArcSin, ArcSinh, ArcCos, ArcCsc, ArcSec, ArcCsch, ArcSech, Sinh, Tanh, Cosh, Sech, Csch, Coth, LessEqual, Less, Greater, GreaterEqual, FractionQ, IntLinearcQ, Expand, IndependentQ, PowerQ, IntegerPowerQ, PositiveIntegerPowerQ, FractionalPowerQ, AtomQ, ExpQ, LogQ, Head, MemberQ, TrigQ, SinQ, CosQ, TanQ, CotQ, SecQ, CscQ, Sin, Cos, Tan, Cot, Sec, Csc, HyperbolicQ, SinhQ, CoshQ, TanhQ, CothQ, SechQ, CschQ, InverseTrigQ, SinCosQ, SinhCoshQ, LeafCount, Numerator, NumberQ, NumericQ, Length, ListQ, Im, Re, InverseHyperbolicQ, InverseFunctionQ, TrigHyperbolicFreeQ, InverseFunctionFreeQ, RealQ, EqQ, FractionalPowerFreeQ, ComplexFreeQ, PolynomialQ, FactorSquareFree, PowerOfLinearQ, Exponent, QuadraticQ, LinearPairQ, BinomialParts, TrinomialParts, PolyQ, EvenQ, OddQ, PerfectSquareQ, NiceSqrtAuxQ, NiceSqrtQ, Together, PosAux, PosQ, CoefficientList, ReplaceAll, ExpandLinearProduct, GCD, ContentFactor, NumericFactor, NonnumericFactors, MakeAssocList, GensymSubst, KernelSubst, ExpandExpression, Apart, SmartApart, MatchQ, PolynomialQuotientRemainder, FreeFactors, NonfreeFactors, RemoveContentAux, RemoveContent, FreeTerms, NonfreeTerms, ExpandAlgebraicFunction, CollectReciprocals, ExpandCleanup, AlgebraicFunctionQ, Coeff, LeadTerm, RemainingTerms, LeadFactor, RemainingFactors, LeadBase, LeadDegree, Numer, Denom, hypergeom, Expon, MergeMonomials, PolynomialDivide, BinomialQ, TrinomialQ, GeneralizedBinomialQ, GeneralizedTrinomialQ, FactorSquareFreeList, PerfectPowerTest, SquareFreeFactorTest, RationalFunctionQ, RationalFunctionFactors, NonrationalFunctionFactors, Reverse, RationalFunctionExponents, RationalFunctionExpand, ExpandIntegrand, SimplerQ, SimplerSqrtQ, SumSimplerQ, BinomialDegree, TrinomialDegree, CancelCommonFactors, SimplerIntegrandQ, GeneralizedBinomialDegree, GeneralizedBinomialParts, GeneralizedTrinomialDegree, GeneralizedTrinomialParts, MonomialQ, MonomialSumQ, MinimumMonomialExponent, MonomialExponent, LinearMatchQ, PowerOfLinearMatchQ, QuadraticMatchQ, CubicMatchQ, BinomialMatchQ, TrinomialMatchQ, GeneralizedBinomialMatchQ, GeneralizedTrinomialMatchQ, QuotientOfLinearsMatchQ, PolynomialTermQ, PolynomialTerms, NonpolynomialTerms, PseudoBinomialParts, NormalizePseudoBinomial, PseudoBinomialPairQ, PseudoBinomialQ, PolynomialGCD, PolyGCD, AlgebraicFunctionFactors, NonalgebraicFunctionFactors, QuotientOfLinearsP, QuotientOfLinearsParts, QuotientOfLinearsQ, Flatten, Sort, AbsurdNumberQ, AbsurdNumberFactors, NonabsurdNumberFactors, SumSimplerAuxQ, Prepend, Drop, CombineExponents, FactorInteger, FactorAbsurdNumber, SubstForInverseFunction, SubstForFractionalPower, SubstForFractionalPowerOfQuotientOfLinears, FractionalPowerOfQuotientOfLinears, SubstForFractionalPowerQ, SubstForFractionalPowerAuxQ, FractionalPowerOfSquareQ, FractionalPowerSubexpressionQ, Apply, FactorNumericGcd, MergeableFactorQ, MergeFactor, MergeFactors, TrigSimplifyQ, TrigSimplify, TrigSimplifyRecur, Order, FactorOrder, Smallest, OrderedQ, MinimumDegree, PositiveFactors, Sign, NonpositiveFactors, PolynomialInAuxQ, PolynomialInQ, ExponentInAux, ExponentIn, PolynomialInSubstAux, PolynomialInSubst, Distrib, DistributeDegree, FunctionOfPower, DivideDegreesOfFactors, MonomialFactor, FullSimplify, FunctionOfLinearSubst, FunctionOfLinear, NormalizeIntegrand, NormalizeIntegrandAux, NormalizeIntegrandFactor, NormalizeIntegrandFactorBase, NormalizeTogether, NormalizeLeadTermSigns, AbsorbMinusSign, NormalizeSumFactors, SignOfFactor, NormalizePowerOfLinear, SimplifyIntegrand, SimplifyTerm, TogetherSimplify, SmartSimplify, SubstForExpn, ExpandToSum, UnifySum, UnifyTerms, UnifyTerm, CalculusQ, FunctionOfInverseLinear, PureFunctionOfSinhQ, PureFunctionOfTanhQ, PureFunctionOfCoshQ, IntegerQuotientQ, OddQuotientQ, EvenQuotientQ, FindTrigFactor, FunctionOfSinhQ, FunctionOfCoshQ, OddHyperbolicPowerQ, FunctionOfTanhQ, FunctionOfTanhWeight, FunctionOfHyperbolicQ, SmartNumerator, SmartDenominator, SubstForAux, ActivateTrig, ExpandTrig, TrigExpand, SubstForTrig, SubstForHyperbolic, InertTrigFreeQ, LCM, SubstForFractionalPowerOfLinear, FractionalPowerOfLinear, InverseFunctionOfLinear, InertTrigQ, InertReciprocalQ, DeactivateTrig, FixInertTrigFunction, DeactivateTrigAux, PowerOfInertTrigSumQ, PiecewiseLinearQ, KnownTrigIntegrandQ, KnownSineIntegrandQ, KnownTangentIntegrandQ, KnownCotangentIntegrandQ, KnownSecantIntegrandQ, TryPureTanSubst, TryTanhSubst, TryPureTanhSubst, AbsurdNumberGCD, AbsurdNumberGCDList, ExpandTrigExpand, ExpandTrigReduce, ExpandTrigReduceAux, NormalizeTrig, TrigToExp, ExpandTrigToExp, TrigReduce, FunctionOfTrig, AlgebraicTrigFunctionQ, FunctionOfHyperbolic, FunctionOfQ, FunctionOfExpnQ, PureFunctionOfSinQ, PureFunctionOfCosQ, PureFunctionOfTanQ, PureFunctionOfCotQ, FunctionOfCosQ, FunctionOfSinQ, OddTrigPowerQ, FunctionOfTanQ, FunctionOfTanWeight, FunctionOfTrigQ, FunctionOfDensePolynomialsQ, FunctionOfLog, PowerVariableExpn, PowerVariableDegree, PowerVariableSubst, EulerIntegrandQ, FunctionOfSquareRootOfQuadratic, SquareRootOfQuadraticSubst, Divides, EasyDQ, ProductOfLinearPowersQ, Rt, NthRoot, AtomBaseQ, SumBaseQ, NegSumBaseQ, AllNegTermQ, SomeNegTermQ, TrigSquareQ, RtAux, TrigSquare, IntSum, IntTerm, Map2, ConstantFactor, SameQ, ReplacePart, CommonFactors, MostMainFactorPosition, FunctionOfExponentialQ, FunctionOfExponential, FunctionOfExponentialFunction, FunctionOfExponentialFunctionAux, FunctionOfExponentialTest, FunctionOfExponentialTestAux, stdev, rubi_test, If, IntQuadraticQ, IntBinomialQ, RectifyTangent, RectifyCotangent, Inequality, Condition, Simp, SimpHelp, SplitProduct, SplitSum, SubstFor, SubstForAux, FresnelS, FresnelC, Erfc, Erfi, Gamma, FunctionOfTrigOfLinearQ, ElementaryFunctionQ, Complex, UnsameQ, _SimpFixFactor, SimpFixFactor, _FixSimplify, FixSimplify, _SimplifyAntiderivativeSum, SimplifyAntiderivativeSum, _SimplifyAntiderivative, SimplifyAntiderivative, _TrigSimplifyAux, TrigSimplifyAux, Cancel, Part, PolyLog, D, Dist)
    from sympy import Integral, S, sqrt
    from sympy.integrals.rubi.symbol import WC
    from sympy.core.symbol import symbols, Symbol
    from sympy.functions import (log, sin, cos, tan, cot, csc, sec, sqrt, erf, exp, log)
    from sympy.functions.elementary.hyperbolic import (acosh, asinh, atanh, acoth, acsch, asech, cosh, sinh, tanh, coth, sech, csch)
    from sympy.functions.elementary.trigonometric import (atan, acsc, asin, acot, acos, asec)

    A_, B_, C_, F_, G_, H_, a_, b_, c_, d_, e_, f_, g_, h_, i_, j_, k_, l_, m_, n_, p_, q_, r_, t_, u_, v_, s_, w_, x_, y_, z_ = [WC(i) for i in 'ABCFGHabcdefghijklmnpqrtuvswxyz']
    a1_, a2_, b1_, b2_, c1_, c2_, d1_, d2_, n1_, n2_, e1_, e2_, f1_, f2_, g1_, g2_, n1_, n2_, n3_, Pq_, Pm_, Px_, Qm_, Qr_, Qx_, jn_, mn_, non2_, RFx_, RGx_ = [WC(i) for i in ['a1', 'a2', 'b1', 'b2', 'c1', 'c2', 'd1', 'd2', 'n1', 'n2', 'e1', 'e2', 'f1', 'f2', 'g1', 'g2', 'n1', 'n2', 'n3', 'Pq', 'Pm', 'Px', 'Qm', 'Qr', 'Qx', 'jn', 'mn', 'non2', 'RFx', 'RGx']]

    _UseGamma = False

def tangent(rubi):

    pattern1 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m + n + S(-1))))
    rule1 = ReplacementRule(pattern1, lambda f, a, e, x, b, m, n : -b*(a*sin(e + f*x))**m*(b*tan(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule1)

    pattern2 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m + n + S(-1))))
    rule2 = ReplacementRule(pattern2, lambda f, a, e, x, b, m, n : b*(a*cos(e + f*x))**m*(b*cot(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule2)

    pattern3 = Pattern(Integral(sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: IntegersQ(m, n, m/S(2) + n/S(2) + S(-1)/2)))
    rule3 = ReplacementRule(pattern3, lambda f, e, x, m, n : -Subst(Int(x**(-n)*(-x**S(2) + S(1))**(m/S(2) + n/S(2) + S(-1)/2), x), x, cos(e + f*x))/f)
    rubi.add(rule3)

    pattern4 = Pattern(Integral(cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: IntegersQ(m, n, m/S(2) + n/S(2) + S(-1)/2)))
    rule4 = ReplacementRule(pattern4, lambda f, e, x, m, n : Subst(Int(x**(-n)*(-x**S(2) + S(1))**(m/S(2) + n/S(2) + S(-1)/2), x), x, sin(e + f*x))/f)
    rubi.add(rule4)

    pattern5 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule5 = ReplacementRule(pattern5, lambda f, e, x, b, m, n : b**(-m)*Int((b*tan(e + f*x))**(m + n)*sec(e + f*x)**(-m), x))
    rubi.add(rule5)

    pattern6 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule6 = ReplacementRule(pattern6, lambda f, e, x, b, m, n : b**(-m)*Int((b*cot(e + f*x))**(m + n)*csc(e + f*x)**(-m), x))
    rubi.add(rule6)

    pattern7 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: Unequal(m, S(-2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule7 = ReplacementRule(pattern7, lambda f, a, e, x, b, m, n : -b**S(2)*(m + S(2))*Int((a*sin(e + f*x))**(m + S(2))*(b*tan(e + f*x))**(n + S(-2)), x)/(a**S(2)*(n + S(-1))) + b*(a*sin(e + f*x))**(m + S(2))*(b*tan(e + f*x))**(n + S(-1))/(a**S(2)*f*(n + S(-1))))
    rubi.add(rule7)

    pattern8 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: Unequal(m, S(-2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule8 = ReplacementRule(pattern8, lambda f, a, e, x, b, m, n : -b**S(2)*(m + S(2))*Int((a*cos(e + f*x))**(m + S(2))*(b*cot(e + f*x))**(n + S(-2)), x)/(a**S(2)*(n + S(-1))) - b*(a*cos(e + f*x))**(m + S(2))*(b*cot(e + f*x))**(n + S(-1))/(a**S(2)*f*(n + S(-1))))
    rubi.add(rule8)

    pattern9 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Not(RationalQ(m) & Greater(m, S(1)) & Not(IntegerQ(m/S(2) + S(-1)/2)))))
    rule9 = ReplacementRule(pattern9, lambda f, a, e, b, x, m, n : -b**S(2)*(m + n + S(-1))*Int((a*sin(e + f*x))**m*(b*tan(e + f*x))**(n + S(-2)), x)/(n + S(-1)) + b*(a*sin(e + f*x))**m*(b*tan(e + f*x))**(n + S(-1))/(f*(n + S(-1))))
    rubi.add(rule9)

    pattern10 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Not(RationalQ(m) & Greater(m, S(1)) & Not(IntegerQ(m/S(2) + S(-1)/2)))))
    rule10 = ReplacementRule(pattern10, lambda f, a, e, b, x, m, n : -b**S(2)*(m + n + S(-1))*Int((a*cos(e + f*x))**m*(b*cot(e + f*x))**(n + S(-2)), x)/(n + S(-1)) - b*(a*cos(e + f*x))**m*(b*cot(e + f*x))**(n + S(-1))/(f*(n + S(-1))))
    rubi.add(rule10)

    pattern11 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule11 = ReplacementRule(pattern11, lambda f, a, e, x, b, m, n : -a**S(2)*(n + S(1))*Int((a*sin(e + f*x))**(m + S(-2))*(b*tan(e + f*x))**(n + S(2)), x)/(b**S(2)*m) + (a*sin(e + f*x))**m*(b*tan(e + f*x))**(n + S(1))/(b*f*m))
    rubi.add(rule11)

    pattern12 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule12 = ReplacementRule(pattern12, lambda f, a, e, x, b, m, n : -a**S(2)*(n + S(1))*Int((a*cos(e + f*x))**(m + S(-2))*(b*cot(e + f*x))**(n + S(2)), x)/(b**S(2)*m) - (a*cos(e + f*x))**m*(b*cot(e + f*x))**(n + S(1))/(b*f*m))
    rubi.add(rule12)

    pattern13 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule13 = ReplacementRule(pattern13, lambda f, a, e, b, x, m, n : (a*sin(e + f*x))**m*(b*tan(e + f*x))**(n + S(1))/(b*f*(m + n + S(1))) - (n + S(1))*Int((a*sin(e + f*x))**m*(b*tan(e + f*x))**(n + S(2)), x)/(b**S(2)*(m + n + S(1))))
    rubi.add(rule13)

    pattern14 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule14 = ReplacementRule(pattern14, lambda f, a, e, b, x, m, n : -(a*cos(e + f*x))**m*(b*cot(e + f*x))**(n + S(1))/(b*f*(m + n + S(1))) - (n + S(1))*Int((a*cos(e + f*x))**m*(b*cot(e + f*x))**(n + S(2)), x)/(b**S(2)*(m + n + S(1))))
    rubi.add(rule14)

    pattern15 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: GreaterEqual(m, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule15 = ReplacementRule(pattern15, lambda f, a, e, b, x, m, n : a**S(2)*(m + n + S(-1))*Int((a*sin(e + f*x))**(m + S(-2))*(b*tan(e + f*x))**n, x)/m - b*(a*sin(e + f*x))**m*(b*tan(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule15)

    pattern16 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: GreaterEqual(m, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule16 = ReplacementRule(pattern16, lambda f, a, e, b, x, m, n : a**S(2)*(m + n + S(-1))*Int((a*cos(e + f*x))**(m + S(-2))*(b*cot(e + f*x))**n, x)/m + b*(a*cos(e + f*x))**m*(b*cot(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule16)

    pattern17 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule17 = ReplacementRule(pattern17, lambda f, a, e, b, x, m, n : b*(a*sin(e + f*x))**(m + S(2))*(b*tan(e + f*x))**(n + S(-1))/(a**S(2)*f*(m + n + S(1))) + (m + S(2))*Int((a*sin(e + f*x))**(m + S(2))*(b*tan(e + f*x))**n, x)/(a**S(2)*(m + n + S(1))))
    rubi.add(rule17)

    pattern18 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule18 = ReplacementRule(pattern18, lambda f, a, e, b, x, m, n : -b*(a*cos(e + f*x))**(m + S(2))*(b*cot(e + f*x))**(n + S(-1))/(a**S(2)*f*(m + n + S(1))) + (m + S(2))*Int((a*cos(e + f*x))**(m + S(2))*(b*cot(e + f*x))**n, x)/(a**S(2)*(m + n + S(1))))
    rubi.add(rule18)

    pattern19 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n/S(2) + S(1)/2)))
    rule19 = ReplacementRule(pattern19, lambda f, a, e, x, m, n : Subst(Int(x**(m + n)*(a**S(2) - x**S(2))**(-n/S(2) + S(-1)/2), x), x, a*sin(e + f*x))/f)
    rubi.add(rule19)

    pattern20 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n/S(2) + S(1)/2)))
    rule20 = ReplacementRule(pattern20, lambda f, a, e, x, m, n : -Subst(Int(x**(m + n)*(a**S(2) - x**S(2))**(-n/S(2) + S(-1)/2), x), x, a*cos(e + f*x))/f)
    rubi.add(rule20)

    pattern21 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: Not(IntegersQ(S(2)*m, S(2)*n))))
    rule21 = ReplacementRule(pattern21, lambda f, a, e, b, x, m, n : a**(-S(2)*IntPart(n/S(2) + S(1)/2) + S(1))*b**(S(2)*IntPart(n/S(2) + S(1)/2) + S(-1))*(a*sin(e + f*x))**(-S(2)*FracPart(n/S(2) + S(1)/2))*(b*tan(e + f*x))**(S(2)*FracPart(n/S(2) + S(1)/2))*(cos(e + f*x)**S(2))**FracPart(n/S(2) + S(1)/2)*Subst(Int((a*x)**(m + n)*(-x**S(2) + S(1))**(-n/S(2) + S(-1)/2), x), x, sin(e + f*x))/f)
    rubi.add(rule21)

    pattern22 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: Not(IntegersQ(S(2)*m, S(2)*n))))
    rule22 = ReplacementRule(pattern22, lambda f, a, e, b, x, m, n : -a**(-S(2)*IntPart(n/S(2) + S(1)/2) + S(1))*b**(S(2)*IntPart(n/S(2) + S(1)/2) + S(-1))*(a*cos(e + f*x))**(-S(2)*FracPart(n/S(2) + S(1)/2))*(b*cot(e + f*x))**(S(2)*FracPart(n/S(2) + S(1)/2))*(sin(e + f*x)**S(2))**FracPart(n/S(2) + S(1)/2)*Subst(Int((a*x)**(m + n)*(-x**S(2) + S(1))**(-n/S(2) + S(-1)/2), x), x, cos(e + f*x))/f)
    rubi.add(rule22)

    pattern23 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule23 = ReplacementRule(pattern23, lambda f, a, e, x, b, m, n : (sec(e + f*x)/a)**FracPart(m)*(a*cos(e + f*x))**FracPart(m)*Int((sec(e + f*x)/a)**(-m)*(b*tan(e + f*x))**n, x))
    rubi.add(rule23)

    pattern24 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule24 = ReplacementRule(pattern24, lambda f, a, e, x, b, m, n : (csc(e + f*x)/a)**FracPart(m)*(a*sin(e + f*x))**FracPart(m)*Int((csc(e + f*x)/a)**(-m)*(b*cot(e + f*x))**n, x))
    rubi.add(rule24)

    pattern25 = Pattern(Integral((WC('a', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule25 = ReplacementRule(pattern25, lambda f, a, e, x, b, m, n : (a*cot(e + f*x))**m*(b*tan(e + f*x))**m*Int((b*tan(e + f*x))**(-m + n), x))
    rubi.add(rule25)

    pattern26 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1))))
    rule26 = ReplacementRule(pattern26, lambda f, a, e, b, x, m, n : -(a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(1))/(b*f*m))
    rubi.add(rule26)

    pattern27 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1))))
    rule27 = ReplacementRule(pattern27, lambda f, a, e, b, x, m, n : (a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(1))/(b*f*m))
    rubi.add(rule27)

    pattern28 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n/S(2) + S(-1)/2)), CustomConstraint(lambda m, n: Not(IntegerQ(m/S(2)) & Less(S(0), m, n + S(1)))))
    rule28 = ReplacementRule(pattern28, lambda f, a, e, b, x, m, n : a*Subst(Int((a*x)**(m + S(-1))*(x**S(2) + S(-1))**(n/S(2) + S(-1)/2), x), x, sec(e + f*x))/f)
    rubi.add(rule28)

    pattern29 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n/S(2) + S(-1)/2)), CustomConstraint(lambda m, n: Not(IntegerQ(m/S(2)) & Less(S(0), m, n + S(1)))))
    rule29 = ReplacementRule(pattern29, lambda f, a, e, b, x, m, n : -a*Subst(Int((a*x)**(m + S(-1))*(x**S(2) + S(-1))**(n/S(2) + S(-1)/2), x), x, csc(e + f*x))/f)
    rubi.add(rule29)

    pattern30 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))), CustomConstraint(lambda m, n: Not(IntegerQ(n/S(2) + S(-1)/2) & Less(S(0), n, m + S(-1)))))
    rule30 = ReplacementRule(pattern30, lambda f, e, x, b, m, n : Subst(Int((b*x)**n*(x**S(2) + S(1))**(m/S(2) + S(-1)), x), x, tan(e + f*x))/f)
    rubi.add(rule30)

    pattern31 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))), CustomConstraint(lambda m, n: Not(IntegerQ(n/S(2) + S(-1)/2) & Less(S(0), n, m + S(-1)))))
    rule31 = ReplacementRule(pattern31, lambda f, e, x, b, m, n : -Subst(Int((b*x)**n*(x**S(2) + S(1))**(m/S(2) + S(-1)), x), x, cot(e + f*x))/f)
    rubi.add(rule31)

    pattern32 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: Greater(m, S(1)) | (Equal(m, S(1)) & Equal(n, S(-3)/2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule32 = ReplacementRule(pattern32, lambda f, a, e, b, x, m, n : a**S(2)*(a*sec(e + f*x))**(m + S(-2))*(b*tan(e + f*x))**(n + S(1))/(b*f*(n + S(1))) - a**S(2)*(m + S(-2))*Int((a*sec(e + f*x))**(m + S(-2))*(b*tan(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule32)

    pattern33 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: Greater(m, S(1)) | (Equal(m, S(1)) & Equal(n, S(-3)/2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule33 = ReplacementRule(pattern33, lambda f, a, e, b, x, m, n : -a**S(2)*(a*csc(e + f*x))**(m + S(-2))*(b*cot(e + f*x))**(n + S(1))/(b*f*(n + S(1))) - a**S(2)*(m + S(-2))*Int((a*csc(e + f*x))**(m + S(-2))*(b*cot(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule33)

    pattern34 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule34 = ReplacementRule(pattern34, lambda f, a, e, b, x, m, n : (a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(1))/(b*f*(n + S(1))) - (m + n + S(1))*Int((a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule34)

    pattern35 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule35 = ReplacementRule(pattern35, lambda f, a, e, b, x, m, n : -(a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(1))/(b*f*(n + S(1))) - (m + n + S(1))*Int((a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule35)

    pattern36 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: Less(m, S(-1)) | (Equal(m, S(-1)) & Equal(n, S(3)/2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule36 = ReplacementRule(pattern36, lambda f, a, e, x, b, m, n : b*(a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(-1))/(f*m) - b**S(2)*(n + S(-1))*Int((a*sec(e + f*x))**(m + S(2))*(b*tan(e + f*x))**(n + S(-2)), x)/(a**S(2)*m))
    rubi.add(rule36)

    pattern37 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: Less(m, S(-1)) | (Equal(m, S(-1)) & Equal(n, S(3)/2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule37 = ReplacementRule(pattern37, lambda f, a, e, x, b, m, n : -b*(a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(-1))/(f*m) - b**S(2)*(n + S(-1))*Int((a*csc(e + f*x))**(m + S(2))*(b*cot(e + f*x))**(n + S(-2)), x)/(a**S(2)*m))
    rubi.add(rule37)

    pattern38 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule38 = ReplacementRule(pattern38, lambda f, a, e, b, x, m, n : -b**S(2)*(n + S(-1))*Int((a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(-2)), x)/(m + n + S(-1)) + b*(a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule38)

    pattern39 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule39 = ReplacementRule(pattern39, lambda f, a, e, b, x, m, n : -b**S(2)*(n + S(-1))*Int((a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(-2)), x)/(m + n + S(-1)) - b*(a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule39)

    pattern40 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m, n: Less(m, S(-1)) | (RationalQ(n) & Equal(m, S(-1)) & Equal(n, S(-1)/2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule40 = ReplacementRule(pattern40, lambda f, a, e, x, b, m, n : -(a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(1))/(b*f*m) + (m + n + S(1))*Int((a*sec(e + f*x))**(m + S(2))*(b*tan(e + f*x))**n, x)/(a**S(2)*m))
    rubi.add(rule40)

    pattern41 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m, n: Less(m, S(-1)) | (RationalQ(n) & Equal(m, S(-1)) & Equal(n, S(-1)/2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule41 = ReplacementRule(pattern41, lambda f, a, e, x, b, m, n : (a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(1))/(b*f*m) + (m + n + S(1))*Int((a*csc(e + f*x))**(m + S(2))*(b*cot(e + f*x))**n, x)/(a**S(2)*m))
    rubi.add(rule41)

    pattern42 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m, n: Greater(m, S(1)) | (RationalQ(n) & Equal(m, S(1)) & Equal(n, S(1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule42 = ReplacementRule(pattern42, lambda f, a, e, b, x, m, n : a**S(2)*(m + S(-2))*Int((a*sec(e + f*x))**(m + S(-2))*(b*tan(e + f*x))**n, x)/(m + n + S(-1)) + a**S(2)*(a*sec(e + f*x))**(m + S(-2))*(b*tan(e + f*x))**(n + S(1))/(b*f*(m + n + S(-1))))
    rubi.add(rule42)

    pattern43 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m, n: Greater(m, S(1)) | (RationalQ(n) & Equal(m, S(1)) & Equal(n, S(1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule43 = ReplacementRule(pattern43, lambda f, a, e, b, x, m, n : a**S(2)*(m + S(-2))*Int((a*csc(e + f*x))**(m + S(-2))*(b*cot(e + f*x))**n, x)/(m + n + S(-1)) - a**S(2)*(a*csc(e + f*x))**(m + S(-2))*(b*cot(e + f*x))**(n + S(1))/(b*f*(m + n + S(-1))))
    rubi.add(rule43)

    pattern44 = Pattern(Integral(sec(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule44 = ReplacementRule(pattern44, lambda x, e, f, b : Int(S(1)/(sqrt(sin(e + f*x))*sqrt(cos(e + f*x))), x)*sqrt(sin(e + f*x))/(sqrt(b*tan(e + f*x))*sqrt(cos(e + f*x))))
    rubi.add(rule44)

    pattern45 = Pattern(Integral(csc(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule45 = ReplacementRule(pattern45, lambda x, e, f, b : Int(S(1)/(sqrt(sin(e + f*x))*sqrt(cos(e + f*x))), x)*sqrt(cos(e + f*x))/(sqrt(b*cot(e + f*x))*sqrt(sin(e + f*x))))
    rubi.add(rule45)

    pattern46 = Pattern(Integral(sqrt(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sec(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule46 = ReplacementRule(pattern46, lambda x, e, f, b : sqrt(b*tan(e + f*x))*Int(sqrt(sin(e + f*x))*sqrt(cos(e + f*x)), x)*sqrt(cos(e + f*x))/sqrt(sin(e + f*x)))
    rubi.add(rule46)

    pattern47 = Pattern(Integral(sqrt(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/csc(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule47 = ReplacementRule(pattern47, lambda x, e, f, b : sqrt(b*cot(e + f*x))*Int(sqrt(sin(e + f*x))*sqrt(cos(e + f*x)), x)*sqrt(sin(e + f*x))/sqrt(cos(e + f*x)))
    rubi.add(rule47)

    pattern48 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: IntegerQ(n + S(1)/2)), CustomConstraint(lambda m: IntegerQ(m + S(1)/2)))
    rule48 = ReplacementRule(pattern48, lambda f, a, e, x, b, m, n : a**(m + n)*(a*sec(e + f*x))**(-n)*(b*sin(e + f*x))**(-n)*(b*tan(e + f*x))**n*Int((b*sin(e + f*x))**n*cos(e + f*x)**(-m - n), x))
    rubi.add(rule48)

    pattern49 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: IntegerQ(n + S(1)/2)), CustomConstraint(lambda m: IntegerQ(m + S(1)/2)))
    rule49 = ReplacementRule(pattern49, lambda f, a, e, x, b, m, n : a**(m + n)*(a*csc(e + f*x))**(-n)*(b*cos(e + f*x))**(-n)*(b*cot(e + f*x))**n*Int((b*cos(e + f*x))**n*sin(e + f*x)**(-m - n), x))
    rubi.add(rule49)

    pattern50 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n/S(2) + S(-1)/2))), CustomConstraint(lambda m: Not(IntegerQ(m/S(2)))))
    rule50 = ReplacementRule(pattern50, lambda f, a, e, b, x, m, n : (a*sec(e + f*x))**m*(b*tan(e + f*x))**(n + S(1))*(cos(e + f*x)**S(2))**(m/S(2) + n/S(2) + S(1)/2)*Hypergeometric2F1(n/S(2) + S(1)/2, m/S(2) + n/S(2) + S(1)/2, n/S(2) + S(3)/2, sin(e + f*x)**S(2))/(b*f*(n + S(1))))
    rubi.add(rule50)

    pattern51 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n/S(2) + S(-1)/2))), CustomConstraint(lambda m: Not(IntegerQ(m/S(2)))))
    rule51 = ReplacementRule(pattern51, lambda f, a, e, b, x, m, n : -(a*csc(e + f*x))**m*(b*cot(e + f*x))**(n + S(1))*(sin(e + f*x)**S(2))**(m/S(2) + n/S(2) + S(1)/2)*Hypergeometric2F1(n/S(2) + S(1)/2, m/S(2) + n/S(2) + S(1)/2, n/S(2) + S(3)/2, cos(e + f*x)**S(2))/(b*f*(n + S(1))))
    rubi.add(rule51)

    pattern52 = Pattern(Integral((WC('a', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule52 = ReplacementRule(pattern52, lambda f, a, e, x, b, m, n : (sin(e + f*x)/a)**FracPart(m)*(a*csc(e + f*x))**FracPart(m)*Int((sin(e + f*x)/a)**(-m)*(b*tan(e + f*x))**n, x))
    rubi.add(rule52)

    pattern53 = Pattern(Integral((WC('a', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule53 = ReplacementRule(pattern53, lambda f, a, e, x, b, m, n : (cos(e + f*x)/a)**FracPart(m)*(a*sec(e + f*x))**FracPart(m)*Int((cos(e + f*x)/a)**(-m)*(b*cot(e + f*x))**n, x))
    rubi.add(rule53)

    pattern54 = Pattern(Integral(((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('a', S(1)))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda p, m, n: NonzeroQ(m*p + n + S(-1))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m*p, S(2)*n)))
    rule54 = ReplacementRule(pattern54, lambda f, a, e, b, x, d, p, m, n : -b**S(2)*(n + S(-1))*Int((a*(d*sec(e + f*x))**p)**m*(b*tan(e + f*x))**(n + S(-2)), x)/(m*p + n + S(-1)) + b*(a*(d*sec(e + f*x))**p)**m*(b*tan(e + f*x))**(n + S(-1))/(f*(m*p + n + S(-1))))
    rubi.add(rule54)

    pattern55 = Pattern(Integral(((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('a', S(1)))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda p, m, n: NonzeroQ(m*p + n + S(-1))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m*p, S(2)*n)))
    rule55 = ReplacementRule(pattern55, lambda f, a, e, b, x, d, p, m, n : -b**S(2)*(n + S(-1))*Int((a*(d*csc(e + f*x))**p)**m*(b*cot(e + f*x))**(n + S(-2)), x)/(m*p + n + S(-1)) - b*(a*(d*csc(e + f*x))**p)**m*(b*cot(e + f*x))**(n + S(-1))/(f*(m*p + n + S(-1))))
    rubi.add(rule55)

    pattern56 = Pattern(Integral(((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('a', S(1)))**WC('m', S(1))*(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda p, m, n: NonzeroQ(m*p + n + S(1))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m*p, S(2)*n)))
    rule56 = ReplacementRule(pattern56, lambda f, a, e, b, x, d, p, m, n : (a*(d*sec(e + f*x))**p)**m*(b*tan(e + f*x))**(n + S(1))/(b*f*(n + S(1))) - (m*p + n + S(1))*Int((a*(d*sec(e + f*x))**p)**m*(b*tan(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule56)

    pattern57 = Pattern(Integral(((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('a', S(1)))**WC('m', S(1))*(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda p, m, n: NonzeroQ(m*p + n + S(1))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m*p, S(2)*n)))
    rule57 = ReplacementRule(pattern57, lambda f, a, e, b, x, d, p, m, n : (a*(d*csc(e + f*x))**p)**m*(b*cot(e + f*x))**(n + S(1))/(b*f*(n + S(1))) - (m*p + n + S(1))*Int((a*(d*csc(e + f*x))**p)**m*(b*cot(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule57)

    pattern58 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule58 = ReplacementRule(pattern58, lambda x, b, d, n, c : -b**S(2)*Int((b*tan(c + d*x))**(n + S(-2)), x) + b*(b*tan(c + d*x))**(n + S(-1))/(d*(n + S(-1))))
    rubi.add(rule58)

    pattern59 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule59 = ReplacementRule(pattern59, lambda x, b, d, n, c : -b**S(2)*Int((b*cot(c + d*x))**(n + S(-2)), x) - b*(b*cot(c + d*x))**(n + S(-1))/(d*(n + S(-1))))
    rubi.add(rule59)

    pattern60 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule60 = ReplacementRule(pattern60, lambda x, b, d, n, c : (b*tan(c + d*x))**(n + S(1))/(b*d*(n + S(1))) - Int((b*tan(c + d*x))**(n + S(2)), x)/b**S(2))
    rubi.add(rule60)

    pattern61 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule61 = ReplacementRule(pattern61, lambda x, b, d, n, c : -(b*cot(c + d*x))**(n + S(1))/(b*d*(n + S(1))) - Int((b*cot(c + d*x))**(n + S(2)), x)/b**S(2))
    rubi.add(rule61)

    pattern62 = Pattern(Integral(tan(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule62 = ReplacementRule(pattern62, lambda d, c, x : -log(RemoveContent(cos(c + d*x), x))/d)
    rubi.add(rule62)

    pattern63 = Pattern(Integral(cot(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule63 = ReplacementRule(pattern63, lambda d, c, x : log(RemoveContent(sin(c + d*x), x))/d)
    rubi.add(rule63)

    pattern64 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule64 = ReplacementRule(pattern64, lambda x, b, d, n, c : b*Subst(Int(x**n/(b**S(2) + x**S(2)), x), x, b*tan(c + d*x))/d)
    rubi.add(rule64)

    pattern65 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule65 = ReplacementRule(pattern65, lambda x, b, d, n, c : -b*Subst(Int(x**n/(b**S(2) + x**S(2)), x), x, b*cot(c + d*x))/d)
    rubi.add(rule65)

    pattern66 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule66 = ReplacementRule(pattern66, lambda a, x, b, d, c : S(2)*a*b*Int(tan(c + d*x), x) + b**S(2)*tan(c + d*x)/d + x*(a**S(2) - b**S(2)))
    rubi.add(rule66)

    pattern67 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule67 = ReplacementRule(pattern67, lambda a, x, b, d, c : S(2)*a*b*Int(cot(c + d*x), x) - b**S(2)*cot(c + d*x)/d + x*(a**S(2) - b**S(2)))
    rubi.add(rule67)

    pattern68 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule68 = ReplacementRule(pattern68, lambda a, x, b, d, n, c : S(2)*a*Int((a + b*tan(c + d*x))**(n + S(-1)), x) + b*(a + b*tan(c + d*x))**(n + S(-1))/(d*(n + S(-1))))
    rubi.add(rule68)

    pattern69 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule69 = ReplacementRule(pattern69, lambda a, x, b, d, n, c : S(2)*a*Int((a + b*cot(c + d*x))**(n + S(-1)), x) - b*(a + b*cot(c + d*x))**(n + S(-1))/(d*(n + S(-1))))
    rubi.add(rule69)

    pattern70 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))))
    rule70 = ReplacementRule(pattern70, lambda a, x, b, d, n, c : a*(a + b*tan(c + d*x))**n/(S(2)*b*d*n) + Int((a + b*tan(c + d*x))**(n + S(1)), x)/(S(2)*a))
    rubi.add(rule70)

    pattern71 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))))
    rule71 = ReplacementRule(pattern71, lambda a, x, b, d, n, c : -a*(a + b*cot(c + d*x))**n/(S(2)*b*d*n) + Int((a + b*cot(c + d*x))**(n + S(1)), x)/(S(2)*a))
    rubi.add(rule71)

    pattern72 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule72 = ReplacementRule(pattern72, lambda a, x, b, d, c : -S(2)*b*Subst(Int(1/(S(2)*a - x**S(2)), x), x, sqrt(a + b*tan(c + d*x)))/d)
    rubi.add(rule72)

    pattern73 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule73 = ReplacementRule(pattern73, lambda a, x, b, d, c : S(2)*b*Subst(Int(1/(S(2)*a - x**S(2)), x), x, sqrt(a + b*cot(c + d*x)))/d)
    rubi.add(rule73)

    pattern74 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule74 = ReplacementRule(pattern74, lambda a, x, b, d, n, c : -b*Subst(Int((a + x)**(n + S(-1))/(a - x), x), x, b*tan(c + d*x))/d)
    rubi.add(rule74)

    pattern75 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule75 = ReplacementRule(pattern75, lambda a, x, b, d, n, c : b*Subst(Int((a + x)**(n + S(-1))/(a - x), x), x, b*cot(c + d*x))/d)
    rubi.add(rule75)

    pattern76 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule76 = ReplacementRule(pattern76, lambda a, x, b, d, n, c : b*(a + b*tan(c + d*x))**(n + S(-1))/(d*(n + S(-1))) + Int((a + b*tan(c + d*x))**(n + S(-2))*(a**S(2) + S(2)*a*b*tan(c + d*x) - b**S(2)), x))
    rubi.add(rule76)

    pattern77 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule77 = ReplacementRule(pattern77, lambda a, x, b, d, n, c : -b*(a + b*cot(c + d*x))**(n + S(-1))/(d*(n + S(-1))) + Int((a + b*cot(c + d*x))**(n + S(-2))*(a**S(2) + S(2)*a*b*cot(c + d*x) - b**S(2)), x))
    rubi.add(rule77)

    pattern78 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule78 = ReplacementRule(pattern78, lambda a, x, b, d, n, c : b*(a + b*tan(c + d*x))**(n + S(1))/(d*(a**S(2) + b**S(2))*(n + S(1))) + Int((a - b*tan(c + d*x))*(a + b*tan(c + d*x))**(n + S(1)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule78)

    pattern79 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule79 = ReplacementRule(pattern79, lambda a, x, b, d, n, c : -b*(a + b*cot(c + d*x))**(n + S(1))/(d*(a**S(2) + b**S(2))*(n + S(1))) + Int((a - b*cot(c + d*x))*(a + b*cot(c + d*x))**(n + S(1)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule79)

    pattern80 = Pattern(Integral(1/(a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule80 = ReplacementRule(pattern80, lambda a, x, b, d, c : a*x/(a**S(2) + b**S(2)) + b*Int((-a*tan(c + d*x) + b)/(a + b*tan(c + d*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule80)

    pattern81 = Pattern(Integral(1/(a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule81 = ReplacementRule(pattern81, lambda a, x, b, d, c : a*x/(a**S(2) + b**S(2)) + b*Int((-a*cot(c + d*x) + b)/(a + b*cot(c + d*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule81)

    pattern82 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule82 = ReplacementRule(pattern82, lambda a, x, b, d, n, c : b*Subst(Int((a + x)**n/(b**S(2) + x**S(2)), x), x, b*tan(c + d*x))/d)
    rubi.add(rule82)

    pattern83 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule83 = ReplacementRule(pattern83, lambda a, x, b, d, n, c : -b*Subst(Int((a + x)**n/(b**S(2) + x**S(2)), x), x, b*cot(c + d*x))/d)
    rubi.add(rule83)

    pattern84 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m, b, a: IntegerQ(S(2)*m) | NonzeroQ(a**S(2) + b**S(2))))
    rule84 = ReplacementRule(pattern84, lambda f, a, e, b, x, d, m : a*Int((d*sec(e + f*x))**m, x) + b*(d*sec(e + f*x))**m/(f*m))
    rubi.add(rule84)

    pattern85 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m, b, a: IntegerQ(S(2)*m) | NonzeroQ(a**S(2) + b**S(2))))
    rule85 = ReplacementRule(pattern85, lambda f, a, e, b, x, d, m : a*Int((d*csc(e + f*x))**m, x) - b*(d*csc(e + f*x))**m/(f*m))
    rubi.add(rule85)

    pattern86 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sec(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule86 = ReplacementRule(pattern86, lambda f, a, e, x, b, m, n : a**(-m + S(2))*Subst(Int((a - x)**(m/S(2) + S(-1))*(a + x)**(m/S(2) + n + S(-1)), x), x, b*tan(e + f*x))/(b*f))
    rubi.add(rule86)

    pattern87 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*csc(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule87 = ReplacementRule(pattern87, lambda f, a, e, x, b, m, n : -a**(-m + S(2))*Subst(Int((a - x)**(m/S(2) + S(-1))*(a + x)**(m/S(2) + n + S(-1)), x), x, b*cot(e + f*x))/(b*f))
    rubi.add(rule87)

    pattern88 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n)))
    rule88 = ReplacementRule(pattern88, lambda f, a, e, b, x, d, m, n : b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**n/(a*f*m))
    rubi.add(rule88)

    pattern89 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n)))
    rule89 = ReplacementRule(pattern89, lambda f, a, e, b, x, d, m, n : -b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**n/(a*f*m))
    rubi.add(rule89)

    pattern90 = Pattern(Integral(sec(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule90 = ReplacementRule(pattern90, lambda f, a, e, x, b : -S(2)*a*Subst(Int(1/(-a*x**S(2) + S(2)), x), x, sec(e + f*x)/sqrt(a + b*tan(e + f*x)))/(b*f))
    rubi.add(rule90)

    pattern91 = Pattern(Integral(csc(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule91 = ReplacementRule(pattern91, lambda f, a, e, x, b : S(2)*a*Subst(Int(1/(-a*x**S(2) + S(2)), x), x, csc(e + f*x)/sqrt(a + b*cot(e + f*x)))/(b*f))
    rubi.add(rule91)

    pattern92 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule92 = ReplacementRule(pattern92, lambda f, a, e, b, x, d, m, n : a*Int((d*sec(e + f*x))**(m + S(2))*(a + b*tan(e + f*x))**(n + S(-1)), x)/(S(2)*d**S(2)) + b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**n/(a*f*m))
    rubi.add(rule92)

    pattern93 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule93 = ReplacementRule(pattern93, lambda f, a, e, b, x, d, m, n : a*Int((d*csc(e + f*x))**(m + S(2))*(a + b*cot(e + f*x))**(n + S(-1)), x)/(S(2)*d**S(2)) - b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**n/(a*f*m))
    rubi.add(rule93)

    pattern94 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule94 = ReplacementRule(pattern94, lambda f, a, e, b, x, d, m, n : S(2)*d**S(2)*(d*sec(e + f*x))**(m + S(-2))*(a + b*tan(e + f*x))**(n + S(1))/(b*f*(m + S(-2))) + S(2)*d**S(2)*Int((d*sec(e + f*x))**(m + S(-2))*(a + b*tan(e + f*x))**(n + S(1)), x)/a)
    rubi.add(rule94)

    pattern95 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule95 = ReplacementRule(pattern95, lambda f, a, e, b, x, d, m, n : -S(2)*d**S(2)*(d*csc(e + f*x))**(m + S(-2))*(a + b*cot(e + f*x))**(n + S(1))/(b*f*(m + S(-2))) + S(2)*d**S(2)*Int((d*csc(e + f*x))**(m + S(-2))*(a + b*cot(e + f*x))**(n + S(1)), x)/a)
    rubi.add(rule95)

    pattern96 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n)))
    rule96 = ReplacementRule(pattern96, lambda f, a, e, x, b, d, m, n : (a/d)**(S(2)*IntPart(n))*(d*sec(e + f*x))**(-S(2)*FracPart(n))*(a - b*tan(e + f*x))**FracPart(n)*(a + b*tan(e + f*x))**FracPart(n)*Int((a - b*tan(e + f*x))**(-n), x))
    rubi.add(rule96)

    pattern97 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n)))
    rule97 = ReplacementRule(pattern97, lambda f, a, e, x, b, d, m, n : (a/d)**(S(2)*IntPart(n))*(d*csc(e + f*x))**(-S(2)*FracPart(n))*(a - b*cot(e + f*x))**FracPart(n)*(a + b*cot(e + f*x))**FracPart(n)*Int((a - b*cot(e + f*x))**(-n), x))
    rubi.add(rule97)

    pattern98 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n + S(-1))))
    rule98 = ReplacementRule(pattern98, lambda f, a, e, b, x, d, m, n : S(2)*b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule98)

    pattern99 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m/S(2) + n + S(-1))))
    rule99 = ReplacementRule(pattern99, lambda f, a, e, b, x, d, m, n : -S(2)*b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule99)

    pattern100 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m/S(2) + n + S(-1))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule100 = ReplacementRule(pattern100, lambda f, a, e, b, x, d, m, n : a*(m + S(2)*n + S(-2))*Int((d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1)), x)/(m + n + S(-1)) + b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule100)

    pattern101 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m/S(2) + n + S(-1))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule101 = ReplacementRule(pattern101, lambda f, a, e, b, x, d, m, n : a*(m + S(2)*n + S(-2))*Int((d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1)), x)/(m + n + S(-1)) - b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule101)

    pattern102 = Pattern(Integral(sqrt(WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule102 = ReplacementRule(pattern102, lambda f, a, e, x, b, d : -S(4)*b*d**S(2)*Subst(Int(x**S(2)/(a**S(2) + d**S(2)*x**S(4)), x), x, sqrt(a + b*tan(e + f*x))/sqrt(d*sec(e + f*x)))/f)
    rubi.add(rule102)

    pattern103 = Pattern(Integral(sqrt(WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule103 = ReplacementRule(pattern103, lambda f, a, e, x, b, d : S(4)*b*d**S(2)*Subst(Int(x**S(2)/(a**S(2) + d**S(2)*x**S(4)), x), x, sqrt(a + b*cot(e + f*x))/sqrt(d*csc(e + f*x)))/f)
    rubi.add(rule103)

    pattern104 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: (Equal(m, S(-1)/2) & Equal(n, S(3)/2)) | (Equal(n, S(2)) & Less(m, S(0))) | (LessEqual(m, S(-1)) & Greater(m + n, S(0))) | (NegativeIntegerQ(m + S(-1)/2) & PositiveIntegerQ(n/S(2))) | (IntegerQ(n) & NegativeIntegerQ(m) & Less(m/S(2) + n + S(-1), S(0)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule104 = ReplacementRule(pattern104, lambda f, a, e, x, b, d, m, n : -b**S(2)*(m + S(2)*n + S(-2))*Int((d*sec(e + f*x))**(m + S(2))*(a + b*tan(e + f*x))**(n + S(-2)), x)/(d**S(2)*m) + S(2)*b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule104)

    pattern105 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: (Equal(m, S(-1)/2) & Equal(n, S(3)/2)) | (Equal(n, S(2)) & Less(m, S(0))) | (LessEqual(m, S(-1)) & Greater(m + n, S(0))) | (NegativeIntegerQ(m + S(-1)/2) & PositiveIntegerQ(n/S(2))) | (NegativeIntegerQ(m) & Less(m/S(2) + n + S(-1), S(0)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule105 = ReplacementRule(pattern105, lambda f, a, e, x, b, d, m, n : -b**S(2)*(m + S(2)*n + S(-2))*Int((d*csc(e + f*x))**(m + S(2))*(a + b*cot(e + f*x))**(n + S(-2)), x)/(d**S(2)*m) - S(2)*b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1))/(f*m))
    rubi.add(rule105)

    pattern106 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule106 = ReplacementRule(pattern106, lambda f, a, e, x, b, d, m, n : a*(m + n)*Int((d*sec(e + f*x))**(m + S(2))*(a + b*tan(e + f*x))**(n + S(-1)), x)/(d**S(2)*m) + b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**n/(a*f*m))
    rubi.add(rule106)

    pattern107 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule107 = ReplacementRule(pattern107, lambda f, a, e, x, b, d, m, n : a*(m + n)*Int((d*csc(e + f*x))**(m + S(2))*(a + b*cot(e + f*x))**(n + S(-1)), x)/(d**S(2)*m) - b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**n/(a*f*m))
    rubi.add(rule107)

    pattern108 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule108 = ReplacementRule(pattern108, lambda f, a, e, b, x, d, m, n : a*(m + S(2)*n + S(-2))*Int((d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1)), x)/(m + n + S(-1)) + b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule108)

    pattern109 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule109 = ReplacementRule(pattern109, lambda f, a, e, b, x, d, m, n : a*(m + S(2)*n + S(-2))*Int((d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1)), x)/(m + n + S(-1)) - b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule109)

    pattern110 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule110 = ReplacementRule(pattern110, lambda f, a, e, x, b, d : d*Int(sqrt(d*sec(e + f*x))*sqrt(a - b*tan(e + f*x)), x)*sec(e + f*x)/(sqrt(a - b*tan(e + f*x))*sqrt(a + b*tan(e + f*x))))
    rubi.add(rule110)

    pattern111 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule111 = ReplacementRule(pattern111, lambda f, a, e, x, b, d : d*Int(sqrt(d*csc(e + f*x))*sqrt(a - b*cot(e + f*x)), x)*csc(e + f*x)/(sqrt(a - b*cot(e + f*x))*sqrt(a + b*cot(e + f*x))))
    rubi.add(rule111)

    pattern112 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: Equal(n, S(-2)) | PositiveIntegerQ(m + n) | (NegativeIntegerQ(n/S(2)) & PositiveIntegerQ(m + S(-1)/2)) | (IntegersQ(n, m + S(1)/2) & Greater(S(2)*m + n + S(1), S(0)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule112 = ReplacementRule(pattern112, lambda f, a, e, x, b, d, m, n : S(2)*d**S(2)*(d*sec(e + f*x))**(m + S(-2))*(a + b*tan(e + f*x))**(n + S(1))/(b*f*(m + S(2)*n)) - d**S(2)*(m + S(-2))*Int((d*sec(e + f*x))**(m + S(-2))*(a + b*tan(e + f*x))**(n + S(2)), x)/(b**S(2)*(m + S(2)*n)))
    rubi.add(rule112)

    pattern113 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: Equal(n, S(-2)) | PositiveIntegerQ(m + n) | (NegativeIntegerQ(n/S(2)) & PositiveIntegerQ(m + S(-1)/2)) | (IntegersQ(n, m + S(1)/2) & Greater(S(2)*m + n + S(1), S(0)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule113 = ReplacementRule(pattern113, lambda f, a, e, x, b, d, m, n : -S(2)*d**S(2)*(d*csc(e + f*x))**(m + S(-2))*(a + b*cot(e + f*x))**(n + S(1))/(b*f*(m + S(2)*n)) - d**S(2)*(m + S(-2))*Int((d*csc(e + f*x))**(m + S(-2))*(a + b*cot(e + f*x))**(n + S(2)), x)/(b**S(2)*(m + S(2)*n)))
    rubi.add(rule113)

    pattern114 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(0))), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: Not(NegativeIntegerQ(m + n))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule114 = ReplacementRule(pattern114, lambda f, a, e, b, x, d, m, n : d**S(2)*(d*sec(e + f*x))**(m + S(-2))*(a + b*tan(e + f*x))**(n + S(1))/(b*f*(m + n + S(-1))) + d**S(2)*(m + S(-2))*Int((d*sec(e + f*x))**(m + S(-2))*(a + b*tan(e + f*x))**(n + S(1)), x)/(a*(m + n + S(-1))))
    rubi.add(rule114)

    pattern115 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(0))), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: Not(NegativeIntegerQ(m + n))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule115 = ReplacementRule(pattern115, lambda f, a, e, b, x, d, m, n : -d**S(2)*(d*csc(e + f*x))**(m + S(-2))*(a + b*cot(e + f*x))**(n + S(1))/(b*f*(m + n + S(-1))) + d**S(2)*(m + S(-2))*Int((d*csc(e + f*x))**(m + S(-2))*(a + b*cot(e + f*x))**(n + S(1)), x)/(a*(m + n + S(-1))))
    rubi.add(rule115)

    pattern116 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))), CustomConstraint(lambda m, n: NonzeroQ(m + S(2)*n)), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule116 = ReplacementRule(pattern116, lambda f, a, e, b, x, d, m, n : a*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**n/(b*f*(m + S(2)*n)) + (m + n)*Int((d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(1)), x)/(a*(m + S(2)*n)))
    rubi.add(rule116)

    pattern117 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))), CustomConstraint(lambda m, n: NonzeroQ(m + S(2)*n)), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule117 = ReplacementRule(pattern117, lambda f, a, e, b, x, d, m, n : -a*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**n/(b*f*(m + S(2)*n)) + (m + n)*Int((d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(1)), x)/(a*(m + S(2)*n)))
    rubi.add(rule117)

    pattern118 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m + n + S(-1))), CustomConstraint(lambda n: RationalQ(n)))
    rule118 = ReplacementRule(pattern118, lambda f, a, e, b, x, d, m, n : a*(m + S(2)*n + S(-2))*Int((d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1)), x)/(m + n + S(-1)) + b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule118)

    pattern119 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m + n + S(-1))), CustomConstraint(lambda n: RationalQ(n)))
    rule119 = ReplacementRule(pattern119, lambda f, a, e, b, x, d, m, n : a*(m + S(2)*n + S(-2))*Int((d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1)), x)/(m + n + S(-1)) - b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))))
    rubi.add(rule119)

    pattern120 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(m + n)), CustomConstraint(lambda m, n: NonzeroQ(m + S(2)*n)))
    rule120 = ReplacementRule(pattern120, lambda f, a, e, b, x, d, m, n : a*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))**n/(b*f*(m + S(2)*n)) + (m + n)*Int((d*sec(e + f*x))**m*(a + b*tan(e + f*x))**(n + S(1)), x)/(a*(m + S(2)*n)))
    rubi.add(rule120)

    pattern121 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(m + n)), CustomConstraint(lambda m, n: NonzeroQ(m + S(2)*n)))
    rule121 = ReplacementRule(pattern121, lambda f, a, e, b, x, d, m, n : -a*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))**n/(b*f*(m + S(2)*n)) + (m + n)*Int((d*csc(e + f*x))**m*(a + b*cot(e + f*x))**(n + S(1)), x)/(a*(m + S(2)*n)))
    rubi.add(rule121)

    pattern122 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule122 = ReplacementRule(pattern122, lambda f, a, e, b, x, d, m, n : (d*sec(e + f*x))**m*(a - b*tan(e + f*x))**(-m/S(2))*(a + b*tan(e + f*x))**(-m/S(2))*Int((a - b*tan(e + f*x))**(m/S(2))*(a + b*tan(e + f*x))**(m/S(2) + n), x))
    rubi.add(rule122)

    pattern123 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule123 = ReplacementRule(pattern123, lambda f, a, e, b, x, d, m, n : (d*csc(e + f*x))**m*(a - b*cot(e + f*x))**(-m/S(2))*(a + b*cot(e + f*x))**(-m/S(2))*Int((a - b*cot(e + f*x))**(m/S(2))*(a + b*cot(e + f*x))**(m/S(2) + n), x))
    rubi.add(rule123)

    pattern124 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sec(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule124 = ReplacementRule(pattern124, lambda f, a, e, x, b, m, n : Subst(Int((S(1) + x**S(2)/b**S(2))**(m/S(2) + S(-1))*(a + x)**n, x), x, b*tan(e + f*x))/(b*f))
    rubi.add(rule124)

    pattern125 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*csc(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule125 = ReplacementRule(pattern125, lambda f, a, e, x, b, m, n : -Subst(Int((S(1) + x**S(2)/b**S(2))**(m/S(2) + S(-1))*(a + x)**n, x), x, b*cot(e + f*x))/(b*f))
    rubi.add(rule125)

    pattern126 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**S(2)/sec(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule126 = ReplacementRule(pattern126, lambda f, a, e, x, b : -S(2)*a*b*cos(e + f*x)/f + b**S(2)*atanh(sin(e + f*x))/f + (a**S(2) - b**S(2))*sin(e + f*x)/f)
    rubi.add(rule126)

    pattern127 = Pattern(Integral((a_ + WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**S(2)/cot(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule127 = ReplacementRule(pattern127, lambda f, a, e, x, b : S(2)*a*b*sin(e + f*x)/f - b**S(2)*atanh(cos(e + f*x))/f - (a**S(2) - b**S(2))*cos(e + f*x)/f)
    rubi.add(rule127)

    pattern128 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule128 = ReplacementRule(pattern128, lambda f, a, e, b, x, d, m : b*(d*sec(e + f*x))**m*(a + b*tan(e + f*x))/(f*(m + S(1))) + Int((d*sec(e + f*x))**m*(a**S(2)*(m + S(1)) + a*b*(m + S(2))*tan(e + f*x) - b**S(2)), x)/(m + S(1)))
    rubi.add(rule128)

    pattern129 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule129 = ReplacementRule(pattern129, lambda f, a, e, b, x, d, m : -b*(d*csc(e + f*x))**m*(a + b*cot(e + f*x))/(f*(m + S(1))) + Int((d*csc(e + f*x))**m*(a**S(2)*(m + S(1)) + a*b*(m + S(2))*cot(e + f*x) - b**S(2)), x)/(m + S(1)))
    rubi.add(rule129)

    pattern130 = Pattern(Integral(sec(x_*WC('f', S(1)) + WC('e', S(0)))/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule130 = ReplacementRule(pattern130, lambda f, a, e, x, b : -Subst(Int(1/(a**S(2) + b**S(2) - x**S(2)), x), x, (-a*tan(e + f*x) + b)/sec(e + f*x))/f)
    rubi.add(rule130)

    pattern131 = Pattern(Integral(csc(x_*WC('f', S(1)) + WC('e', S(0)))/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule131 = ReplacementRule(pattern131, lambda f, a, e, x, b : Subst(Int(1/(a**S(2) + b**S(2) - x**S(2)), x), x, (-a*cot(e + f*x) + b)/csc(e + f*x))/f)
    rubi.add(rule131)

    pattern132 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m + S(-1))))
    rule132 = ReplacementRule(pattern132, lambda f, a, e, x, b, d, m : d**S(2)*(a**S(2) + b**S(2))*Int((d*sec(e + f*x))**(m + S(-2))/(a + b*tan(e + f*x)), x)/b**S(2) - d**S(2)*Int((d*sec(e + f*x))**(m + S(-2))*(a - b*tan(e + f*x)), x)/b**S(2))
    rubi.add(rule132)

    pattern133 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m + S(-1))))
    rule133 = ReplacementRule(pattern133, lambda f, a, e, x, b, d, m : d**S(2)*(a**S(2) + b**S(2))*Int((d*csc(e + f*x))**(m + S(-2))/(a + b*cot(e + f*x)), x)/b**S(2) - d**S(2)*Int((d*csc(e + f*x))**(m + S(-2))*(a - b*cot(e + f*x)), x)/b**S(2))
    rubi.add(rule133)

    pattern134 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)))
    rule134 = ReplacementRule(pattern134, lambda f, a, e, x, b, d, m : b**S(2)*Int((d*sec(e + f*x))**(m + S(2))/(a + b*tan(e + f*x)), x)/(d**S(2)*(a**S(2) + b**S(2))) + Int((d*sec(e + f*x))**m*(a - b*tan(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule134)

    pattern135 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)))
    rule135 = ReplacementRule(pattern135, lambda f, a, e, x, b, d, m : b**S(2)*Int((d*csc(e + f*x))**(m + S(2))/(a + b*cot(e + f*x)), x)/(d**S(2)*(a**S(2) + b**S(2))) + Int((d*csc(e + f*x))**m*(a - b*cot(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule135)

    pattern136 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m/S(2)))))
    rule136 = ReplacementRule(pattern136, lambda f, a, e, b, x, d, m, n : d**(S(2)*IntPart(m/S(2)))*(d*sec(e + f*x))**(S(2)*FracPart(m/S(2)))*(sec(e + f*x)**S(2))**(-FracPart(m/S(2)))*Subst(Int((S(1) + x**S(2)/b**S(2))**(m/S(2) + S(-1))*(a + x)**n, x), x, b*tan(e + f*x))/(b*f))
    rubi.add(rule136)

    pattern137 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m/S(2)))))
    rule137 = ReplacementRule(pattern137, lambda f, a, e, b, x, d, m, n : -d**(S(2)*IntPart(m/S(2)))*(d*csc(e + f*x))**(S(2)*FracPart(m/S(2)))*(csc(e + f*x)**S(2))**(-FracPart(m/S(2)))*Subst(Int((S(1) + x**S(2)/b**S(2))**(m/S(2) + S(-1))*(a + x)**n, x), x, b*cot(e + f*x))/(b*f))
    rubi.add(rule137)

    pattern138 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule138 = ReplacementRule(pattern138, lambda f, a, e, x, b, d : -S(4)*b*Subst(Int(x**S(2)/(a**S(2)*d**S(2) + x**S(4)), x), x, sqrt(d*cos(e + f*x))*sqrt(a + b*tan(e + f*x)))/f)
    rubi.add(rule138)

    pattern139 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule139 = ReplacementRule(pattern139, lambda f, a, e, x, b, d : S(4)*b*Subst(Int(x**S(2)/(a**S(2)*d**S(2) + x**S(4)), x), x, sqrt(d*sin(e + f*x))*sqrt(a + b*cot(e + f*x)))/f)
    rubi.add(rule139)

    pattern140 = Pattern(Integral(S(1)/((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule140 = ReplacementRule(pattern140, lambda f, a, e, x, b, d : Int(sqrt(a - b*tan(e + f*x))/sqrt(d*cos(e + f*x)), x)/(d*sqrt(a - b*tan(e + f*x))*sqrt(a + b*tan(e + f*x))*cos(e + f*x)))
    rubi.add(rule140)

    pattern141 = Pattern(Integral(S(1)/((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule141 = ReplacementRule(pattern141, lambda f, a, e, x, b, d : Int(sqrt(a - b*cot(e + f*x))/sqrt(d*sin(e + f*x)), x)/(d*sqrt(a - b*cot(e + f*x))*sqrt(a + b*cot(e + f*x))*sin(e + f*x)))
    rubi.add(rule141)

    pattern142 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule142 = ReplacementRule(pattern142, lambda f, a, e, b, x, d, m, n : (d*cos(e + f*x))**m*(d*sec(e + f*x))**m*Int((d*sec(e + f*x))**(-m)*(a + b*tan(e + f*x))**n, x))
    rubi.add(rule142)

    pattern143 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule143 = ReplacementRule(pattern143, lambda f, a, e, b, x, d, m, n : (d*sin(e + f*x))**m*(d*csc(e + f*x))**m*Int((d*csc(e + f*x))**(-m)*(a + b*cot(e + f*x))**n, x))
    rubi.add(rule143)

    pattern144 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule144 = ReplacementRule(pattern144, lambda f, a, e, x, b, m, n : b*Subst(Int(x**m*(a + x)**n*(b**S(2) + x**S(2))**(-m/S(2) + S(-1)), x), x, b*tan(e + f*x))/f)
    rubi.add(rule144)

    pattern145 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule145 = ReplacementRule(pattern145, lambda f, a, e, x, b, m, n : -b*Subst(Int(x**m*(a + x)**n*(b**S(2) + x**S(2))**(-m/S(2) + S(-1)), x), x, b*cot(e + f*x))/f)
    rubi.add(rule145)

    pattern146 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule146 = ReplacementRule(pattern146, lambda f, a, e, b, x, m, n : Int((a + b*tan(e + f*x))**n*sin(e + f*x)**m, x))
    rubi.add(rule146)

    pattern147 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule147 = ReplacementRule(pattern147, lambda f, a, e, b, x, m, n : Int((a + b*cot(e + f*x))**n*cos(e + f*x)**m, x))
    rubi.add(rule147)

    pattern148 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m, n: (Equal(m, S(5)) & Equal(n, S(-1))) | (Greater(n, S(-4)) & Less(m, S(5)))))
    rule148 = ReplacementRule(pattern148, lambda f, a, e, b, x, m, n : Int((a*cos(e + f*x) + b*sin(e + f*x))**n*sin(e + f*x)**m*cos(e + f*x)**(-n), x))
    rubi.add(rule148)

    pattern149 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m, n: (Equal(m, S(5)) & Equal(n, S(-1))) | (Greater(n, S(-4)) & Less(m, S(5)))))
    rule149 = ReplacementRule(pattern149, lambda f, a, e, b, x, m, n : Int((a*sin(e + f*x) + b*cos(e + f*x))**n*sin(e + f*x)**(-n)*cos(e + f*x)**m, x))
    rubi.add(rule149)

    pattern150 = Pattern(Integral((WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule150 = ReplacementRule(pattern150, lambda f, a, e, b, x, d, m, n : (sin(e + f*x)/d)**FracPart(m)*(d*csc(e + f*x))**FracPart(m)*Int((sin(e + f*x)/d)**(-m)*(a + b*tan(e + f*x))**n, x))
    rubi.add(rule150)

    pattern151 = Pattern(Integral((WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule151 = ReplacementRule(pattern151, lambda f, a, e, b, x, d, m, n : (cos(e + f*x)/d)**FracPart(m)*(d*sec(e + f*x))**FracPart(m)*Int((cos(e + f*x)/d)**(-m)*(a + b*cot(e + f*x))**n, x))
    rubi.add(rule151)

    pattern152 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule152 = ReplacementRule(pattern152, lambda f, a, e, b, x, p, m, n : Int((a*cos(e + f*x) + b*sin(e + f*x))**n*sin(e + f*x)**p*cos(e + f*x)**(m - n), x))
    rubi.add(rule152)

    pattern153 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule153 = ReplacementRule(pattern153, lambda f, a, e, b, x, p, m, n : Int((a*sin(e + f*x) + b*cos(e + f*x))**n*sin(e + f*x)**(m - n)*cos(e + f*x)**p, x))
    rubi.add(rule153)

    pattern154 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda m, n: Not(IntegerQ(n) & Greater(n, S(0)) & (Less(m, S(0)) | Less(n, m)))))
    rule154 = ReplacementRule(pattern154, lambda f, a, e, b, x, d, m, n, c : a**m*c**m*Int((c + d*tan(e + f*x))**(-m + n)*sec(e + f*x)**(S(2)*m), x))
    rubi.add(rule154)

    pattern155 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda m, n: Not(IntegerQ(n) & Greater(n, S(0)) & (Less(m, S(0)) | Less(n, m)))))
    rule155 = ReplacementRule(pattern155, lambda f, a, e, b, x, d, m, n, c : a**m*c**m*Int((c + d*cot(e + f*x))**(-m + n)*csc(e + f*x)**(S(2)*m), x))
    rubi.add(rule155)

    pattern156 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule156 = ReplacementRule(pattern156, lambda f, a, e, b, x, d, m, n, c : a*c*Subst(Int((a + b*x)**(m + S(-1))*(c + d*x)**(n + S(-1)), x), x, tan(e + f*x))/f)
    rubi.add(rule156)

    pattern157 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule157 = ReplacementRule(pattern157, lambda f, a, e, x, b, d, m, n, c : -a*c*Subst(Int((a + b*x)**(m + S(-1))*(c + d*x)**(n + S(-1)), x), x, cot(e + f*x))/f)
    rubi.add(rule157)

    pattern158 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)))
    rule158 = ReplacementRule(pattern158, lambda f, a, e, b, x, d, c : b*d*tan(e + f*x)/f + x*(a*c - b*d))
    rubi.add(rule158)

    pattern159 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)))
    rule159 = ReplacementRule(pattern159, lambda f, a, e, x, b, d, c : -b*d*cot(e + f*x)/f + x*(a*c - b*d))
    rubi.add(rule159)

    pattern160 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, d, c, b: NonzeroQ(a*d + b*c)))
    rule160 = ReplacementRule(pattern160, lambda f, a, e, b, x, d, c : b*d*tan(e + f*x)/f + x*(a*c - b*d) + (a*d + b*c)*Int(tan(e + f*x), x))
    rubi.add(rule160)

    pattern161 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, d, c, b: NonzeroQ(a*d + b*c)))
    rule161 = ReplacementRule(pattern161, lambda f, a, e, b, x, d, c : -b*d*cot(e + f*x)/f + x*(a*c - b*d) + (a*d + b*c)*Int(cot(e + f*x), x))
    rubi.add(rule161)

    pattern162 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))))
    rule162 = ReplacementRule(pattern162, lambda f, a, e, b, x, d, m, c : (a + b*tan(e + f*x))**m*(a*d - b*c)/(S(2)*a*f*m) + (a*d + b*c)*Int((a + b*tan(e + f*x))**(m + S(1)), x)/(S(2)*a*b))
    rubi.add(rule162)

    pattern163 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))))
    rule163 = ReplacementRule(pattern163, lambda f, a, e, b, x, d, m, c : (a + b*cot(e + f*x))**m*(-a*d + b*c)/(S(2)*a*f*m) + (a*d + b*c)*Int((a + b*cot(e + f*x))**(m + S(1)), x)/(S(2)*a*b))
    rubi.add(rule163)

    pattern164 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))))
    rule164 = ReplacementRule(pattern164, lambda f, a, e, b, x, d, m, c : d*(a + b*tan(e + f*x))**m/(f*m) + (a*d + b*c)*Int((a + b*tan(e + f*x))**m, x)/b)
    rubi.add(rule164)

    pattern165 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))))
    rule165 = ReplacementRule(pattern165, lambda f, a, e, b, x, d, m, c : -d*(a + b*cot(e + f*x))**m/(f*m) + (a*d + b*c)*Int((a + b*cot(e + f*x))**m, x)/b)
    rubi.add(rule165)

    pattern166 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule166 = ReplacementRule(pattern166, lambda f, a, e, b, x, d, m, c : d*(a + b*tan(e + f*x))**m/(f*m) + Int((a + b*tan(e + f*x))**(m + S(-1))*Simp(a*c - b*d + (a*d + b*c)*tan(e + f*x), x), x))
    rubi.add(rule166)

    pattern167 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule167 = ReplacementRule(pattern167, lambda f, a, e, b, x, d, m, c : -d*(a + b*cot(e + f*x))**m/(f*m) + Int((a + b*cot(e + f*x))**(m + S(-1))*Simp(a*c - b*d + (a*d + b*c)*cot(e + f*x), x), x))
    rubi.add(rule167)

    pattern168 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule168 = ReplacementRule(pattern168, lambda f, a, e, b, x, d, m, c : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(a*c + b*d - (-a*d + b*c)*tan(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*tan(e + f*x))**(m + S(1))*(-a*d + b*c)/(f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule168)

    pattern169 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule169 = ReplacementRule(pattern169, lambda f, a, e, b, x, d, m, c : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(a*c + b*d - (-a*d + b*c)*cot(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*cot(e + f*x))**(m + S(1))*(a*d - b*c)/(f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule169)

    pattern170 = Pattern(Integral((c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c, b, a: ZeroQ(a*c + b*d)))
    rule170 = ReplacementRule(pattern170, lambda f, a, e, b, x, d, c : c*log(RemoveContent(a*cos(e + f*x) + b*sin(e + f*x), x))/(b*f))
    rubi.add(rule170)

    pattern171 = Pattern(Integral((c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c, b, a: ZeroQ(a*c + b*d)))
    rule171 = ReplacementRule(pattern171, lambda f, a, e, x, b, d, c : -c*log(RemoveContent(a*sin(e + f*x) + b*cos(e + f*x), x))/(b*f))
    rubi.add(rule171)

    pattern172 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c, b, a: NonzeroQ(a*c + b*d)))
    rule172 = ReplacementRule(pattern172, lambda f, a, e, b, x, d, c : x*(a*c + b*d)/(a**S(2) + b**S(2)) + (-a*d + b*c)*Int((-a*tan(e + f*x) + b)/(a + b*tan(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule172)

    pattern173 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c, b, a: NonzeroQ(a*c + b*d)))
    rule173 = ReplacementRule(pattern173, lambda f, a, e, b, x, d, c : x*(a*c + b*d)/(a**S(2) + b**S(2)) + (-a*d + b*c)*Int((-a*cot(e + f*x) + b)/(a + b*cot(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule173)

    pattern174 = Pattern(Integral((c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule174 = ReplacementRule(pattern174, lambda f, e, x, b, d, c : -S(2)*d**S(2)*Subst(Int(1/(b*x**S(2) + S(2)*c*d), x), x, (c - d*tan(e + f*x))/sqrt(b*tan(e + f*x)))/f)
    rubi.add(rule174)

    pattern175 = Pattern(Integral((c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule175 = ReplacementRule(pattern175, lambda f, e, x, b, d, c : S(2)*d**S(2)*Subst(Int(1/(b*x**S(2) + S(2)*c*d), x), x, (c - d*cot(e + f*x))/sqrt(b*cot(e + f*x)))/f)
    rubi.add(rule175)

    pattern176 = Pattern(Integral((c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: ZeroQ(c**S(2) + d**S(2))))
    rule176 = ReplacementRule(pattern176, lambda f, e, x, b, d, c : S(2)*c**S(2)*Subst(Int(1/(b*c - d*x**S(2)), x), x, sqrt(b*tan(e + f*x)))/f)
    rubi.add(rule176)

    pattern177 = Pattern(Integral((c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: ZeroQ(c**S(2) + d**S(2))))
    rule177 = ReplacementRule(pattern177, lambda f, e, x, b, d, c : -S(2)*c**S(2)*Subst(Int(1/(b*c - d*x**S(2)), x), x, sqrt(b*cot(e + f*x)))/f)
    rubi.add(rule177)

    pattern178 = Pattern(Integral((c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule178 = ReplacementRule(pattern178, lambda f, e, x, b, d, c : S(2)*Subst(Int((b*c + d*x**S(2))/(b**S(2) + x**S(4)), x), x, sqrt(b*tan(e + f*x)))/f)
    rubi.add(rule178)

    pattern179 = Pattern(Integral((c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule179 = ReplacementRule(pattern179, lambda f, e, x, b, d, c : -S(2)*Subst(Int((b*c + d*x**S(2))/(b**S(2) + x**S(4)), x), x, sqrt(b*cot(e + f*x)))/f)
    rubi.add(rule179)

    pattern180 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda d, c, b, a: ZeroQ(S(2)*a*c*d - b*(c**S(2) - d**S(2)))))
    rule180 = ReplacementRule(pattern180, lambda f, a, e, b, x, d, c : -S(2)*d**S(2)*Subst(Int(1/(-S(4)*a*d**S(2) + S(2)*b*c*d + x**S(2)), x), x, (-S(2)*a*d + b*c - b*d*tan(e + f*x))/sqrt(a + b*tan(e + f*x)))/f)
    rubi.add(rule180)

    pattern181 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda d, c, b, a: ZeroQ(S(2)*a*c*d - b*(c**S(2) - d**S(2)))))
    rule181 = ReplacementRule(pattern181, lambda f, a, e, b, x, d, c : S(2)*d**S(2)*Subst(Int(1/(-S(4)*a*d**S(2) + S(2)*b*c*d + x**S(2)), x), x, (-S(2)*a*d + b*c - b*d*cot(e + f*x))/sqrt(a + b*cot(e + f*x)))/f)
    rubi.add(rule181)

    pattern182 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda d, c, b, a: NonzeroQ(S(2)*a*c*d - b*(c**S(2) - d**S(2)))), CustomConstraint(lambda d, c, b, a: RationalQ(a, b, c, d) | PerfectSquareQ(a**S(2) + b**S(2))), )
    def With182(f, a, e, b, x, d, c):
        q = Rt(a**S(2) + b**S(2), S(2))
        return -Int((a*c + b*d - c*q + (-a*d + b*c - d*q)*tan(e + f*x))/sqrt(a + b*tan(e + f*x)), x)/(S(2)*q) + Int((a*c + b*d + c*q + (-a*d + b*c + d*q)*tan(e + f*x))/sqrt(a + b*tan(e + f*x)), x)/(S(2)*q)
    rule182 = ReplacementRule(pattern182, lambda f, a, e, b, x, d, c : With182(f, a, e, b, x, d, c))
    rubi.add(rule182)

    pattern183 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda d, c, b, a: NonzeroQ(S(2)*a*c*d - b*(c**S(2) - d**S(2)))), CustomConstraint(lambda d, c, b, a: RationalQ(a, b, c, d) | PerfectSquareQ(a**S(2) + b**S(2))), )
    def With183(f, a, e, b, x, d, c):
        q = Rt(a**S(2) + b**S(2), S(2))
        return -Int((a*c + b*d - c*q + (-a*d + b*c - d*q)*cot(e + f*x))/sqrt(a + b*cot(e + f*x)), x)/(S(2)*q) + Int((a*c + b*d + c*q + (-a*d + b*c + d*q)*cot(e + f*x))/sqrt(a + b*cot(e + f*x)), x)/(S(2)*q)
    rule183 = ReplacementRule(pattern183, lambda f, a, e, b, x, d, c : With183(f, a, e, b, x, d, c))
    rubi.add(rule183)

    pattern184 = Pattern(Integral((c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) + d**S(2))))
    rule184 = ReplacementRule(pattern184, lambda f, a, e, b, x, d, m, c : c*d*Subst(Int((a + b*x/d)**m/(c*x + d**S(2)), x), x, d*tan(e + f*x))/f)
    rubi.add(rule184)

    pattern185 = Pattern(Integral((c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) + d**S(2))))
    rule185 = ReplacementRule(pattern185, lambda f, a, e, b, x, d, m, c : -c*d*Subst(Int((a + b*x/d)**m/(c*x + d**S(2)), x), x, d*cot(e + f*x))/f)
    rubi.add(rule185)

    pattern186 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: Not(IntegerQ(S(2)*m))))
    rule186 = ReplacementRule(pattern186, lambda f, e, x, b, d, m, c : c*Int((b*tan(e + f*x))**m, x) + d*Int((b*tan(e + f*x))**(m + S(1)), x)/b)
    rubi.add(rule186)

    pattern187 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: Not(IntegerQ(S(2)*m))))
    rule187 = ReplacementRule(pattern187, lambda f, e, x, b, d, m, c : c*Int((b*cot(e + f*x))**m, x) + d*Int((b*cot(e + f*x))**(m + S(1)), x)/b)
    rubi.add(rule187)

    pattern188 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule188 = ReplacementRule(pattern188, lambda f, a, e, b, x, d, m, c : (-ImaginaryI*d/S(2) + c/S(2))*Int((a + b*tan(e + f*x))**m*(ImaginaryI*tan(e + f*x) + S(1)), x) + (ImaginaryI*d/S(2) + c/S(2))*Int((a + b*tan(e + f*x))**m*(-ImaginaryI*tan(e + f*x) + S(1)), x))
    rubi.add(rule188)

    pattern189 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule189 = ReplacementRule(pattern189, lambda f, a, e, b, x, d, m, c : (-ImaginaryI*d/S(2) + c/S(2))*Int((a + b*cot(e + f*x))**m*(ImaginaryI*cot(e + f*x) + S(1)), x) + (ImaginaryI*d/S(2) + c/S(2))*Int((a + b*cot(e + f*x))**m*(-ImaginaryI*cot(e + f*x) + S(1)), x))
    rubi.add(rule189)

    pattern190 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule190 = ReplacementRule(pattern190, lambda f, a, e, b, x, d, m, c : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(a*c**S(2) + a*d**S(2) - S(2)*b*c*d - S(2)*b*d**S(2)*tan(e + f*x), x), x)/(S(2)*a**S(2)) - b*(a + b*tan(e + f*x))**m*(a*c + b*d)**S(2)/(S(2)*a**S(3)*f*m))
    rubi.add(rule190)

    pattern191 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule191 = ReplacementRule(pattern191, lambda f, a, e, b, x, d, m, c : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(a*c**S(2) + a*d**S(2) - S(2)*b*c*d - S(2)*b*d**S(2)*cot(e + f*x), x), x)/(S(2)*a**S(2)) + b*(a + b*cot(e + f*x))**m*(a*c + b*d)**S(2)/(S(2)*a**S(3)*f*m))
    rubi.add(rule191)

    pattern192 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**S(2)/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule192 = ReplacementRule(pattern192, lambda f, a, e, b, x, d, c : d**S(2)*Int(tan(e + f*x), x)/b + d*x*(-a*d + S(2)*b*c)/b**S(2) + (-a*d + b*c)**S(2)*Int(1/(a + b*tan(e + f*x)), x)/b**S(2))
    rubi.add(rule192)

    pattern193 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**S(2)/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule193 = ReplacementRule(pattern193, lambda f, a, e, b, x, d, c : d**S(2)*Int(cot(e + f*x), x)/b + d*x*(-a*d + S(2)*b*c)/b**S(2) + (-a*d + b*c)**S(2)*Int(1/(a + b*cot(e + f*x)), x)/b**S(2))
    rubi.add(rule193)

    pattern194 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule194 = ReplacementRule(pattern194, lambda f, a, e, b, x, d, m, c : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(a*c**S(2) - a*d**S(2) + S(2)*b*c*d - (-S(2)*a*c*d + b*c**S(2) - b*d**S(2))*tan(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*tan(e + f*x))**(m + S(1))*(-a*d + b*c)**S(2)/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule194)

    pattern195 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule195 = ReplacementRule(pattern195, lambda f, a, e, b, x, d, m, c : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(a*c**S(2) - a*d**S(2) + S(2)*b*c*d - (-S(2)*a*c*d + b*c**S(2) - b*d**S(2))*cot(e + f*x), x), x)/(a**S(2) + b**S(2)) - (a + b*cot(e + f*x))**(m + S(1))*(-a*d + b*c)**S(2)/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule195)

    pattern196 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))), CustomConstraint(lambda m, a: Not(ZeroQ(a) & ZeroQ(m + S(-2)))))
    rule196 = ReplacementRule(pattern196, lambda f, a, e, b, x, d, m, c : Int((a + b*tan(e + f*x))**m*Simp(c**S(2) + S(2)*c*d*tan(e + f*x) - d**S(2), x), x) + d**S(2)*(a + b*tan(e + f*x))**(m + S(1))/(b*f*(m + S(1))))
    rubi.add(rule196)

    pattern197 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))), CustomConstraint(lambda m, a: Not(ZeroQ(a) & ZeroQ(m + S(-2)))))
    rule197 = ReplacementRule(pattern197, lambda f, a, e, b, x, d, m, c : Int((a + b*cot(e + f*x))**m*Simp(c**S(2) + S(2)*c*d*cot(e + f*x) - d**S(2), x), x) - d**S(2)*(a + b*cot(e + f*x))**(m + S(1))/(b*f*(m + S(1))))
    rubi.add(rule197)

    pattern198 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule198 = ReplacementRule(pattern198, lambda f, a, e, b, x, d, c : -S(2)*a*b*Subst(Int(1/(-S(2)*a**S(2)*x**S(2) + a*c - b*d), x), x, sqrt(c + d*tan(e + f*x))/sqrt(a + b*tan(e + f*x)))/f)
    rubi.add(rule198)

    pattern199 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule199 = ReplacementRule(pattern199, lambda f, a, e, b, x, d, c : S(2)*a*b*Subst(Int(1/(-S(2)*a**S(2)*x**S(2) + a*c - b*d), x), x, sqrt(c + d*cot(e + f*x))/sqrt(a + b*cot(e + f*x)))/f)
    rubi.add(rule199)

    pattern200 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m, n: Equal(m + n, S(0))), CustomConstraint(lambda m: Greater(m, S(1)/2)))
    rule200 = ReplacementRule(pattern200, lambda f, a, e, b, x, d, m, n, c : S(2)*a**S(2)*Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1)), x)/(a*c - b*d) + a*b*(a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))/(f*(m + S(-1))*(a*c - b*d)))
    rubi.add(rule200)

    pattern201 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m, n: Equal(m + n, S(0))), CustomConstraint(lambda m: Greater(m, S(1)/2)))
    rule201 = ReplacementRule(pattern201, lambda f, a, e, b, x, d, m, n, c : S(2)*a**S(2)*Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1)), x)/(a*c - b*d) - a*b*(a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))/(f*(m + S(-1))*(a*c - b*d)))
    rubi.add(rule201)

    pattern202 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m, n: Equal(m + n, S(0))), CustomConstraint(lambda m: LessEqual(m, S(-1)/2)))
    rule202 = ReplacementRule(pattern202, lambda f, a, e, b, x, d, m, n, c : a*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n/(S(2)*b*f*m) - (a*c - b*d)*Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(-1)), x)/(S(2)*b**S(2)))
    rubi.add(rule202)

    pattern203 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m, n: Equal(m + n, S(0))), CustomConstraint(lambda m: LessEqual(m, S(-1)/2)))
    rule203 = ReplacementRule(pattern203, lambda f, a, e, b, x, d, m, n, c : -a*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n/(S(2)*b*f*m) - (a*c - b*d)*Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(-1)), x)/(S(2)*b**S(2)))
    rubi.add(rule203)

    pattern204 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m, n: Equal(m + n + S(1), S(0))), CustomConstraint(lambda m: Less(m, S(-1))))
    rule204 = ReplacementRule(pattern204, lambda f, a, e, b, x, d, m, n, c : a*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n, x)/(S(2)*a))
    rubi.add(rule204)

    pattern205 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m, n: Equal(m + n + S(1), S(0))), CustomConstraint(lambda m: Less(m, S(-1))))
    rule205 = ReplacementRule(pattern205, lambda f, a, e, b, x, d, m, n, c : -a*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n, x)/(S(2)*a))
    rubi.add(rule205)

    pattern206 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(-1)))))
    rule206 = ReplacementRule(pattern206, lambda f, a, e, b, x, d, m, n, c : a*Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1)), x)/(a*c - b*d) - d*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(f*m*(c**S(2) + d**S(2))))
    rubi.add(rule206)

    pattern207 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(-1)))))
    rule207 = ReplacementRule(pattern207, lambda f, a, e, b, x, d, m, n, c : a*Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1)), x)/(a*c - b*d) + d*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(f*m*(c**S(2) + d**S(2))))
    rubi.add(rule207)

    pattern208 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(S(0), n, S(1))))
    rule208 = ReplacementRule(pattern208, lambda f, a, e, b, x, d, n, c : (c + d*tan(e + f*x))**n*(-a*c - b*d)/(S(2)*f*(a + b*tan(e + f*x))*(-a*d + b*c)) + Int((c + d*tan(e + f*x))**(n + S(-1))*Simp(a*c*d*(n + S(-1)) + b*c**S(2) + b*d**S(2)*n - d*(n + S(-1))*(-a*d + b*c)*tan(e + f*x), x), x)/(S(2)*a*(-a*d + b*c)))
    rubi.add(rule208)

    pattern209 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(S(0), n, S(1))))
    rule209 = ReplacementRule(pattern209, lambda f, a, e, b, x, d, n, c : (c + d*cot(e + f*x))**n*(a*c + b*d)/(S(2)*f*(a + b*cot(e + f*x))*(-a*d + b*c)) + Int((c + d*cot(e + f*x))**(n + S(-1))*Simp(a*c*d*(n + S(-1)) + b*c**S(2) + b*d**S(2)*n - d*(n + S(-1))*(-a*d + b*c)*cot(e + f*x), x), x)/(S(2)*a*(-a*d + b*c)))
    rubi.add(rule209)

    pattern210 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule210 = ReplacementRule(pattern210, lambda f, a, e, b, x, d, n, c : (c + d*tan(e + f*x))**(n + S(-1))*(-a*d + b*c)/(S(2)*a*f*(a + b*tan(e + f*x))) + Int((c + d*tan(e + f*x))**(n + S(-2))*Simp(a*c**S(2) + a*d**S(2)*(n + S(-1)) - b*c*d*n - d*(a*c*(n + S(-2)) + b*d*n)*tan(e + f*x), x), x)/(S(2)*a**S(2)))
    rubi.add(rule210)

    pattern211 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule211 = ReplacementRule(pattern211, lambda f, a, e, b, x, d, n, c : (c + d*cot(e + f*x))**(n + S(-1))*(a*d - b*c)/(S(2)*a*f*(a + b*cot(e + f*x))) + Int((c + d*cot(e + f*x))**(n + S(-2))*Simp(a*c**S(2) + a*d**S(2)*(n + S(-1)) - b*c*d*n - d*(a*c*(n + S(-2)) + b*d*n)*cot(e + f*x), x), x)/(S(2)*a**S(2)))
    rubi.add(rule211)

    pattern212 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule212 = ReplacementRule(pattern212, lambda f, a, e, b, x, d, c : b*Int(1/(a + b*tan(e + f*x)), x)/(-a*d + b*c) - d*Int(1/(c + d*tan(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule212)

    pattern213 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule213 = ReplacementRule(pattern213, lambda f, a, e, b, x, d, c : b*Int(1/(a + b*cot(e + f*x)), x)/(-a*d + b*c) - d*Int(1/(c + d*cot(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule213)

    pattern214 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))))
    rule214 = ReplacementRule(pattern214, lambda f, a, e, b, x, d, n, c : -a*(c + d*tan(e + f*x))**(n + S(1))/(S(2)*f*(a + b*tan(e + f*x))*(-a*d + b*c)) + Int((c + d*tan(e + f*x))**n*Simp(a*d*(n + S(-1)) + b*c - b*d*n*tan(e + f*x), x), x)/(S(2)*a*(-a*d + b*c)))
    rubi.add(rule214)

    pattern215 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))))
    rule215 = ReplacementRule(pattern215, lambda f, a, e, b, x, d, n, c : a*(c + d*cot(e + f*x))**(n + S(1))/(S(2)*f*(a + b*cot(e + f*x))*(-a*d + b*c)) + Int((c + d*cot(e + f*x))**n*Simp(a*d*(n + S(-1)) + b*c - b*d*n*cot(e + f*x), x), x)/(S(2)*a*(-a*d + b*c)))
    rubi.add(rule215)

    pattern216 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule216 = ReplacementRule(pattern216, lambda f, a, e, b, x, d, m, n, c : -a**S(2)*(a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**(n + S(1))*(-a*d + b*c)/(d*f*(n + S(1))*(a*d + b*c)) + a*Int((a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**(n + S(1))*Simp(b*(-a*d*(m - S(2)*n + S(-4)) + b*c*(m + S(-2))) + (-a**S(2)*d*(m + n + S(-1)) + a*b*c*(m + S(-2)) + b**S(2)*d*(n + S(1)))*tan(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule216)

    pattern217 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule217 = ReplacementRule(pattern217, lambda f, a, e, b, x, d, m, n, c : a**S(2)*(a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**(n + S(1))*(-a*d + b*c)/(d*f*(n + S(1))*(a*d + b*c)) + a*Int((a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**(n + S(1))*Simp(b*(-a*d*(m - S(2)*n + S(-4)) + b*c*(m + S(-2))) + (-a**S(2)*d*(m + n + S(-1)) + a*b*c*(m + S(-2)) + b**S(2)*d*(n + S(1)))*cot(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule217)

    pattern218 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule218 = ReplacementRule(pattern218, lambda f, a, e, b, x, d, c : S(2)*a**S(2)*Int(sqrt(a + b*tan(e + f*x)), x)/(a*c - b*d) - (a*(c**S(2) - d**S(2)) + S(2)*b*c*d)*Int((a - b*tan(e + f*x))*sqrt(a + b*tan(e + f*x))/(c + d*tan(e + f*x)), x)/(a*(c**S(2) + d**S(2))))
    rubi.add(rule218)

    pattern219 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule219 = ReplacementRule(pattern219, lambda f, a, e, b, x, d, c : S(2)*a**S(2)*Int(sqrt(a + b*cot(e + f*x)), x)/(a*c - b*d) - (a*(c**S(2) - d**S(2)) + S(2)*b*c*d)*Int((a - b*cot(e + f*x))*sqrt(a + b*cot(e + f*x))/(c + d*cot(e + f*x)), x)/(a*(c**S(2) + d**S(2))))
    rubi.add(rule219)

    pattern220 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule220 = ReplacementRule(pattern220, lambda f, a, e, b, x, d, c : S(2)*a*Int(sqrt(a + b*tan(e + f*x))/sqrt(c + d*tan(e + f*x)), x) + b*Int(sqrt(a + b*tan(e + f*x))*(a*tan(e + f*x) + b)/sqrt(c + d*tan(e + f*x)), x)/a)
    rubi.add(rule220)

    pattern221 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule221 = ReplacementRule(pattern221, lambda f, a, e, b, x, d, c : S(2)*a*Int(sqrt(a + b*cot(e + f*x))/sqrt(c + d*cot(e + f*x)), x) + b*Int(sqrt(a + b*cot(e + f*x))*(a*cot(e + f*x) + b)/sqrt(c + d*cot(e + f*x)), x)/a)
    rubi.add(rule221)

    pattern222 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule222 = ReplacementRule(pattern222, lambda f, a, e, b, x, d, m, n, c : a*Int((a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**n*Simp(a*d*(m + S(2)*n) + b*c*(m + S(-2)) + (a*c*(m + S(-2)) + b*d*(S(3)*m + S(2)*n + S(-4)))*tan(e + f*x), x), x)/(d*(m + n + S(-1))) + b**S(2)*(a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n + S(-1))))
    rubi.add(rule222)

    pattern223 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule223 = ReplacementRule(pattern223, lambda f, a, e, b, x, d, m, n, c : a*Int((a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**n*Simp(a*d*(m + S(2)*n) + b*c*(m + S(-2)) + (a*c*(m + S(-2)) + b*d*(S(3)*m + S(2)*n + S(-4)))*cot(e + f*x), x), x)/(d*(m + n + S(-1))) - b**S(2)*(a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n + S(-1))))
    rubi.add(rule223)

    pattern224 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sqrt(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda m: IntegersQ(S(2)*m)))
    rule224 = ReplacementRule(pattern224, lambda f, a, e, b, x, d, m, c : -b*(a + b*tan(e + f*x))**m*sqrt(c + d*tan(e + f*x))/(S(2)*a*f*m) + Int((a + b*tan(e + f*x))**(m + S(1))*Simp(S(2)*a*c*m + a*d*(S(2)*m + S(1))*tan(e + f*x) + b*d, x)/sqrt(c + d*tan(e + f*x)), x)/(S(4)*a**S(2)*m))
    rubi.add(rule224)

    pattern225 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sqrt(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda m: IntegersQ(S(2)*m)))
    rule225 = ReplacementRule(pattern225, lambda f, a, e, b, x, d, m, c : b*(a + b*cot(e + f*x))**m*sqrt(c + d*cot(e + f*x))/(S(2)*a*f*m) + Int((a + b*cot(e + f*x))**(m + S(1))*Simp(S(2)*a*c*m + a*d*(S(2)*m + S(1))*cot(e + f*x) + b*d, x)/sqrt(c + d*cot(e + f*x)), x)/(S(4)*a**S(2)*m))
    rubi.add(rule225)

    pattern226 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule226 = ReplacementRule(pattern226, lambda f, a, e, b, x, d, m, n, c : (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(-1))*(a*d - b*c)/(S(2)*a*f*m) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(-2))*Simp(c*(a*c*m + b*d*(n + S(-1))) - d*(-a*c*(m + n + S(-1)) + b*d*(m - n + S(1)))*tan(e + f*x) - d*(a*d*(n + S(-1)) + b*c*m), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule226)

    pattern227 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule227 = ReplacementRule(pattern227, lambda f, a, e, b, x, d, m, n, c : (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(-1))*(-a*d + b*c)/(S(2)*a*f*m) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(-2))*Simp(c*(a*c*m + b*d*(n + S(-1))) - d*(-a*c*(m + n + S(-1)) + b*d*(m - n + S(1)))*cot(e + f*x) - d*(a*d*(n + S(-1)) + b*c*m), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule227)

    pattern228 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule228 = ReplacementRule(pattern228, lambda f, a, e, b, x, d, m, n, c : a*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(-a*d*(S(2)*m + n + S(1)) + b*c*m + b*d*(m + n + S(1))*tan(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule228)

    pattern229 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule229 = ReplacementRule(pattern229, lambda f, a, e, b, x, d, m, n, c : -a*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(-a*d*(S(2)*m + n + S(1)) + b*c*m + b*d*(m + n + S(1))*cot(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule229)

    pattern230 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegerQ(n) | IntegersQ(S(2)*m, S(2)*n)))
    rule230 = ReplacementRule(pattern230, lambda f, a, e, b, x, d, m, n, c : d*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))) - Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(-2))*Simp(-a*c**S(2)*(m + n + S(-1)) + d*(-a*c*(m + S(2)*n + S(-2)) + b*d*m)*tan(e + f*x) + d*(a*d*(n + S(-1)) + b*c*m), x), x)/(a*(m + n + S(-1))))
    rubi.add(rule230)

    pattern231 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(-1))), CustomConstraint(lambda m, n: IntegerQ(n) | IntegersQ(S(2)*m, S(2)*n)))
    rule231 = ReplacementRule(pattern231, lambda f, a, e, b, x, d, m, n, c : -d*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(-1))/(f*(m + n + S(-1))) - Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(-2))*Simp(-a*c**S(2)*(m + n + S(-1)) + d*(-a*c*(m + S(2)*n + S(-2)) + b*d*m)*cot(e + f*x) + d*(a*d*(n + S(-1)) + b*c*m), x), x)/(a*(m + n + S(-1))))
    rubi.add(rule231)

    pattern232 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(n) | IntegersQ(S(2)*m, S(2)*n)))
    rule232 = ReplacementRule(pattern232, lambda f, a, e, b, x, d, m, n, c : d*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*Simp(-a*c*(n + S(1)) + a*d*(m + n + S(1))*tan(e + f*x) + b*d*m, x), x)/(a*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule232)

    pattern233 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(n) | IntegersQ(S(2)*m, S(2)*n)))
    rule233 = ReplacementRule(pattern233, lambda f, a, e, b, x, d, m, n, c : -d*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*Simp(-a*c*(n + S(1)) + a*d*(m + n + S(1))*cot(e + f*x) + b*d*m, x), x)/(a*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule233)

    pattern234 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule234 = ReplacementRule(pattern234, lambda f, a, e, b, x, d, m, c : a*Int((a + b*tan(e + f*x))**m, x)/(a*c - b*d) - d*Int((a + b*tan(e + f*x))**m*(a*tan(e + f*x) + b)/(c + d*tan(e + f*x)), x)/(a*c - b*d))
    rubi.add(rule234)

    pattern235 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule235 = ReplacementRule(pattern235, lambda f, a, e, b, x, d, m, c : a*Int((a + b*cot(e + f*x))**m, x)/(a*c - b*d) - d*Int((a + b*cot(e + f*x))**m*(a*cot(e + f*x) + b)/(c + d*cot(e + f*x)), x)/(a*c - b*d))
    rubi.add(rule235)

    pattern236 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule236 = ReplacementRule(pattern236, lambda f, a, e, b, x, d, c : d*Int(sqrt(a + b*tan(e + f*x))*(a*tan(e + f*x) + b)/sqrt(c + d*tan(e + f*x)), x)/a + (a*c - b*d)*Int(sqrt(a + b*tan(e + f*x))/sqrt(c + d*tan(e + f*x)), x)/a)
    rubi.add(rule236)

    pattern237 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule237 = ReplacementRule(pattern237, lambda f, a, e, b, x, d, c : d*Int(sqrt(a + b*cot(e + f*x))*(a*cot(e + f*x) + b)/sqrt(c + d*cot(e + f*x)), x)/a + (a*c - b*d)*Int(sqrt(a + b*cot(e + f*x))/sqrt(c + d*cot(e + f*x)), x)/a)
    rubi.add(rule237)

    pattern238 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule238 = ReplacementRule(pattern238, lambda f, a, e, b, x, d, m, n, c : a*b*Subst(Int((a + x)**(m + S(-1))*(c + d*x/b)**n/(a*x + b**S(2)), x), x, b*tan(e + f*x))/f)
    rubi.add(rule238)

    pattern239 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule239 = ReplacementRule(pattern239, lambda f, a, e, b, x, d, m, n, c : -a*b*Subst(Int((a + x)**(m + S(-1))*(c + d*x/b)**n/(a*x + b**S(2)), x), x, b*cot(e + f*x))/f)
    rubi.add(rule239)

    pattern240 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule240 = ReplacementRule(pattern240, lambda f, a, e, b, x, d, m, n, c : -Int((a + b*tan(e + f*x))**(m + S(-3))*(c + d*tan(e + f*x))**(n + S(1))*Simp(a**S(2)*d*(-a*c*(n + S(1)) + b*d*(m + S(-2))) + b*(-S(2)*a*d + b*c)*(a*d*(n + S(1)) + b*c*(m + S(-2))) - b*(a*d*(-a*d + S(2)*b*c)*(m + n + S(-1)) - b**S(2)*(c**S(2)*(m + S(-2)) - d**S(2)*(n + S(1))))*tan(e + f*x)**S(2) - d*(n + S(1))*(-a**S(3)*d + S(3)*a**S(2)*b*c + S(3)*a*b**S(2)*d - b**S(3)*c)*tan(e + f*x), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) + (a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**(n + S(1))*(-a*d + b*c)**S(2)/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule240)

    pattern241 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule241 = ReplacementRule(pattern241, lambda f, a, e, b, x, d, m, n, c : -Int((a + b*cot(e + f*x))**(m + S(-3))*(c + d*cot(e + f*x))**(n + S(1))*Simp(a**S(2)*d*(-a*c*(n + S(1)) + b*d*(m + S(-2))) + b*(-S(2)*a*d + b*c)*(a*d*(n + S(1)) + b*c*(m + S(-2))) - b*(a*d*(-a*d + S(2)*b*c)*(m + n + S(-1)) - b**S(2)*(c**S(2)*(m + S(-2)) - d**S(2)*(n + S(1))))*cot(e + f*x)**S(2) - d*(n + S(1))*(-a**S(3)*d + S(3)*a**S(2)*b*c + S(3)*a*b**S(2)*d - b**S(3)*c)*cot(e + f*x), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) - (a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**(n + S(1))*(-a*d + b*c)**S(2)/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule241)

    pattern242 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda m, n: IntegerQ(m) | (RationalQ(n) & GreaterEqual(n, S(-1)))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(2)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule242 = ReplacementRule(pattern242, lambda f, a, e, b, x, d, m, n, c : b**S(2)*(a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n + S(-1))) + Int((a + b*tan(e + f*x))**(m + S(-3))*(c + d*tan(e + f*x))**n*Simp(a**S(3)*d*(m + n + S(-1)) - b**S(2)*(a*d*(n + S(1)) + b*c*(m + S(-2))) - b**S(2)*(-a*d*(S(3)*m + S(2)*n + S(-4)) + b*c*(m + S(-2)))*tan(e + f*x)**S(2) + b*d*(S(3)*a**S(2) - b**S(2))*(m + n + S(-1))*tan(e + f*x), x), x)/(d*(m + n + S(-1))))
    rubi.add(rule242)

    pattern243 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda m, n: IntegerQ(m) | (RationalQ(n) & GreaterEqual(n, S(-1)))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(2)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule243 = ReplacementRule(pattern243, lambda f, a, e, b, x, d, m, n, c : -b**S(2)*(a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n + S(-1))) + Int((a + b*cot(e + f*x))**(m + S(-3))*(c + d*cot(e + f*x))**n*Simp(a**S(3)*d*(m + n + S(-1)) - b**S(2)*(a*d*(n + S(1)) + b*c*(m + S(-2))) - b**S(2)*(-a*d*(S(3)*m + S(2)*n + S(-4)) + b*c*(m + S(-2)))*cot(e + f*x)**S(2) + b*d*(S(3)*a**S(2) - b**S(2))*(m + n + S(-1))*cot(e + f*x), x), x)/(d*(m + n + S(-1))))
    rubi.add(rule243)

    pattern244 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(1), n, S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule244 = ReplacementRule(pattern244, lambda f, a, e, b, x, d, m, n, c : Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(-2))*Simp(a*c**S(2)*(m + S(1)) + a*d**S(2)*(n + S(-1)) + b*c*d*(m - n + S(2)) - d*(m + n)*(-a*d + b*c)*tan(e + f*x)**S(2) - (m + S(1))*(-S(2)*a*c*d + b*c**S(2) - b*d**S(2))*tan(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))) + (a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(-1))*(-a*d + b*c)/(f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule244)

    pattern245 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(1), n, S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule245 = ReplacementRule(pattern245, lambda f, a, e, b, x, d, m, n, c : Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(-2))*Simp(a*c**S(2)*(m + S(1)) + a*d**S(2)*(n + S(-1)) + b*c*d*(m - n + S(2)) - d*(m + n)*(-a*d + b*c)*cot(e + f*x)**S(2) - (m + S(1))*(-S(2)*a*c*d + b*c**S(2) - b*d**S(2))*cot(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))) + (a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(-1))*(a*d - b*c)/(f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule245)

    pattern246 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule246 = ReplacementRule(pattern246, lambda f, a, e, b, x, d, m, n, c : b*(a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n/(f*(a**S(2) + b**S(2))*(m + S(1))) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(-1))*Simp(a*c*(m + S(1)) - b*d*n - b*d*(m + n + S(1))*tan(e + f*x)**S(2) - (m + S(1))*(-a*d + b*c)*tan(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule246)

    pattern247 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule247 = ReplacementRule(pattern247, lambda f, a, e, b, x, d, m, n, c : -b*(a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n/(f*(a**S(2) + b**S(2))*(m + S(1))) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(-1))*Simp(a*c*(m + S(1)) - b*d*n - b*d*(m + n + S(1))*cot(e + f*x)**S(2) - (m + S(1))*(-a*d + b*c)*cot(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule247)

    pattern248 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | (RationalQ(n) & Less(n, S(0)))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule248 = ReplacementRule(pattern248, lambda f, a, e, b, x, d, m, n, c : b**S(2)*(a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(1))/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))*tan(e + f*x)**S(2) - b**S(2)*d*(m + n + S(2)) - b*(m + S(1))*(-a*d + b*c)*tan(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule248)

    pattern249 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | (RationalQ(n) & Less(n, S(0)))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule249 = ReplacementRule(pattern249, lambda f, a, e, b, x, d, m, n, c : -b**S(2)*(a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(1))/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))*cot(e + f*x)**S(2) - b**S(2)*d*(m + n + S(2)) - b*(m + S(1))*(-a*d + b*c)*cot(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule249)

    pattern250 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule250 = ReplacementRule(pattern250, lambda f, a, e, b, x, d, m, n, c : b*(a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**n/(f*(m + n + S(-1))) + Int((a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**(n + S(-1))*Simp(a**S(2)*c*(m + n + S(-1)) - b*(a*d*n + b*c*(m + S(-1))) + b*(a*d*(S(2)*m + n + S(-2)) + b*c*n)*tan(e + f*x)**S(2) + (m + n + S(-1))*(a**S(2)*d + S(2)*a*b*c - b**S(2)*d)*tan(e + f*x), x), x)/(m + n + S(-1)))
    rubi.add(rule250)

    pattern251 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule251 = ReplacementRule(pattern251, lambda f, a, e, b, x, d, m, n, c : -b*(a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**n/(f*(m + n + S(-1))) + Int((a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**(n + S(-1))*Simp(a**S(2)*c*(m + n + S(-1)) - b*(a*d*n + b*c*(m + S(-1))) + b*(a*d*(S(2)*m + n + S(-2)) + b*c*n)*cot(e + f*x)**S(2) + (m + n + S(-1))*(a**S(2)*d + S(2)*a*b*c - b**S(2)*d)*cot(e + f*x), x), x)/(m + n + S(-1)))
    rubi.add(rule251)

    pattern252 = Pattern(Integral(S(1)/((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule252 = ReplacementRule(pattern252, lambda f, a, e, b, x, d, c : b**S(2)*Int((-a*tan(e + f*x) + b)/(a + b*tan(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)) - d**S(2)*Int((-c*tan(e + f*x) + d)/(c + d*tan(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + x*(a*c - b*d)/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))))
    rubi.add(rule252)

    pattern253 = Pattern(Integral(S(1)/((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule253 = ReplacementRule(pattern253, lambda f, a, e, b, x, d, c : b**S(2)*Int((-a*cot(e + f*x) + b)/(a + b*cot(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)) - d**S(2)*Int((-c*cot(e + f*x) + d)/(c + d*cot(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + x*(a*c - b*d)/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))))
    rubi.add(rule253)

    pattern254 = Pattern(Integral(sqrt(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule254 = ReplacementRule(pattern254, lambda f, a, e, b, x, d, c : -d*(-a*d + b*c)*Int((tan(e + f*x)**S(2) + S(1))/(sqrt(a + b*tan(e + f*x))*(c + d*tan(e + f*x))), x)/(c**S(2) + d**S(2)) + Int(Simp(a*c + b*d + (-a*d + b*c)*tan(e + f*x), x)/sqrt(a + b*tan(e + f*x)), x)/(c**S(2) + d**S(2)))
    rubi.add(rule254)

    pattern255 = Pattern(Integral(sqrt(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule255 = ReplacementRule(pattern255, lambda f, a, e, b, x, d, c : -d*(-a*d + b*c)*Int((cot(e + f*x)**S(2) + S(1))/(sqrt(a + b*cot(e + f*x))*(c + d*cot(e + f*x))), x)/(c**S(2) + d**S(2)) + Int(Simp(a*c + b*d + (-a*d + b*c)*cot(e + f*x), x)/sqrt(a + b*cot(e + f*x)), x)/(c**S(2) + d**S(2)))
    rubi.add(rule255)

    pattern256 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule256 = ReplacementRule(pattern256, lambda f, a, e, b, x, d, c : (-a*d + b*c)**S(2)*Int((tan(e + f*x)**S(2) + S(1))/(sqrt(a + b*tan(e + f*x))*(c + d*tan(e + f*x))), x)/(c**S(2) + d**S(2)) + Int(Simp(a**S(2)*c + S(2)*a*b*d - b**S(2)*c + (-a**S(2)*d + S(2)*a*b*c + b**S(2)*d)*tan(e + f*x), x)/sqrt(a + b*tan(e + f*x)), x)/(c**S(2) + d**S(2)))
    rubi.add(rule256)

    pattern257 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule257 = ReplacementRule(pattern257, lambda f, a, e, b, x, d, c : (-a*d + b*c)**S(2)*Int((cot(e + f*x)**S(2) + S(1))/(sqrt(a + b*cot(e + f*x))*(c + d*cot(e + f*x))), x)/(c**S(2) + d**S(2)) + Int(Simp(a**S(2)*c + S(2)*a*b*d - b**S(2)*c + (-a**S(2)*d + S(2)*a*b*c + b**S(2)*d)*cot(e + f*x), x)/sqrt(a + b*cot(e + f*x)), x)/(c**S(2) + d**S(2)))
    rubi.add(rule257)

    pattern258 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule258 = ReplacementRule(pattern258, lambda f, a, e, b, x, d, m, c : d**S(2)*Int((a + b*tan(e + f*x))**m*(tan(e + f*x)**S(2) + S(1))/(c + d*tan(e + f*x)), x)/(c**S(2) + d**S(2)) + Int((a + b*tan(e + f*x))**m*(c - d*tan(e + f*x)), x)/(c**S(2) + d**S(2)))
    rubi.add(rule258)

    pattern259 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule259 = ReplacementRule(pattern259, lambda f, a, e, b, x, d, m, c : d**S(2)*Int((a + b*cot(e + f*x))**m*(cot(e + f*x)**S(2) + S(1))/(c + d*cot(e + f*x)), x)/(c**S(2) + d**S(2)) + Int((a + b*cot(e + f*x))**m*(c - d*cot(e + f*x)), x)/(c**S(2) + d**S(2)))
    rubi.add(rule259)

    pattern260 = Pattern(Integral((c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule260 = ReplacementRule(pattern260, lambda f, a, e, b, x, d, m, n, c : b*Subst(Int((a + x)**m*(c + d*x/b)**n/(b**S(2) + x**S(2)), x), x, b*tan(e + f*x))/f)
    rubi.add(rule260)

    pattern261 = Pattern(Integral((c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule261 = ReplacementRule(pattern261, lambda f, a, e, b, x, d, m, n, c : -b*Subst(Int((a + x)**m*(c + d*x/b)**n/(b**S(2) + x**S(2)), x), x, b*cot(e + f*x))/f)
    rubi.add(rule261)

    pattern262 = Pattern(Integral((WC('d', S(1))/tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)))
    rule262 = ReplacementRule(pattern262, lambda f, a, e, b, x, d, m, n : d**m*Int((d*cot(e + f*x))**(-m + n)*(a*cot(e + f*x) + b)**m, x))
    rubi.add(rule262)

    pattern263 = Pattern(Integral((WC('d', S(1))/cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)))
    rule263 = ReplacementRule(pattern263, lambda f, a, e, b, x, d, m, n : d**m*Int((d*tan(e + f*x))**(-m + n)*(a*tan(e + f*x) + b)**m, x))
    rubi.add(rule263)

    pattern264 = Pattern(Integral(((WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('c', S(1)))**n_*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule264 = ReplacementRule(pattern264, lambda f, a, e, b, x, d, p, m, n, c : c**IntPart(n)*(c*(d*tan(e + f*x))**p)**FracPart(n)*(d*tan(e + f*x))**(-p*FracPart(n))*Int((d*tan(e + f*x))**(n*p)*(a + b*tan(e + f*x))**m, x))
    rubi.add(rule264)

    pattern265 = Pattern(Integral(((WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('c', S(1)))**n_*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule265 = ReplacementRule(pattern265, lambda f, a, e, b, x, d, p, m, n, c : c**IntPart(n)*(c*(d*cot(e + f*x))**p)**FracPart(n)*(d*cot(e + f*x))**(-p*FracPart(n))*Int((d*cot(e + f*x))**(n*p)*(a + b*cot(e + f*x))**m, x))
    rubi.add(rule265)

    pattern266 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule266 = ReplacementRule(pattern266, lambda f, a, g, e, b, x, d, p, m, n, c : Int((g*tan(e + f*x))**p*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n, x))
    rubi.add(rule266)

    pattern267 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule267 = ReplacementRule(pattern267, lambda f, a, g, e, b, x, d, p, m, n, c : Int((g*cot(e + f*x))**p*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n, x))
    rubi.add(rule267)

    pattern268 = Pattern(Integral((WC('g', S(1))/tan(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: Not(IntegerQ(p))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule268 = ReplacementRule(pattern268, lambda f, a, g, e, b, x, d, p, m, n, c : g**(m + n)*Int((g*cot(e + f*x))**(-m - n + p)*(a*cot(e + f*x) + b)**m*(c*cot(e + f*x) + d)**n, x))
    rubi.add(rule268)

    pattern269 = Pattern(Integral((WC('g', S(1))/cot(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: Not(IntegerQ(p))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule269 = ReplacementRule(pattern269, lambda f, a, g, e, b, x, d, p, m, n, c : g**(m + n)*Int((g*tan(e + f*x))**(-m - n + p)*(a*tan(e + f*x) + b)**m*(c*tan(e + f*x) + d)**n, x))
    rubi.add(rule269)

    pattern270 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**q_)**p_*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda p: Not(IntegerQ(p))), CustomConstraint(lambda m, n: Not(IntegerQ(m) & IntegerQ(n))))
    rule270 = ReplacementRule(pattern270, lambda f, a, g, e, q, b, x, d, p, m, n, c : (g*tan(e + f*x))**(-p*q)*(g*tan(e + f*x)**q)**p*Int((g*tan(e + f*x))**(p*q)*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n, x))
    rubi.add(rule270)

    pattern271 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**q_)**p_*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda p: Not(IntegerQ(p))), CustomConstraint(lambda m, n: Not(IntegerQ(m) & IntegerQ(n))))
    rule271 = ReplacementRule(pattern271, lambda f, a, g, e, q, b, x, d, p, m, n, c : (g*cot(e + f*x))**(-p*q)*(g*cot(e + f*x)**q)**p*Int((g*cot(e + f*x))**(p*q)*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n, x))
    rubi.add(rule271)

    pattern272 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule272 = ReplacementRule(pattern272, lambda f, a, g, e, b, x, d, p, m, n, c : g**n*Int((g*tan(e + f*x))**(-n + p)*(a + b*tan(e + f*x))**m*(c*tan(e + f*x) + d)**n, x))
    rubi.add(rule272)

    pattern273 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule273 = ReplacementRule(pattern273, lambda f, a, g, e, b, x, d, p, m, n, c : g**n*Int((g*cot(e + f*x))**(-n + p)*(a + b*cot(e + f*x))**m*(c*cot(e + f*x) + d)**n, x))
    rubi.add(rule273)

    pattern274 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*tan(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: IntegerQ(p)))
    rule274 = ReplacementRule(pattern274, lambda f, a, e, b, x, d, p, m, n, c : Int((c + d*cot(e + f*x))**n*(a*cot(e + f*x) + b)**m*cot(e + f*x)**(-m - p), x))
    rubi.add(rule274)

    pattern275 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cot(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: IntegerQ(p)))
    rule275 = ReplacementRule(pattern275, lambda f, a, e, b, x, d, p, m, n, c : Int((c + d*tan(e + f*x))**n*(a*tan(e + f*x) + b)**m*tan(e + f*x)**(-m - p), x))
    rubi.add(rule275)

    pattern276 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule276 = ReplacementRule(pattern276, lambda f, a, g, e, b, x, d, p, m, n, c : (g*tan(e + f*x))**p*Int((c + d*cot(e + f*x))**n*(a*cot(e + f*x) + b)**m*cot(e + f*x)**(-m - p), x)*cot(e + f*x)**p)
    rubi.add(rule276)

    pattern277 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule277 = ReplacementRule(pattern277, lambda f, a, g, e, b, x, d, p, m, n, c : (g*cot(e + f*x))**p*Int((c + d*tan(e + f*x))**n*(a*tan(e + f*x) + b)**m*tan(e + f*x)**(-m - p), x)*tan(e + f*x)**p)
    rubi.add(rule277)

    pattern278 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule278 = ReplacementRule(pattern278, lambda f, a, g, e, b, x, d, p, m, n, c : (g*tan(e + f*x))**n*(c + d*cot(e + f*x))**n*(c*tan(e + f*x) + d)**(-n)*Int((g*tan(e + f*x))**(-n + p)*(a + b*tan(e + f*x))**m*(c*tan(e + f*x) + d)**n, x))
    rubi.add(rule278)

    pattern279 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule279 = ReplacementRule(pattern279, lambda f, a, g, e, b, x, d, p, m, n, c : (g*cot(e + f*x))**n*(c + d*tan(e + f*x))**n*(c*cot(e + f*x) + d)**(-n)*Int((g*cot(e + f*x))**(-n + p)*(a + b*cot(e + f*x))**m*(c*cot(e + f*x) + d)**n, x))
    rubi.add(rule279)

    pattern280 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule280 = ReplacementRule(pattern280, lambda f, a, A, e, B, b, x, d, m, n, c : a*c*Subst(Int((A + B*x)*(a + b*x)**(m + S(-1))*(c + d*x)**(n + S(-1)), x), x, tan(e + f*x))/f)
    rubi.add(rule280)

    pattern281 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: ZeroQ(a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule281 = ReplacementRule(pattern281, lambda f, a, A, e, b, x, m, d, B, n, c : -a*c*Subst(Int((A + B*x)*(a + b*x)**(m + S(-1))*(c + d*x)**(n + S(-1)), x), x, cot(e + f*x))/f)
    rubi.add(rule281)

    pattern282 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)))
    rule282 = ReplacementRule(pattern282, lambda f, a, A, e, b, x, d, B, c : B*d*Int(tan(e + f*x), x)/b + Int(Simp(A*b*c + (A*b*d + B*(-a*d + b*c))*tan(e + f*x), x)/(a + b*tan(e + f*x)), x)/b)
    rubi.add(rule282)

    pattern283 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)))
    rule283 = ReplacementRule(pattern283, lambda f, a, A, e, b, x, d, B, c : B*d*Int(cot(e + f*x), x)/b + Int(Simp(A*b*c + (A*b*d + B*(-a*d + b*c))*cot(e + f*x), x)/(a + b*cot(e + f*x)), x)/b)
    rubi.add(rule283)

    pattern284 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule284 = ReplacementRule(pattern284, lambda f, a, A, e, b, x, m, d, B, c : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(A*a*d + A*b*c + B*a*c + S(2)*B*a*d*tan(e + f*x) + B*b*d, x), x)/(S(2)*a*b) + (a + b*tan(e + f*x))**m*(-A*b + B*a)*(a*c + b*d)/(S(2)*a**S(2)*f*m))
    rubi.add(rule284)

    pattern285 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule285 = ReplacementRule(pattern285, lambda f, a, A, e, b, x, m, d, B, c : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(A*a*d + A*b*c + B*a*c + S(2)*B*a*d*cot(e + f*x) + B*b*d, x), x)/(S(2)*a*b) + (a + b*cot(e + f*x))**m*(A*b - B*a)*(a*c + b*d)/(S(2)*a**S(2)*f*m))
    rubi.add(rule285)

    pattern286 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule286 = ReplacementRule(pattern286, lambda f, a, A, e, b, x, m, d, B, c : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(A*a*c + A*b*d - B*a*d + B*b*c - (-A*a*d + A*b*c - B*a*c - B*b*d)*tan(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*tan(e + f*x))**(m + S(1))*(A*b - B*a)*(-a*d + b*c)/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule286)

    pattern287 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule287 = ReplacementRule(pattern287, lambda f, a, A, e, b, x, m, d, B, c : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(A*a*c + A*b*d - B*a*d + B*b*c - (-A*a*d + A*b*c - B*a*c - B*b*d)*cot(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*cot(e + f*x))**(m + S(1))*(A*b - B*a)*(a*d - b*c)/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule287)

    pattern288 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))))
    rule288 = ReplacementRule(pattern288, lambda f, a, A, e, B, b, x, d, m, c : B*d*(a + b*tan(e + f*x))**(m + S(1))/(b*f*(m + S(1))) + Int((a + b*tan(e + f*x))**m*Simp(A*c - B*d + (A*d + B*c)*tan(e + f*x), x), x))
    rubi.add(rule288)

    pattern289 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))))
    rule289 = ReplacementRule(pattern289, lambda f, a, A, e, B, b, x, d, m, c : -B*d*(a + b*cot(e + f*x))**(m + S(1))/(b*f*(m + S(1))) + Int((a + b*cot(e + f*x))**m*Simp(A*c - B*d + (A*d + B*c)*cot(e + f*x), x), x))
    rubi.add(rule289)

    pattern290 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule290 = ReplacementRule(pattern290, lambda f, a, A, e, b, x, m, d, B, n, c : -a**S(2)*(a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))*(-A*d + B*c)/(d*f*(n + S(1))*(a*d + b*c)) - a*Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))*Simp(A*b*d*(m - n + S(-2)) - B*(a*d*(n + S(1)) + b*c*(m + S(-1))) + (A*a*d*(m + n) - B*(a*c*(m + S(-1)) + b*d*(n + S(1))))*tan(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule290)

    pattern291 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule291 = ReplacementRule(pattern291, lambda f, a, A, e, b, x, m, d, B, n, c : a**S(2)*(a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))*(-A*d + B*c)/(d*f*(n + S(1))*(a*d + b*c)) - a*Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))*Simp(A*b*d*(m - n + S(-2)) - B*(a*d*(n + S(1)) + b*c*(m + S(-1))) + (A*a*d*(m + n) - B*(a*c*(m + S(-1)) + b*d*(n + S(1))))*cot(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule291)

    pattern292 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Not(RationalQ(n) & Less(n, S(-1)))))
    rule292 = ReplacementRule(pattern292, lambda f, a, A, e, b, x, m, d, B, n, c : B*b*(a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n)) + Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**n*Simp(A*a*d*(m + n) + B*(a*c*(m + S(-1)) - b*d*(n + S(1))) - (B*(m + S(-1))*(-a*d + b*c) - d*(m + n)*(A*b + B*a))*tan(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule292)

    pattern293 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Not(RationalQ(n) & Less(n, S(-1)))))
    rule293 = ReplacementRule(pattern293, lambda f, a, A, e, b, x, m, d, B, n, c : -B*b*(a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n)) + Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**n*Simp(A*a*d*(m + n) + B*(a*c*(m + S(-1)) - b*d*(n + S(1))) - (B*(m + S(-1))*(-a*d + b*c) - d*(m + n)*(A*b + B*a))*cot(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule293)

    pattern294 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule294 = ReplacementRule(pattern294, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n*(-A*b + B*a)/(S(2)*a*f*m) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(-1))*Simp(A*(a*c*m + b*d*n) - B*(a*d*n + b*c*m) - d*(-A*a*(m + n) + B*b*(m - n))*tan(e + f*x), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule294)

    pattern295 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule295 = ReplacementRule(pattern295, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n*(A*b - B*a)/(S(2)*a*f*m) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(-1))*Simp(A*(a*c*m + b*d*n) - B*(a*d*n + b*c*m) - d*(-A*a*(m + n) + B*b*(m - n))*cot(e + f*x), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule295)

    pattern296 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))))
    rule296 = ReplacementRule(pattern296, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*(A*a + B*b)/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(A*(-a*d*(S(2)*m + n + S(1)) + b*c*m) + B*(a*c*m - b*d*(n + S(1))) + d*(A*b - B*a)*(m + n + S(1))*tan(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule296)

    pattern297 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))))
    rule297 = ReplacementRule(pattern297, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*(-A*a - B*b)/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(A*(-a*d*(S(2)*m + n + S(1)) + b*c*m) + B*(a*c*m - b*d*(n + S(1))) + d*(A*b - B*a)*(m + n + S(1))*cot(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule297)

    pattern298 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule298 = ReplacementRule(pattern298, lambda f, a, A, e, b, x, m, d, B, n, c : B*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n/(f*(m + n)) + Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(-1))*Simp(A*a*c*(m + n) - B*(a*d*n + b*c*m) + (A*a*d*(m + n) - B*(-a*c*n + b*d*m))*tan(e + f*x), x), x)/(a*(m + n)))
    rubi.add(rule298)

    pattern299 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule299 = ReplacementRule(pattern299, lambda f, a, A, e, b, x, m, d, B, n, c : -B*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n/(f*(m + n)) + Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(-1))*Simp(A*a*c*(m + n) - B*(a*d*n + b*c*m) + (A*a*d*(m + n) - B*(-a*c*n + b*d*m))*cot(e + f*x), x), x)/(a*(m + n)))
    rubi.add(rule299)

    pattern300 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule300 = ReplacementRule(pattern300, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*(A*d - B*c)/(f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*Simp(A*(-a*c*(n + S(1)) + b*d*m) - B*(a*d*(n + S(1)) + b*c*m) - a*(-A*d + B*c)*(m + n + S(1))*tan(e + f*x), x), x)/(a*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule300)

    pattern301 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule301 = ReplacementRule(pattern301, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*(-A*d + B*c)/(f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*Simp(A*(-a*c*(n + S(1)) + b*d*m) - B*(a*d*(n + S(1)) + b*c*m) - a*(-A*d + B*c)*(m + n + S(1))*cot(e + f*x), x), x)/(a*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule301)

    pattern302 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, a, B, b: ZeroQ(A*b + B*a)))
    rule302 = ReplacementRule(pattern302, lambda f, a, A, e, b, x, m, d, B, n, c : B*b*Subst(Int((a + b*x)**(m + S(-1))*(c + d*x)**n, x), x, tan(e + f*x))/f)
    rubi.add(rule302)

    pattern303 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, a, B, b: ZeroQ(A*b + B*a)))
    rule303 = ReplacementRule(pattern303, lambda f, a, A, e, b, x, m, d, B, n, c : -B*b*Subst(Int((a + b*x)**(m + S(-1))*(c + d*x)**n, x), x, cot(e + f*x))/f)
    rubi.add(rule303)

    pattern304 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, a, B, b: NonzeroQ(A*b + B*a)))
    rule304 = ReplacementRule(pattern304, lambda f, a, A, e, b, x, m, d, B, c : (A*b + B*a)*Int((a + b*tan(e + f*x))**m, x)/(a*d + b*c) - (-A*d + B*c)*Int((a - b*tan(e + f*x))*(a + b*tan(e + f*x))**m/(c + d*tan(e + f*x)), x)/(a*d + b*c))
    rubi.add(rule304)

    pattern305 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, a, B, b: NonzeroQ(A*b + B*a)))
    rule305 = ReplacementRule(pattern305, lambda f, a, A, e, b, x, m, d, B, c : (A*b + B*a)*Int((a + b*cot(e + f*x))**m, x)/(a*d + b*c) - (-A*d + B*c)*Int((a - b*cot(e + f*x))*(a + b*cot(e + f*x))**m/(c + d*cot(e + f*x)), x)/(a*d + b*c))
    rubi.add(rule305)

    pattern306 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, a, B, b: NonzeroQ(A*b + B*a)))
    rule306 = ReplacementRule(pattern306, lambda f, a, A, e, b, x, m, d, B, n, c : -B*Int((a - b*tan(e + f*x))*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n, x)/b + (A*b + B*a)*Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n, x)/b)
    rubi.add(rule306)

    pattern307 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, a, B, b: NonzeroQ(A*b + B*a)))
    rule307 = ReplacementRule(pattern307, lambda f, a, A, e, b, x, m, d, B, n, c : -B*Int((a - b*cot(e + f*x))*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n, x)/b + (A*b + B*a)*Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n, x)/b)
    rubi.add(rule307)

    pattern308 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m, n: Not(IntegersQ(S(2)*m, S(2)*n))), CustomConstraint(lambda A, B: ZeroQ(A**S(2) + B**S(2))))
    rule308 = ReplacementRule(pattern308, lambda f, a, A, e, b, x, m, d, B, n, c : A**S(2)*Subst(Int((a + b*x)**m*(c + d*x)**n/(A - B*x), x), x, tan(e + f*x))/f)
    rubi.add(rule308)

    pattern309 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m, n: Not(IntegersQ(S(2)*m, S(2)*n))), CustomConstraint(lambda A, B: ZeroQ(A**S(2) + B**S(2))))
    rule309 = ReplacementRule(pattern309, lambda f, a, A, e, b, x, m, d, B, n, c : -A**S(2)*Subst(Int((a + b*x)**m*(c + d*x)**n/(A - B*x), x), x, cot(e + f*x))/f)
    rubi.add(rule309)

    pattern310 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m, n: Not(IntegersQ(S(2)*m, S(2)*n))), CustomConstraint(lambda A, B: NonzeroQ(A**S(2) + B**S(2))))
    rule310 = ReplacementRule(pattern310, lambda f, a, A, e, b, x, m, d, B, n, c : (A/S(2) - B*ImaginaryI/S(2))*Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n*(ImaginaryI*tan(e + f*x) + S(1)), x) + (A/S(2) + B*ImaginaryI/S(2))*Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n*(-ImaginaryI*tan(e + f*x) + S(1)), x))
    rubi.add(rule310)

    pattern311 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))), CustomConstraint(lambda n: Not(IntegerQ(n))), CustomConstraint(lambda m, n: Not(IntegersQ(S(2)*m, S(2)*n))), CustomConstraint(lambda A, B: NonzeroQ(A**S(2) + B**S(2))))
    rule311 = ReplacementRule(pattern311, lambda f, a, A, e, b, x, m, d, B, n, c : (A/S(2) - B*ImaginaryI/S(2))*Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n*(ImaginaryI*cot(e + f*x) + S(1)), x) + (A/S(2) + B*ImaginaryI/S(2))*Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n*(-ImaginaryI*cot(e + f*x) + S(1)), x))
    rubi.add(rule311)

    pattern312 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule312 = ReplacementRule(pattern312, lambda f, a, A, e, b, x, m, d, B, n, c : -Int((a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**(n + S(1))*Simp(A*a*d*(-a*c*(n + S(1)) + b*d*(m + S(-1))) - b*(-B*b*(c**S(2)*(m + S(-1)) - d**S(2)*(n + S(1))) + d*(m + n)*(-A*a*d + A*b*c + B*a*c))*tan(e + f*x)**S(2) - d*(n + S(1))*((A*a - B*b)*(-a*d + b*c) + (A*b + B*a)*(a*c + b*d))*tan(e + f*x) + (B*b*c - d*(A*b + B*a))*(a*d*(n + S(1)) + b*c*(m + S(-1))), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) + (a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))*(-A*d + B*c)*(-a*d + b*c)/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule312)

    pattern313 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule313 = ReplacementRule(pattern313, lambda f, a, A, e, b, x, m, d, B, n, c : -Int((a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**(n + S(1))*Simp(A*a*d*(-a*c*(n + S(1)) + b*d*(m + S(-1))) - b*(-B*b*(c**S(2)*(m + S(-1)) - d**S(2)*(n + S(1))) + d*(m + n)*(-A*a*d + A*b*c + B*a*c))*cot(e + f*x)**S(2) - d*(n + S(1))*((A*a - B*b)*(-a*d + b*c) + (A*b + B*a)*(a*c + b*d))*cot(e + f*x) + (B*b*c - d*(A*b + B*a))*(a*d*(n + S(1)) + b*c*(m + S(-1))), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) + (a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))*(-A*d + B*c)*(a*d - b*c)/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule313)

    pattern314 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule314 = ReplacementRule(pattern314, lambda f, a, A, e, b, x, m, d, B, n, c : B*b*(a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n)) + Int((a + b*tan(e + f*x))**(m + S(-2))*(c + d*tan(e + f*x))**n*Simp(A*a**S(2)*d*(m + n) - B*b*(a*d*(n + S(1)) + b*c*(m + S(-1))) + d*(m + n)*(S(2)*A*a*b + B*(a**S(2) - b**S(2)))*tan(e + f*x) - (B*b*(m + S(-1))*(-a*d + b*c) - b*d*(m + n)*(A*b + B*a))*tan(e + f*x)**S(2), x), x)/(d*(m + n)))
    rubi.add(rule314)

    pattern315 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule315 = ReplacementRule(pattern315, lambda f, a, A, e, b, x, m, d, B, n, c : -B*b*(a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n)) + Int((a + b*cot(e + f*x))**(m + S(-2))*(c + d*cot(e + f*x))**n*Simp(A*a**S(2)*d*(m + n) - B*b*(a*d*(n + S(1)) + b*c*(m + S(-1))) + d*(m + n)*(S(2)*A*a*b + B*(a**S(2) - b**S(2)))*cot(e + f*x) - (B*b*(m + S(-1))*(-a*d + b*c) - b*d*(m + n)*(A*b + B*a))*cot(e + f*x)**S(2), x), x)/(d*(m + n)))
    rubi.add(rule315)

    pattern316 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(0), n, S(1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule316 = ReplacementRule(pattern316, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*(A*b - B*a)/(f*(a**S(2) + b**S(2))*(m + S(1))) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(-1))*Simp(A*b*(a*c*(m + S(1)) - b*d*n) + B*b*(a*d*n + b*c*(m + S(1))) - b*d*(A*b - B*a)*(m + n + S(1))*tan(e + f*x)**S(2) - b*(m + S(1))*(A*(-a*d + b*c) - B*(a*c + b*d))*tan(e + f*x), x), x)/(b*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule316)

    pattern317 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(0), n, S(1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule317 = ReplacementRule(pattern317, lambda f, a, A, e, b, x, m, d, B, n, c : (a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*(-A*b + B*a)/(f*(a**S(2) + b**S(2))*(m + S(1))) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(-1))*Simp(A*b*(a*c*(m + S(1)) - b*d*n) + B*b*(a*d*n + b*c*(m + S(1))) - b*d*(A*b - B*a)*(m + n + S(1))*cot(e + f*x)**S(2) - b*(m + S(1))*(A*(-a*d + b*c) - B*(a*c + b*d))*cot(e + f*x), x), x)/(b*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule317)

    pattern318 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule318 = ReplacementRule(pattern318, lambda f, a, A, e, b, x, m, d, B, n, c : b*(a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(1))*(A*b - B*a)/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(A*(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))) + B*b*(a*d*(n + S(1)) + b*c*(m + S(1))) - b*d*(A*b - B*a)*(m + n + S(2))*tan(e + f*x)**S(2) - (m + S(1))*(A*b - B*a)*(-a*d + b*c)*tan(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule318)

    pattern319 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule319 = ReplacementRule(pattern319, lambda f, a, A, e, b, x, m, d, B, n, c : -b*(a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(1))*(A*b - B*a)/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(A*(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))) + B*b*(a*d*(n + S(1)) + b*c*(m + S(1))) - b*d*(A*b - B*a)*(m + n + S(2))*cot(e + f*x)**S(2) - (m + S(1))*(A*b - B*a)*(-a*d + b*c)*cot(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule319)

    pattern320 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(S(0), m, S(1))), CustomConstraint(lambda n: Less(S(0), n, S(1))))
    rule320 = ReplacementRule(pattern320, lambda f, a, A, e, b, x, m, d, B, n, c : B*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n/(f*(m + n)) + Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(-1))*Simp(A*a*c*(m + n) - B*(a*d*n + b*c*m) + (m + n)*(A*a*d + A*b*c + B*a*c - B*b*d)*tan(e + f*x) + (A*b*d*(m + n) + B*(a*d*m + b*c*n))*tan(e + f*x)**S(2), x), x)/(m + n))
    rubi.add(rule320)

    pattern321 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(S(0), m, S(1))), CustomConstraint(lambda n: Less(S(0), n, S(1))))
    rule321 = ReplacementRule(pattern321, lambda f, a, A, e, b, x, m, d, B, n, c : -B*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n/(f*(m + n)) + Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(-1))*Simp(A*a*c*(m + n) - B*(a*d*n + b*c*m) + (m + n)*(A*a*d + A*b*c + B*a*c - B*b*d)*cot(e + f*x) + (A*b*d*(m + n) + B*(a*d*m + b*c*n))*cot(e + f*x)**S(2), x), x)/(m + n))
    rubi.add(rule321)

    pattern322 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule322 = ReplacementRule(pattern322, lambda f, a, A, e, b, x, d, B, c : b*(A*b - B*a)*Int((-a*tan(e + f*x) + b)/(a + b*tan(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)) + d*(-A*d + B*c)*Int((-c*tan(e + f*x) + d)/(c + d*tan(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + x*(A*(a*c - b*d) + B*(a*d + b*c))/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))))
    rubi.add(rule322)

    pattern323 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule323 = ReplacementRule(pattern323, lambda f, a, A, e, b, x, d, B, c : b*(A*b - B*a)*Int((-a*cot(e + f*x) + b)/(a + b*cot(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)) + d*(-A*d + B*c)*Int((-c*cot(e + f*x) + d)/(c + d*cot(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + x*(A*(a*c - b*d) + B*(a*d + b*c))/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))))
    rubi.add(rule323)

    pattern324 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule324 = ReplacementRule(pattern324, lambda f, a, A, e, b, x, d, B, c : -(-A*b + B*a)*(-a*d + b*c)*Int((tan(e + f*x)**S(2) + S(1))/((a + b*tan(e + f*x))*sqrt(c + d*tan(e + f*x))), x)/(a**S(2) + b**S(2)) + Int(Simp(A*(a*c + b*d) + B*(-a*d + b*c) - (A*(-a*d + b*c) - B*(a*c + b*d))*tan(e + f*x), x)/sqrt(c + d*tan(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule324)

    pattern325 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule325 = ReplacementRule(pattern325, lambda f, a, A, e, b, x, d, B, c : -(-A*b + B*a)*(-a*d + b*c)*Int((cot(e + f*x)**S(2) + S(1))/((a + b*cot(e + f*x))*sqrt(c + d*cot(e + f*x))), x)/(a**S(2) + b**S(2)) + Int(Simp(A*(a*c + b*d) + B*(-a*d + b*c) - (A*(-a*d + b*c) - B*(a*c + b*d))*cot(e + f*x), x)/sqrt(c + d*cot(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule325)

    pattern326 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule326 = ReplacementRule(pattern326, lambda f, a, A, e, b, x, d, B, n, c : b*(A*b - B*a)*Int((c + d*tan(e + f*x))**n*(tan(e + f*x)**S(2) + S(1))/(a + b*tan(e + f*x)), x)/(a**S(2) + b**S(2)) + Int((c + d*tan(e + f*x))**n*Simp(A*a + B*b - (A*b - B*a)*tan(e + f*x), x), x)/(a**S(2) + b**S(2)))
    rubi.add(rule326)

    pattern327 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule327 = ReplacementRule(pattern327, lambda f, a, A, e, b, x, d, B, n, c : b*(A*b - B*a)*Int((c + d*cot(e + f*x))**n*(cot(e + f*x)**S(2) + S(1))/(a + b*cot(e + f*x)), x)/(a**S(2) + b**S(2)) + Int((c + d*cot(e + f*x))**n*Simp(A*a + B*b - (A*b - B*a)*cot(e + f*x), x), x)/(a**S(2) + b**S(2)))
    rubi.add(rule327)

    pattern328 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule328 = ReplacementRule(pattern328, lambda f, a, A, e, b, x, d, B, c : B*b*Int((tan(e + f*x)**S(2) + S(1))/(sqrt(a + b*tan(e + f*x))*sqrt(c + d*tan(e + f*x))), x) + Int(Simp(A*a - B*b + (A*b + B*a)*tan(e + f*x), x)/(sqrt(a + b*tan(e + f*x))*sqrt(c + d*tan(e + f*x))), x))
    rubi.add(rule328)

    pattern329 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule329 = ReplacementRule(pattern329, lambda f, a, A, e, b, x, d, B, c : B*b*Int((cot(e + f*x)**S(2) + S(1))/(sqrt(a + b*cot(e + f*x))*sqrt(c + d*cot(e + f*x))), x) + Int(Simp(A*a - B*b + (A*b + B*a)*cot(e + f*x), x)/(sqrt(a + b*cot(e + f*x))*sqrt(c + d*cot(e + f*x))), x))
    rubi.add(rule329)

    pattern330 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, B: ZeroQ(A**S(2) + B**S(2))))
    rule330 = ReplacementRule(pattern330, lambda f, a, A, e, b, x, m, d, B, n, c : A**S(2)*Subst(Int((a + b*x)**m*(c + d*x)**n/(A - B*x), x), x, tan(e + f*x))/f)
    rubi.add(rule330)

    pattern331 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, B: ZeroQ(A**S(2) + B**S(2))))
    rule331 = ReplacementRule(pattern331, lambda f, a, A, e, b, x, m, d, B, n, c : -A**S(2)*Subst(Int((a + b*x)**m*(c + d*x)**n/(A - B*x), x), x, cot(e + f*x))/f)
    rubi.add(rule331)

    pattern332 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, B: NonzeroQ(A**S(2) + B**S(2))))
    rule332 = ReplacementRule(pattern332, lambda f, a, A, e, b, x, m, d, B, n, c : (A/S(2) - B*ImaginaryI/S(2))*Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n*(ImaginaryI*tan(e + f*x) + S(1)), x) + (A/S(2) + B*ImaginaryI/S(2))*Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n*(-ImaginaryI*tan(e + f*x) + S(1)), x))
    rubi.add(rule332)

    pattern333 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, B: NonzeroQ(A**S(2) + B**S(2))))
    rule333 = ReplacementRule(pattern333, lambda f, a, A, e, b, x, m, d, B, n, c : (A/S(2) - B*ImaginaryI/S(2))*Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n*(ImaginaryI*cot(e + f*x) + S(1)), x) + (A/S(2) + B*ImaginaryI/S(2))*Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n*(-ImaginaryI*cot(e + f*x) + S(1)), x))
    rubi.add(rule333)

    pattern334 = Pattern(Integral((A_ + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda A, C: ZeroQ(A - C)))
    rule334 = ReplacementRule(pattern334, lambda C, f, a, A, e, b, x, m : A*Subst(Int((a + x)**m, x), x, b*tan(e + f*x))/(b*f))
    rubi.add(rule334)

    pattern335 = Pattern(Integral((A_ + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda A, C: ZeroQ(A - C)))
    rule335 = ReplacementRule(pattern335, lambda C, f, a, A, e, b, x, m : -A*Subst(Int((a + x)**m, x), x, b*cot(e + f*x))/(b*f))
    rubi.add(rule335)

    pattern336 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, a, A, b, B: ZeroQ(A*b**S(2) - B*a*b + C*a**S(2))))
    rule336 = ReplacementRule(pattern336, lambda C, f, a, A, e, B, b, x, m : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(B*b - C*a + C*b*tan(e + f*x), x), x)/b**S(2))
    rubi.add(rule336)

    pattern337 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, a, A, b, B: ZeroQ(A*b**S(2) - B*a*b + C*a**S(2))))
    rule337 = ReplacementRule(pattern337, lambda C, f, a, A, e, B, b, x, m : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(B*b - C*a + C*b*cot(e + f*x), x), x)/b**S(2))
    rubi.add(rule337)

    pattern338 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda A, a, C, b: ZeroQ(A*b**S(2) + C*a**S(2))))
    rule338 = ReplacementRule(pattern338, lambda C, f, a, A, e, b, x, m : -C*Int((a - b*tan(e + f*x))*(a + b*tan(e + f*x))**(m + S(1)), x)/b**S(2))
    rubi.add(rule338)

    pattern339 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda A, a, C, b: ZeroQ(A*b**S(2) + C*a**S(2))))
    rule339 = ReplacementRule(pattern339, lambda C, f, a, A, e, b, x, m : -C*Int((a - b*cot(e + f*x))*(a + b*cot(e + f*x))**(m + S(1)), x)/b**S(2))
    rubi.add(rule339)

    pattern340 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule340 = ReplacementRule(pattern340, lambda C, f, a, A, e, B, b, x, m : (a + b*tan(e + f*x))**m*(-A*a - B*b + C*a)*tan(e + f*x)/(S(2)*a*f*m) + Int((a + b*tan(e + f*x))**(m + S(1))*Simp(A*a*(S(2)*m + S(1)) + B*b - C*a - (C*b*(m + S(-1)) + (m + S(1))*(A*b - B*a))*tan(e + f*x), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule340)

    pattern341 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule341 = ReplacementRule(pattern341, lambda C, f, a, A, e, B, b, x, m : (a + b*cot(e + f*x))**m*(A*a + B*b - C*a)*cot(e + f*x)/(S(2)*a*f*m) + Int((a + b*cot(e + f*x))**(m + S(1))*Simp(A*a*(S(2)*m + S(1)) + B*b - C*a - (C*b*(m + S(-1)) + (m + S(1))*(A*b - B*a))*cot(e + f*x), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule341)

    pattern342 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, a, C, b: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule342 = ReplacementRule(pattern342, lambda C, f, a, A, e, b, x, m : (a + b*tan(e + f*x))**m*(-A*a + C*a)*tan(e + f*x)/(S(2)*a*f*m) + Int((a + b*tan(e + f*x))**(m + S(1))*Simp(A*a*(S(2)*m + S(1)) - C*a - (A*b*(m + S(1)) + C*b*(m + S(-1)))*tan(e + f*x), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule342)

    pattern343 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, a, C, b: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1))), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule343 = ReplacementRule(pattern343, lambda C, f, a, A, e, b, x, m : (a + b*cot(e + f*x))**m*(A*a - C*a)*cot(e + f*x)/(S(2)*a*f*m) + Int((a + b*cot(e + f*x))**(m + S(1))*Simp(A*a*(S(2)*m + S(1)) - C*a - (A*b*(m + S(1)) + C*b*(m + S(-1)))*cot(e + f*x), x), x)/(S(2)*a**S(2)*m))
    rubi.add(rule343)

    pattern344 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda C, a, A, b, B: ZeroQ(A*b - B*a - C*b)))
    rule344 = ReplacementRule(pattern344, lambda C, f, a, A, e, b, x, B : x*(A*a + B*b - C*a)/(a**S(2) + b**S(2)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int((tan(e + f*x)**S(2) + S(1))/(a + b*tan(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule344)

    pattern345 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda C, a, A, b, B: ZeroQ(A*b - B*a - C*b)))
    rule345 = ReplacementRule(pattern345, lambda C, f, a, A, e, b, x, B : x*(A*a + B*b - C*a)/(a**S(2) + b**S(2)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int((cot(e + f*x)**S(2) + S(1))/(a + b*cot(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule345)

    pattern346 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/tan(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, C: NonzeroQ(A - C)))
    rule346 = ReplacementRule(pattern346, lambda C, f, A, e, x, B : A*Int(1/tan(e + f*x), x) + B*x + C*Int(tan(e + f*x), x))
    rubi.add(rule346)

    pattern347 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/cot(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, C: NonzeroQ(A - C)))
    rule347 = ReplacementRule(pattern347, lambda C, f, A, e, x, B : A*Int(1/cot(e + f*x), x) + B*x + C*Int(cot(e + f*x), x))
    rubi.add(rule347)

    pattern348 = Pattern(Integral((A_ + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/tan(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, C: NonzeroQ(A - C)))
    rule348 = ReplacementRule(pattern348, lambda C, f, A, e, x : A*Int(1/tan(e + f*x), x) + C*Int(tan(e + f*x), x))
    rubi.add(rule348)

    pattern349 = Pattern(Integral((A_ + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/cot(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, C: NonzeroQ(A - C)))
    rule349 = ReplacementRule(pattern349, lambda C, f, A, e, x : A*Int(1/cot(e + f*x), x) + C*Int(cot(e + f*x), x))
    rubi.add(rule349)

    pattern350 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b - B*a - C*b)))
    rule350 = ReplacementRule(pattern350, lambda C, f, a, A, e, b, x, B : x*(A*a + B*b - C*a)/(a**S(2) + b**S(2)) - (A*b - B*a - C*b)*Int(tan(e + f*x), x)/(a**S(2) + b**S(2)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int((tan(e + f*x)**S(2) + S(1))/(a + b*tan(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule350)

    pattern351 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b - B*a - C*b)))
    rule351 = ReplacementRule(pattern351, lambda C, f, a, A, e, b, x, B : x*(A*a + B*b - C*a)/(a**S(2) + b**S(2)) - (A*b - B*a - C*b)*Int(cot(e + f*x), x)/(a**S(2) + b**S(2)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int((cot(e + f*x)**S(2) + S(1))/(a + b*cot(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule351)

    pattern352 = Pattern(Integral((A_ + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, C, b, a: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, C: NonzeroQ(A - C)))
    rule352 = ReplacementRule(pattern352, lambda C, f, a, A, e, b, x : a*x*(A - C)/(a**S(2) + b**S(2)) - b*(A - C)*Int(tan(e + f*x), x)/(a**S(2) + b**S(2)) + (A*b**S(2) + C*a**S(2))*Int((tan(e + f*x)**S(2) + S(1))/(a + b*tan(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule352)

    pattern353 = Pattern(Integral((A_ + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, C, b, a: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda A, C: NonzeroQ(A - C)))
    rule353 = ReplacementRule(pattern353, lambda C, f, a, A, e, x, b : a*x*(A - C)/(a**S(2) + b**S(2)) - b*(A - C)*Int(cot(e + f*x), x)/(a**S(2) + b**S(2)) + (A*b**S(2) + C*a**S(2))*Int((cot(e + f*x)**S(2) + S(1))/(a + b*cot(e + f*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule353)

    pattern354 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule354 = ReplacementRule(pattern354, lambda C, f, a, A, e, b, x, m, B : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(B*b + a*(A - C) - (A*b - B*a - C*b)*tan(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*tan(e + f*x))**(m + S(1))*(A*b**S(2) - B*a*b + C*a**S(2))/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule354)

    pattern355 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule355 = ReplacementRule(pattern355, lambda C, f, a, A, e, b, x, m, B : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(B*b + a*(A - C) - (A*b - B*a - C*b)*cot(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*cot(e + f*x))**(m + S(1))*(-A*b**S(2) + B*a*b - C*a**S(2))/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule355)

    pattern356 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, a, C, b: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule356 = ReplacementRule(pattern356, lambda C, f, a, A, e, b, x, m : Int((a + b*tan(e + f*x))**(m + S(1))*Simp(a*(A - C) - (A*b - C*b)*tan(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*tan(e + f*x))**(m + S(1))*(A*b**S(2) + C*a**S(2))/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule356)

    pattern357 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda A, a, C, b: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule357 = ReplacementRule(pattern357, lambda C, f, a, A, e, b, x, m : Int((a + b*cot(e + f*x))**(m + S(1))*Simp(a*(A - C) - (A*b - C*b)*cot(e + f*x), x), x)/(a**S(2) + b**S(2)) + (a + b*cot(e + f*x))**(m + S(1))*(-A*b**S(2) - C*a**S(2))/(b*f*(a**S(2) + b**S(2))*(m + S(1))))
    rubi.add(rule357)

    pattern358 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))))
    rule358 = ReplacementRule(pattern358, lambda C, f, a, A, e, B, b, x, m : C*(a + b*tan(e + f*x))**(m + S(1))/(b*f*(m + S(1))) + Int((a + b*tan(e + f*x))**m*Simp(A + B*tan(e + f*x) - C, x), x))
    rubi.add(rule358)

    pattern359 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, a, A, b, B: NonzeroQ(A*b**S(2) - B*a*b + C*a**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))))
    rule359 = ReplacementRule(pattern359, lambda C, f, a, A, e, B, b, x, m : -C*(a + b*cot(e + f*x))**(m + S(1))/(b*f*(m + S(1))) + Int((a + b*cot(e + f*x))**m*Simp(A + B*cot(e + f*x) - C, x), x))
    rubi.add(rule359)

    pattern360 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda A, a, C, b: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))))
    rule360 = ReplacementRule(pattern360, lambda C, f, a, A, e, b, x, m : C*(a + b*tan(e + f*x))**(m + S(1))/(b*f*(m + S(1))) + (A - C)*Int((a + b*tan(e + f*x))**m, x))
    rubi.add(rule360)

    pattern361 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda A, a, C, b: NonzeroQ(A*b**S(2) + C*a**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & LessEqual(m, S(-1)))))
    rule361 = ReplacementRule(pattern361, lambda C, f, a, A, e, b, x, m : -C*(a + b*cot(e + f*x))**(m + S(1))/(b*f*(m + S(1))) + (A - C)*Int((a + b*cot(e + f*x))**m, x))
    rubi.add(rule361)

    pattern362 = Pattern(Integral((A_ + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda A, C: ZeroQ(A - C)))
    rule362 = ReplacementRule(pattern362, lambda C, f, a, A, e, b, x, d, m, n, c : A*Subst(Int((a + b*x)**m*(c + d*x)**n, x), x, tan(e + f*x))/f)
    rubi.add(rule362)

    pattern363 = Pattern(Integral((A_ + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda A, C: ZeroQ(A - C)))
    rule363 = ReplacementRule(pattern363, lambda C, f, a, A, e, b, x, d, m, n, c : -A*Subst(Int((a + b*x)**m*(c + d*x)**n, x), x, cot(e + f*x))/f)
    rubi.add(rule363)

    pattern364 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule364 = ReplacementRule(pattern364, lambda C, f, a, A, e, b, x, d, B, n, c : Int((c + d*tan(e + f*x))**(n + S(1))*Simp(C*b*(c**S(2) + d**S(2))*tan(e + f*x)**S(2) + a*d*(A*c + B*d - C*c) + b*(A*d**S(2) - B*c*d + C*c**S(2)) + d*(-A*a*d + A*b*c + B*a*c + B*b*d + C*a*d - C*b*c)*tan(e + f*x), x), x)/(d*(c**S(2) + d**S(2))) + (c + d*tan(e + f*x))**(n + S(1))*(a*d - b*c)*(A*d**S(2) - B*c*d + C*c**S(2))/(d**S(2)*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule364)

    pattern365 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule365 = ReplacementRule(pattern365, lambda C, f, a, A, e, b, x, d, B, n, c : Int((c + d*cot(e + f*x))**(n + S(1))*Simp(C*b*(c**S(2) + d**S(2))*cot(e + f*x)**S(2) + a*d*(A*c + B*d - C*c) + b*(A*d**S(2) - B*c*d + C*c**S(2)) + d*(-A*a*d + A*b*c + B*a*c + B*b*d + C*a*d - C*b*c)*cot(e + f*x), x), x)/(d*(c**S(2) + d**S(2))) + (c + d*cot(e + f*x))**(n + S(1))*(-a*d + b*c)*(A*d**S(2) - B*c*d + C*c**S(2))/(d**S(2)*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule365)

    pattern366 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule366 = ReplacementRule(pattern366, lambda C, f, a, A, e, b, x, d, n, c : Int((c + d*tan(e + f*x))**(n + S(1))*Simp(C*b*(c**S(2) + d**S(2))*tan(e + f*x)**S(2) + a*d*(A*c - C*c) + b*(A*d**S(2) + C*c**S(2)) + d*(-A*a*d + A*b*c + C*a*d - C*b*c)*tan(e + f*x), x), x)/(d*(c**S(2) + d**S(2))) + (c + d*tan(e + f*x))**(n + S(1))*(A*d**S(2) + C*c**S(2))*(a*d - b*c)/(d**S(2)*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule366)

    pattern367 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule367 = ReplacementRule(pattern367, lambda C, f, a, A, e, b, x, d, n, c : Int((c + d*cot(e + f*x))**(n + S(1))*Simp(C*b*(c**S(2) + d**S(2))*cot(e + f*x)**S(2) + a*d*(A*c - C*c) + b*(A*d**S(2) + C*c**S(2)) + d*(-A*a*d + A*b*c + C*a*d - C*b*c)*cot(e + f*x), x), x)/(d*(c**S(2) + d**S(2))) + (c + d*cot(e + f*x))**(n + S(1))*(A*d**S(2) + C*c**S(2))*(-a*d + b*c)/(d**S(2)*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule367)

    pattern368 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Less(n, S(-1)))))
    rule368 = ReplacementRule(pattern368, lambda C, f, a, A, e, b, x, d, B, n, c : C*b*(c + d*tan(e + f*x))**(n + S(1))*tan(e + f*x)/(d*f*(n + S(2))) - Int((c + d*tan(e + f*x))**n*Simp(-A*a*d*(n + S(2)) + C*b*c - d*(n + S(2))*(A*b + B*a - C*b)*tan(e + f*x) - (C*a*d*(n + S(2)) - b*(-B*d*(n + S(2)) + C*c))*tan(e + f*x)**S(2), x), x)/(d*(n + S(2))))
    rubi.add(rule368)

    pattern369 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Less(n, S(-1)))))
    rule369 = ReplacementRule(pattern369, lambda C, f, a, A, e, b, x, d, B, n, c : -C*b*(c + d*cot(e + f*x))**(n + S(1))*cot(e + f*x)/(d*f*(n + S(2))) - Int((c + d*cot(e + f*x))**n*Simp(-A*a*d*(n + S(2)) + C*b*c - d*(n + S(2))*(A*b + B*a - C*b)*cot(e + f*x) - (C*a*d*(n + S(2)) - b*(-B*d*(n + S(2)) + C*c))*cot(e + f*x)**S(2), x), x)/(d*(n + S(2))))
    rubi.add(rule369)

    pattern370 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Less(n, S(-1)))))
    rule370 = ReplacementRule(pattern370, lambda C, f, a, A, e, b, x, d, n, c : C*b*(c + d*tan(e + f*x))**(n + S(1))*tan(e + f*x)/(d*f*(n + S(2))) - Int((c + d*tan(e + f*x))**n*Simp(-A*a*d*(n + S(2)) + C*b*c - d*(n + S(2))*(A*b - C*b)*tan(e + f*x) - (C*a*d*(n + S(2)) - C*b*c)*tan(e + f*x)**S(2), x), x)/(d*(n + S(2))))
    rubi.add(rule370)

    pattern371 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Less(n, S(-1)))))
    rule371 = ReplacementRule(pattern371, lambda C, f, a, A, e, b, x, d, n, c : -C*b*(c + d*cot(e + f*x))**(n + S(1))*cot(e + f*x)/(d*f*(n + S(2))) - Int((c + d*cot(e + f*x))**n*Simp(-A*a*d*(n + S(2)) + C*b*c - d*(n + S(2))*(A*b - C*b)*cot(e + f*x) - (C*a*d*(n + S(2)) - C*b*c)*cot(e + f*x)**S(2), x), x)/(d*(n + S(2))))
    rubi.add(rule371)

    pattern372 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1)) | (RationalQ(m) & Less(m, S(0)))))
    rule372 = ReplacementRule(pattern372, lambda C, f, a, A, e, b, x, m, d, B, n, c : (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*(A*a + B*b - C*a)/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(a*(-A*d*(S(2)*m + n + S(1)) + B*c*m + C*d*(n + S(1))) + b*(-B*d*(n + S(1)) + c*m*(A + C)) + (A*b*d*(m + n + S(1)) + C*b*d*(m - n + S(-1)) + a*(-B*d*(m + n + S(1)) + S(2)*C*c*m))*tan(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule372)

    pattern373 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1)) | (RationalQ(m) & Less(m, S(0)))))
    rule373 = ReplacementRule(pattern373, lambda C, f, a, A, e, b, x, m, d, B, n, c : (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*(-A*a - B*b + C*a)/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(a*(-A*d*(S(2)*m + n + S(1)) + B*c*m + C*d*(n + S(1))) + b*(-B*d*(n + S(1)) + c*m*(A + C)) + (A*b*d*(m + n + S(1)) + C*b*d*(m - n + S(-1)) + a*(-B*d*(m + n + S(1)) + S(2)*C*c*m))*cot(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule373)

    pattern374 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1)) | (RationalQ(m) & Less(m, S(0)))))
    rule374 = ReplacementRule(pattern374, lambda C, f, a, A, e, b, x, d, m, n, c : a*(A - C)*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(a*(-A*d*(S(2)*m + n + S(1)) + C*d*(n + S(1))) + b*c*m*(A + C) + (A*b*d*(m + n + S(1)) + S(2)*C*a*c*m + C*b*d*(m - n + S(-1)))*tan(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule374)

    pattern375 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1)) | (RationalQ(m) & Less(m, S(0)))))
    rule375 = ReplacementRule(pattern375, lambda C, f, a, A, e, b, x, d, m, n, c : -a*(A - C)*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(S(2)*f*m*(-a*d + b*c)) + Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(a*(-A*d*(S(2)*m + n + S(1)) + C*d*(n + S(1))) + b*c*m*(A + C) + (A*b*d*(m + n + S(1)) + S(2)*C*a*c*m + C*b*d*(m - n + S(-1)))*cot(e + f*x), x), x)/(S(2)*a*m*(-a*d + b*c)))
    rubi.add(rule375)

    pattern376 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule376 = ReplacementRule(pattern376, lambda C, f, a, A, e, B, b, x, d, m, n, c : (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*(A*d**S(2) - B*c*d + C*c**S(2))/(d*f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*Simp(-a*d*(n + S(1))*(A*c + B*d - C*c) - a*(-C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(1)))*tan(e + f*x) + b*m*(A*d**S(2) - B*c*d + C*c**S(2)), x), x)/(a*d*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule376)

    pattern377 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule377 = ReplacementRule(pattern377, lambda C, f, a, A, e, b, x, m, d, B, n, c : (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*(-A*d**S(2) + B*c*d - C*c**S(2))/(d*f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*Simp(-a*d*(n + S(1))*(A*c + B*d - C*c) - a*(-C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(1)))*cot(e + f*x) + b*m*(A*d**S(2) - B*c*d + C*c**S(2)), x), x)/(a*d*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule377)

    pattern378 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule378 = ReplacementRule(pattern378, lambda C, f, a, A, e, b, x, d, m, n, c : (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*(A*d**S(2) + C*c**S(2))/(d*f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*Simp(-a*d*(n + S(1))*(A*c - C*c) - a*(-A*d**S(2)*(m + n + S(1)) - C*(c**S(2)*m - d**S(2)*(n + S(1))))*tan(e + f*x) + b*m*(A*d**S(2) + C*c**S(2)), x), x)/(a*d*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule378)

    pattern379 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule379 = ReplacementRule(pattern379, lambda C, f, a, A, e, b, x, d, m, n, c : (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*(-A*d**S(2) - C*c**S(2))/(d*f*(c**S(2) + d**S(2))*(n + S(1))) - Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*Simp(-a*d*(n + S(1))*(A*c - C*c) - a*(-A*d**S(2)*(m + n + S(1)) - C*(c**S(2)*m - d**S(2)*(n + S(1))))*cot(e + f*x) + b*m*(A*d**S(2) + C*c**S(2)), x), x)/(a*d*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule379)

    pattern380 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule380 = ReplacementRule(pattern380, lambda C, f, a, A, e, B, b, x, d, m, n, c : C*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n*Simp(A*b*d*(m + n + S(1)) + C*(a*c*m - b*d*(n + S(1))) - (-B*b*d*(m + n + S(1)) + C*m*(-a*d + b*c))*tan(e + f*x), x), x)/(b*d*(m + n + S(1))))
    rubi.add(rule380)

    pattern381 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule381 = ReplacementRule(pattern381, lambda C, f, a, A, e, b, x, m, d, B, n, c : -C*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n*Simp(A*b*d*(m + n + S(1)) + C*(a*c*m - b*d*(n + S(1))) - (-B*b*d*(m + n + S(1)) + C*m*(-a*d + b*c))*cot(e + f*x), x), x)/(b*d*(m + n + S(1))))
    rubi.add(rule381)

    pattern382 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule382 = ReplacementRule(pattern382, lambda C, f, a, A, e, b, x, d, m, n, c : C*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**n*Simp(A*b*d*(m + n + S(1)) - C*m*(-a*d + b*c)*tan(e + f*x) + C*(a*c*m - b*d*(n + S(1))), x), x)/(b*d*(m + n + S(1))))
    rubi.add(rule382)

    pattern383 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(RationalQ(m) & Less(m, S(0)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule383 = ReplacementRule(pattern383, lambda C, f, a, A, e, b, x, d, m, n, c : -C*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**n*Simp(A*b*d*(m + n + S(1)) - C*m*(-a*d + b*c)*cot(e + f*x) + C*(a*c*m - b*d*(n + S(1))), x), x)/(b*d*(m + n + S(1))))
    rubi.add(rule383)

    pattern384 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule384 = ReplacementRule(pattern384, lambda C, f, a, A, e, b, x, m, d, B, n, c : -Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))*Simp(A*d*(-a*c*(n + S(1)) + b*d*m) - b*(-C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(1)))*tan(e + f*x)**S(2) - d*(n + S(1))*(B*(a*c + b*d) + (A - C)*(-a*d + b*c))*tan(e + f*x) + (-B*d + C*c)*(a*d*(n + S(1)) + b*c*m), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) + (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*(A*d**S(2) + c*(-B*d + C*c))/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule384)

    pattern385 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule385 = ReplacementRule(pattern385, lambda C, f, a, A, e, b, x, m, d, B, n, c : -Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))*Simp(A*d*(-a*c*(n + S(1)) + b*d*m) - b*(-C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(1)))*cot(e + f*x)**S(2) - d*(n + S(1))*(B*(a*c + b*d) + (A - C)*(-a*d + b*c))*cot(e + f*x) + (-B*d + C*c)*(a*d*(n + S(1)) + b*c*m), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) + (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*(-A*d**S(2) - c*(-B*d + C*c))/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule385)

    pattern386 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule386 = ReplacementRule(pattern386, lambda C, f, a, A, e, b, x, d, m, n, c : -Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**(n + S(1))*Simp(A*d*(-a*c*(n + S(1)) + b*d*m) + C*c*(a*d*(n + S(1)) + b*c*m) + b*(A*d**S(2)*(m + n + S(1)) + C*(c**S(2)*m - d**S(2)*(n + S(1))))*tan(e + f*x)**S(2) - d*(A - C)*(n + S(1))*(-a*d + b*c)*tan(e + f*x), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) + (a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))*(A*d**S(2) + C*c**S(2))/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule386)

    pattern387 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule387 = ReplacementRule(pattern387, lambda C, f, a, A, e, b, x, d, m, n, c : -Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**(n + S(1))*Simp(A*d*(-a*c*(n + S(1)) + b*d*m) + C*c*(a*d*(n + S(1)) + b*c*m) + b*(A*d**S(2)*(m + n + S(1)) + C*(c**S(2)*m - d**S(2)*(n + S(1))))*cot(e + f*x)**S(2) - d*(A - C)*(n + S(1))*(-a*d + b*c)*cot(e + f*x), x), x)/(d*(c**S(2) + d**S(2))*(n + S(1))) + (a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))*(-A*d**S(2) - C*c**S(2))/(d*f*(c**S(2) + d**S(2))*(n + S(1))))
    rubi.add(rule387)

    pattern388 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(0)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule388 = ReplacementRule(pattern388, lambda C, f, a, A, e, B, b, x, d, m, n, c : C*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**n*Simp(A*a*d*(m + n + S(1)) - C*(a*d*(n + S(1)) + b*c*m) + d*(m + n + S(1))*(A*b + B*a - C*b)*tan(e + f*x) - (-B*b*d*(m + n + S(1)) + C*m*(-a*d + b*c))*tan(e + f*x)**S(2), x), x)/(d*(m + n + S(1))))
    rubi.add(rule388)

    pattern389 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(0)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule389 = ReplacementRule(pattern389, lambda C, f, a, A, e, B, b, x, d, m, n, c : -C*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**n*Simp(A*a*d*(m + n + S(1)) - C*(a*d*(n + S(1)) + b*c*m) + d*(m + n + S(1))*(A*b + B*a - C*b)*cot(e + f*x) - (-B*b*d*(m + n + S(1)) + C*m*(-a*d + b*c))*cot(e + f*x)**S(2), x), x)/(d*(m + n + S(1))))
    rubi.add(rule389)

    pattern390 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(0)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule390 = ReplacementRule(pattern390, lambda C, f, a, A, e, b, x, d, m, n, c : C*(a + b*tan(e + f*x))**m*(c + d*tan(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*tan(e + f*x))**(m + S(-1))*(c + d*tan(e + f*x))**n*Simp(A*a*d*(m + n + S(1)) - C*m*(-a*d + b*c)*tan(e + f*x)**S(2) - C*(a*d*(n + S(1)) + b*c*m) + d*(A*b - C*b)*(m + n + S(1))*tan(e + f*x), x), x)/(d*(m + n + S(1))))
    rubi.add(rule390)

    pattern391 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Greater(n, S(0)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule391 = ReplacementRule(pattern391, lambda C, f, a, A, e, b, x, d, m, n, c : -C*(a + b*cot(e + f*x))**m*(c + d*cot(e + f*x))**(n + S(1))/(d*f*(m + n + S(1))) + Int((a + b*cot(e + f*x))**(m + S(-1))*(c + d*cot(e + f*x))**n*Simp(A*a*d*(m + n + S(1)) - C*m*(-a*d + b*c)*cot(e + f*x)**S(2) - C*(a*d*(n + S(1)) + b*c*m) + d*(A*b - C*b)*(m + n + S(1))*cot(e + f*x), x), x)/(d*(m + n + S(1))))
    rubi.add(rule391)

    pattern392 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule392 = ReplacementRule(pattern392, lambda C, f, a, A, e, b, x, m, d, B, n, c : Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(A*(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))) - d*(A*b**S(2) - a*(B*b - C*a))*(m + n + S(2))*tan(e + f*x)**S(2) - (m + S(1))*(-a*d + b*c)*(A*b - B*a - C*b)*tan(e + f*x) + (B*b - C*a)*(a*d*(n + S(1)) + b*c*(m + S(1))), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(1))*(A*b**S(2) - a*(B*b - C*a))/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule392)

    pattern393 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule393 = ReplacementRule(pattern393, lambda C, f, a, A, e, b, x, m, d, B, n, c : Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(A*(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))) - d*(A*b**S(2) - a*(B*b - C*a))*(m + n + S(2))*cot(e + f*x)**S(2) - (m + S(1))*(-a*d + b*c)*(A*b - B*a - C*b)*cot(e + f*x) + (B*b - C*a)*(a*d*(n + S(1)) + b*c*(m + S(1))), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(1))*(-A*b**S(2) + a*(B*b - C*a))/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule393)

    pattern394 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule394 = ReplacementRule(pattern394, lambda C, f, a, A, e, b, x, d, m, n, c : Int((a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**n*Simp(A*(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))) - C*a*(a*d*(n + S(1)) + b*c*(m + S(1))) - d*(A*b**S(2) + C*a**S(2))*(m + n + S(2))*tan(e + f*x)**S(2) - (m + S(1))*(A*b - C*b)*(-a*d + b*c)*tan(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*tan(e + f*x))**(m + S(1))*(c + d*tan(e + f*x))**(n + S(1))*(A*b**S(2) + C*a**S(2))/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule394)

    pattern395 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n, c, a: Not(IntegerQ(n) & Less(n, S(-1)) & (Not(IntegerQ(m)) | (NonzeroQ(a) & ZeroQ(c))))))
    rule395 = ReplacementRule(pattern395, lambda C, f, a, A, e, b, x, d, m, n, c : Int((a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**n*Simp(A*(a*(m + S(1))*(-a*d + b*c) - b**S(2)*d*(m + n + S(2))) - C*a*(a*d*(n + S(1)) + b*c*(m + S(1))) - d*(A*b**S(2) + C*a**S(2))*(m + n + S(2))*cot(e + f*x)**S(2) - (m + S(1))*(A*b - C*b)*(-a*d + b*c)*cot(e + f*x), x), x)/((a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*cot(e + f*x))**(m + S(1))*(c + d*cot(e + f*x))**(n + S(1))*(-A*b**S(2) - C*a**S(2))/(f*(a**S(2) + b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule395)

    pattern396 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule396 = ReplacementRule(pattern396, lambda C, f, a, A, e, b, x, d, B, c : x*(a*(A*c + B*d - C*c) + b*(-A*d + B*c + C*d))/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))) - (A*d**S(2) - B*c*d + C*c**S(2))*Int((-c*tan(e + f*x) + d)/(c + d*tan(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int((-a*tan(e + f*x) + b)/(a + b*tan(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)))
    rubi.add(rule396)

    pattern397 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule397 = ReplacementRule(pattern397, lambda C, f, a, A, e, b, x, d, B, c : x*(a*(A*c + B*d - C*c) + b*(-A*d + B*c + C*d))/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))) - (A*d**S(2) - B*c*d + C*c**S(2))*Int((-c*cot(e + f*x) + d)/(c + d*cot(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int((-a*cot(e + f*x) + b)/(a + b*cot(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)))
    rubi.add(rule397)

    pattern398 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule398 = ReplacementRule(pattern398, lambda C, f, a, A, e, b, x, d, c : x*(a*(A*c - C*c) - b*(A*d - C*d))/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))) - (A*d**S(2) + C*c**S(2))*Int((-c*tan(e + f*x) + d)/(c + d*tan(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + (A*b**S(2) + C*a**S(2))*Int((-a*tan(e + f*x) + b)/(a + b*tan(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)))
    rubi.add(rule398)

    pattern399 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule399 = ReplacementRule(pattern399, lambda C, f, a, A, e, b, x, d, c : x*(a*(A*c - C*c) - b*(A*d - C*d))/((a**S(2) + b**S(2))*(c**S(2) + d**S(2))) - (A*d**S(2) + C*c**S(2))*Int((-c*cot(e + f*x) + d)/(c + d*cot(e + f*x)), x)/((c**S(2) + d**S(2))*(-a*d + b*c)) + (A*b**S(2) + C*a**S(2))*Int((-a*cot(e + f*x) + b)/(a + b*cot(e + f*x)), x)/((a**S(2) + b**S(2))*(-a*d + b*c)))
    rubi.add(rule399)

    pattern400 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda n: Not(RationalQ(n) & LessEqual(n, S(-1)))))
    rule400 = ReplacementRule(pattern400, lambda C, f, a, A, e, b, x, d, B, n, c : (A*b**S(2) - B*a*b + C*a**S(2))*Int((c + d*tan(e + f*x))**n*(tan(e + f*x)**S(2) + S(1))/(a + b*tan(e + f*x)), x)/(a**S(2) + b**S(2)) + Int((c + d*tan(e + f*x))**n*Simp(B*b + a*(A - C) + (B*a - b*(A - C))*tan(e + f*x), x), x)/(a**S(2) + b**S(2)))
    rubi.add(rule400)

    pattern401 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda n: Not(RationalQ(n) & LessEqual(n, S(-1)))))
    rule401 = ReplacementRule(pattern401, lambda C, f, a, A, e, b, x, d, B, n, c : (A*b**S(2) - B*a*b + C*a**S(2))*Int((c + d*cot(e + f*x))**n*(cot(e + f*x)**S(2) + S(1))/(a + b*cot(e + f*x)), x)/(a**S(2) + b**S(2)) + Int((c + d*cot(e + f*x))**n*Simp(B*b + a*(A - C) + (B*a - b*(A - C))*cot(e + f*x), x), x)/(a**S(2) + b**S(2)))
    rubi.add(rule401)

    pattern402 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda n: Not(RationalQ(n) & LessEqual(n, S(-1)))))
    rule402 = ReplacementRule(pattern402, lambda C, f, a, A, e, b, x, d, n, c : (A*b**S(2) + C*a**S(2))*Int((c + d*tan(e + f*x))**n*(tan(e + f*x)**S(2) + S(1))/(a + b*tan(e + f*x)), x)/(a**S(2) + b**S(2)) + Int((c + d*tan(e + f*x))**n*Simp(a*(A - C) - (A*b - C*b)*tan(e + f*x), x), x)/(a**S(2) + b**S(2)))
    rubi.add(rule402)

    pattern403 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))), CustomConstraint(lambda n: Not(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda n: Not(RationalQ(n) & LessEqual(n, S(-1)))))
    rule403 = ReplacementRule(pattern403, lambda C, f, a, A, e, b, x, d, n, c : (A*b**S(2) + C*a**S(2))*Int((c + d*cot(e + f*x))**n*(cot(e + f*x)**S(2) + S(1))/(a + b*cot(e + f*x)), x)/(a**S(2) + b**S(2)) + Int((c + d*cot(e + f*x))**n*Simp(a*(A - C) - (A*b - C*b)*cot(e + f*x), x), x)/(a**S(2) + b**S(2)))
    rubi.add(rule403)

    pattern404 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule404 = ReplacementRule(pattern404, lambda C, f, a, A, e, b, x, m, d, B, n, c : Subst(Int((a + x)**m*(c + d*x/b)**n*(A*b**S(2) + B*b*x + C*x**S(2))/(b**S(2) + x**S(2)), x), x, b*tan(e + f*x))/(b*f))
    rubi.add(rule404)

    pattern405 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule405 = ReplacementRule(pattern405, lambda C, f, a, A, e, b, x, m, d, B, n, c : -Subst(Int((a + x)**m*(c + d*x/b)**n*(A*b**S(2) + B*b*x + C*x**S(2))/(b**S(2) + x**S(2)), x), x, b*cot(e + f*x))/(b*f))
    rubi.add(rule405)

    pattern406 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule406 = ReplacementRule(pattern406, lambda C, f, a, A, e, b, x, d, m, n, c : Subst(Int((a + x)**m*(c + d*x/b)**n*(A*b**S(2) + C*x**S(2))/(b**S(2) + x**S(2)), x), x, b*tan(e + f*x))/(b*f))
    rubi.add(rule406)

    pattern407 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, d, c, b: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) + d**S(2))))
    rule407 = ReplacementRule(pattern407, lambda C, f, a, A, e, b, x, d, m, n, c : -Subst(Int((a + x)**m*(c + d*x/b)**n*(A*b**S(2) + C*x**S(2))/(b**S(2) + x**S(2)), x), x, b*cot(e + f*x))/(b*f))
    rubi.add(rule407)

    pattern408 = Pattern(Integral(1/(a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a - b)))
    rule408 = ReplacementRule(pattern408, lambda a, x, b, d, c : Int(cos(c + d*x)**S(2), x)/a)
    rubi.add(rule408)

    pattern409 = Pattern(Integral(1/(a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: ZeroQ(a - b)))
    rule409 = ReplacementRule(pattern409, lambda a, x, b, d, c : Int(sin(c + d*x)**S(2), x)/a)
    rubi.add(rule409)

    pattern410 = Pattern(Integral(1/(a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a - b)))
    rule410 = ReplacementRule(pattern410, lambda a, x, b, d, c : -b*Int(sec(c + d*x)**S(2)/(a + b*tan(c + d*x)**S(2)), x)/(a - b) + x/(a - b))
    rubi.add(rule410)

    pattern411 = Pattern(Integral(1/(a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda b, a: NonzeroQ(a - b)))
    rule411 = ReplacementRule(pattern411, lambda a, x, b, d, c : -b*Int(csc(c + d*x)**S(2)/(a + b*cot(c + d*x)**S(2)), x)/(a - b) + x/(a - b))
    rubi.add(rule411)

    pattern412 = Pattern(Integral((a_ + (WC('e', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule412 = ReplacementRule(pattern412, lambda a, e, b, x, d, p, n, c : e*Subst(Int((a + b*x**n)**p/(e**S(2) + x**S(2)), x), x, e*tan(c + d*x))/d)
    rubi.add(rule412)

    pattern413 = Pattern(Integral((a_ + (WC('e', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule413 = ReplacementRule(pattern413, lambda a, e, x, b, d, p, n, c : -e*Subst(Int((a + b*x**n)**p/(e**S(2) + x**S(2)), x), x, e*cot(c + d*x))/d)
    rubi.add(rule413)

    pattern414 = Pattern(Integral((a_ + (WC('e', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))), )
    def With414(a, e, x, b, d, p, m, n, c):
        f = FreeFactors(tan(c + d*x), x)
        return f**(m + S(1))*Subst(Int(x**m*(a + b*(e*f*x)**n)**p*(f**S(2)*x**S(2) + S(1))**(-m/S(2) + S(-1)), x), x, tan(c + d*x)/f)/d
    rule414 = ReplacementRule(pattern414, lambda a, e, x, b, d, p, m, n, c : With414(a, e, x, b, d, p, m, n, c))
    rubi.add(rule414)

    pattern415 = Pattern(Integral((a_ + (WC('e', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**p_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))), )
    def With415(a, e, x, b, d, p, m, n, c):
        f = FreeFactors(cot(c + d*x), x)
        return -f**(m + S(1))*Subst(Int(x**m*(a + b*(e*f*x)**n)**p*(f**S(2)*x**S(2) + S(1))**(-m/S(2) + S(-1)), x), x, cot(c + d*x)/f)/d
    rule415 = ReplacementRule(pattern415, lambda a, e, x, b, d, p, m, n, c : With415(a, e, x, b, d, p, m, n, c))
    rubi.add(rule415)

    pattern416 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), )
    def With416(a, b, x, d, p, m, n, c):
        f = FreeFactors(cos(c + d*x), x)
        return -f*Subst(Int((f*x)**(-n*p)*(-f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*ExpandToSum(a*(f*x)**n + b*(-f**S(2)*x**S(2) + S(1))**(n/S(2)), x)**p, x), x, cos(c + d*x)/f)/d
    rule416 = ReplacementRule(pattern416, lambda a, b, x, d, p, m, n, c : With416(a, b, x, d, p, m, n, c))
    rubi.add(rule416)

    pattern417 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), )
    def With417(a, b, x, d, p, m, n, c):
        f = FreeFactors(sin(c + d*x), x)
        return f*Subst(Int((f*x)**(-n*p)*(-f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*ExpandToSum(a*(f*x)**n + b*(-f**S(2)*x**S(2) + S(1))**(n/S(2)), x)**p, x), x, sin(c + d*x)/f)/d
    rule417 = ReplacementRule(pattern417, lambda a, b, x, d, p, m, n, c : With417(a, b, x, d, p, m, n, c))
    rubi.add(rule417)

    pattern418 = Pattern(Integral((a_ + (WC('e', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**WC('p', S(1))*sec(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))), )
    def With418(a, e, b, x, d, p, m, n, c):
        f = FreeFactors(tan(c + d*x), x)
        return f*Subst(Int((a + b*(e*f*x)**n)**p*(f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)), x), x, tan(c + d*x)/f)/d
    rule418 = ReplacementRule(pattern418, lambda a, e, b, x, d, p, m, n, c : With418(a, e, b, x, d, p, m, n, c))
    rubi.add(rule418)

    pattern419 = Pattern(Integral((a_ + (WC('e', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**WC('p', S(1))*csc(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: IntegerQ(m/S(2))), )
    def With419(a, e, b, x, d, p, m, n, c):
        f = FreeFactors(cot(c + d*x), x)
        return -f*Subst(Int((a + b*(e*f*x)**n)**p*(f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)), x), x, cot(c + d*x)/f)/d
    rule419 = ReplacementRule(pattern419, lambda a, e, b, x, d, p, m, n, c : With419(a, e, b, x, d, p, m, n, c))
    rubi.add(rule419)

    pattern420 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*sec(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)), CustomConstraint(lambda n: IntegerQ(n/S(2))), CustomConstraint(lambda p: IntegerQ(p)), )
    def With420(a, b, x, d, p, m, n, c):
        f = FreeFactors(sin(c + d*x), x)
        return f*Subst(Int((-f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1)/2)*ExpandToSum(a*(-f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*(f*x)**n, x)**p, x), x, sin(c + d*x)/f)/d
    rule420 = ReplacementRule(pattern420, lambda a, b, x, d, p, m, n, c : With420(a, b, x, d, p, m, n, c))
    rubi.add(rule420)

    pattern421 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*csc(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)), CustomConstraint(lambda n: IntegerQ(n/S(2))), CustomConstraint(lambda p: IntegerQ(p)), )
    def With421(a, b, x, d, p, m, n, c):
        f = FreeFactors(cos(c + d*x), x)
        return -f*Subst(Int((-f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1)/2)*ExpandToSum(a*(-f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*(f*x)**n, x)**p, x), x, cos(c + d*x)/f)/d
    rule421 = ReplacementRule(pattern421, lambda a, b, x, d, p, m, n, c : With421(a, b, x, d, p, m, n, c))
    rubi.add(rule421)

    pattern422 = Pattern(Integral((a_ + (WC('e', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**p_*tan(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule422 = ReplacementRule(pattern422, lambda a, e, b, x, d, p, m, n, c : e*Subst(Int((x/e)**m*(a + b*x**n)**p/(e**S(2) + x**S(2)), x), x, e*tan(c + d*x))/d)
    rubi.add(rule422)

    pattern423 = Pattern(Integral((a_ + (WC('e', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**p_*cot(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule423 = ReplacementRule(pattern423, lambda a, e, b, x, d, p, m, n, c : -e*Subst(Int((x/e)**m*(a + b*x**n)**p/(e**S(2) + x**S(2)), x), x, e*cot(c + d*x))/d)
    rubi.add(rule423)

    pattern424 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule424 = ReplacementRule(pattern424, lambda a, n2, e, b, x, d, p, n, c : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*tan(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule424)

    pattern425 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule425 = ReplacementRule(pattern425, lambda a, n2, e, b, x, d, p, n, c : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*cot(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule425)

    pattern426 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule426 = ReplacementRule(pattern426, lambda a, n2, e, b, x, d, p, n, c : (b + S(2)*c*tan(d + e*x)**n)**(-S(2)*p)*(a + b*tan(d + e*x)**n + c*tan(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*tan(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule426)

    pattern427 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule427 = ReplacementRule(pattern427, lambda a, n2, e, b, x, d, p, n, c : (b + S(2)*c*cot(d + e*x)**n)**(-S(2)*p)*(a + b*cot(d + e*x)**n + c*cot(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*cot(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule427)

    pattern428 = Pattern(Integral(1/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), )
    def With428(a, n2, e, b, x, d, n, c):
        q = Rt(-S(4)*a*c + b**S(2), S(2))
        return S(2)*c*Int(1/(b + S(2)*c*tan(d + e*x)**n - q), x)/q - S(2)*c*Int(1/(b + S(2)*c*tan(d + e*x)**n + q), x)/q
    rule428 = ReplacementRule(pattern428, lambda a, n2, e, b, x, d, n, c : With428(a, n2, e, b, x, d, n, c))
    rubi.add(rule428)

    pattern429 = Pattern(Integral(1/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), )
    def With429(a, n2, e, b, x, d, n, c):
        q = Rt(-S(4)*a*c + b**S(2), S(2))
        return S(2)*c*Int(1/(b + S(2)*c*cot(d + e*x)**n - q), x)/q - S(2)*c*Int(1/(b + S(2)*c*cot(d + e*x)**n + q), x)/q
    rule429 = ReplacementRule(pattern429, lambda a, n2, e, b, x, d, n, c : With429(a, n2, e, b, x, d, n, c))
    rubi.add(rule429)

    pattern430 = Pattern(Integral(((WC('f', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**p_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule430 = ReplacementRule(pattern430, lambda f, a, n2, e, b, x, d, p, m, n, c : f*Subst(Int(x**m*(f**S(2) + x**S(2))**(-m/S(2) + S(-1))*(a + b*x**n + c*x**(S(2)*n))**p, x), x, f*tan(d + e*x))/e)
    rubi.add(rule430)

    pattern431 = Pattern(Integral(((WC('f', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**p_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: IntegerQ(m/S(2))))
    rule431 = ReplacementRule(pattern431, lambda f, a, n2, e, b, x, d, p, m, n, c : -f*Subst(Int(x**m*(f**S(2) + x**S(2))**(-m/S(2) + S(-1))*(a + b*x**n + c*x**(S(2)*n))**p, x), x, f*cot(d + e*x))/e)
    rubi.add(rule431)

    pattern432 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), )
    def With432(a, n2, e, b, x, d, p, m, n, c):
        g = FreeFactors(cos(d + e*x), x)
        return -g*Subst(Int((g*x)**(-S(2)*n*p)*(-g**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*ExpandToSum(a*(g*x)**(S(2)*n) + b*(g*x)**n*(-g**S(2)*x**S(2) + S(1))**(n/S(2)) + c*(-g**S(2)*x**S(2) + S(1))**n, x)**p, x), x, cos(d + e*x)/g)/e
    rule432 = ReplacementRule(pattern432, lambda a, n2, e, b, x, d, p, m, n, c : With432(a, n2, e, b, x, d, p, m, n, c))
    rubi.add(rule432)

    pattern433 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), )
    def With433(a, n2, e, b, x, d, p, m, n, c):
        g = FreeFactors(sin(d + e*x), x)
        return g*Subst(Int((g*x)**(-S(2)*n*p)*(-g**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*ExpandToSum(a*(g*x)**(S(2)*n) + b*(g*x)**n*(-g**S(2)*x**S(2) + S(1))**(n/S(2)) + c*(-g**S(2)*x**S(2) + S(1))**n, x)**p, x), x, sin(d + e*x)/g)/e
    rule433 = ReplacementRule(pattern433, lambda a, n2, e, b, x, d, p, m, n, c : With433(a, n2, e, b, x, d, p, m, n, c))
    rubi.add(rule433)

    pattern434 = Pattern(Integral(((WC('f', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**WC('p', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)))
    rule434 = ReplacementRule(pattern434, lambda f, a, n2, e, b, x, d, p, m, n, c : f**(m + S(1))*Subst(Int((f**S(2) + x**S(2))**(-m/S(2) + S(-1))*(a + b*x**n + c*x**(S(2)*n))**p, x), x, f*tan(d + e*x))/e)
    rubi.add(rule434)

    pattern435 = Pattern(Integral(((WC('f', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**WC('p', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)))
    rule435 = ReplacementRule(pattern435, lambda f, a, n2, e, b, x, d, p, m, n, c : -f**(m + S(1))*Subst(Int((f**S(2) + x**S(2))**(-m/S(2) + S(-1))*(a + b*x**n + c*x**(S(2)*n))**p, x), x, f*cot(d + e*x))/e)
    rubi.add(rule435)

    pattern436 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), )
    def With436(a, n2, e, b, x, d, p, m, n, c):
        g = FreeFactors(sin(d + e*x), x)
        return g*Subst(Int((-g**S(2)*x**S(2) + S(1))**(m/S(2) - n*p + S(-1)/2)*ExpandToSum(a*(-x**S(2) + S(1))**n + b*x**n*(-x**S(2) + S(1))**(n/S(2)) + c*x**(S(2)*n), x)**p, x), x, sin(d + e*x)/g)/e
    rule436 = ReplacementRule(pattern436, lambda a, n2, e, b, x, d, p, m, n, c : With436(a, n2, e, b, x, d, p, m, n, c))
    rubi.add(rule436)

    pattern437 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), )
    def With437(a, n2, e, b, x, d, p, m, n, c):
        g = FreeFactors(cos(d + e*x), x)
        return -g*Subst(Int((-g**S(2)*x**S(2) + S(1))**(m/S(2) - n*p + S(-1)/2)*ExpandToSum(a*(-x**S(2) + S(1))**n + b*x**n*(-x**S(2) + S(1))**(n/S(2)) + c*x**(S(2)*n), x)**p, x), x, cos(d + e*x)/g)/e
    rule437 = ReplacementRule(pattern437, lambda a, n2, e, b, x, d, p, m, n, c : With437(a, n2, e, b, x, d, p, m, n, c))
    rubi.add(rule437)

    pattern438 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule438 = ReplacementRule(pattern438, lambda a, n2, e, b, x, d, p, m, n, c : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*tan(d + e*x)**n)**(S(2)*p)*tan(d + e*x)**m, x))
    rubi.add(rule438)

    pattern439 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule439 = ReplacementRule(pattern439, lambda a, n2, e, b, x, d, p, m, n, c : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*cot(d + e*x)**n)**(S(2)*p)*cot(d + e*x)**m, x))
    rubi.add(rule439)

    pattern440 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule440 = ReplacementRule(pattern440, lambda a, n2, e, b, x, d, p, m, n, c : (b + S(2)*c*tan(d + e*x)**n)**(-S(2)*p)*(a + b*tan(d + e*x)**n + c*tan(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*tan(d + e*x)**n)**(S(2)*p)*tan(d + e*x)**m, x))
    rubi.add(rule440)

    pattern441 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule441 = ReplacementRule(pattern441, lambda a, n2, e, b, x, d, p, m, n, c : (b + S(2)*c*cot(d + e*x)**n)**(-S(2)*p)*(a + b*cot(d + e*x)**n + c*cot(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*cot(d + e*x)**n)**(S(2)*p)*cot(d + e*x)**m, x))
    rubi.add(rule441)

    pattern442 = Pattern(Integral(((WC('f', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**p_*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule442 = ReplacementRule(pattern442, lambda f, a, n2, e, b, x, d, p, m, n, c : f*Subst(Int((x/f)**m*(a + b*x**n + c*x**(S(2)*n))**p/(f**S(2) + x**S(2)), x), x, f*tan(d + e*x))/e)
    rubi.add(rule442)

    pattern443 = Pattern(Integral(((WC('f', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**p_*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule443 = ReplacementRule(pattern443, lambda f, a, n2, e, b, x, d, p, m, n, c : -f*Subst(Int((x/f)**m*(a + b*x**n + c*x**(S(2)*n))**p/(f**S(2) + x**S(2)), x), x, f*cot(d + e*x))/e)
    rubi.add(rule443)

    pattern444 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule444 = ReplacementRule(pattern444, lambda a, n2, e, b, x, d, p, m, n, c : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*tan(d + e*x)**n)**(S(2)*p)*cot(d + e*x)**m, x))
    rubi.add(rule444)

    pattern445 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule445 = ReplacementRule(pattern445, lambda a, n2, e, b, x, d, p, m, n, c : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*cot(d + e*x)**n)**(S(2)*p)*tan(d + e*x)**m, x))
    rubi.add(rule445)

    pattern446 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule446 = ReplacementRule(pattern446, lambda a, n2, e, b, x, d, p, m, n, c : (b + S(2)*c*tan(d + e*x)**n)**(-S(2)*p)*(a + b*tan(d + e*x)**n + c*tan(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*tan(d + e*x)**n)**(S(2)*p)*cot(d + e*x)**m, x))
    rubi.add(rule446)

    pattern447 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: Not(IntegerQ(p))))
    rule447 = ReplacementRule(pattern447, lambda a, n2, e, b, x, d, p, m, n, c : (b + S(2)*c*cot(d + e*x)**n)**(-S(2)*p)*(a + b*cot(d + e*x)**n + c*cot(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*cot(d + e*x)**n)**(S(2)*p)*tan(d + e*x)**m, x))
    rubi.add(rule447)

    pattern448 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), )
    def With448(a, n2, e, b, x, d, p, m, n, c):
        g = FreeFactors(cot(d + e*x), x)
        return g*Subst(Int((g*x)**(m - S(2)*n*p)*(a*(g*x)**(S(2)*n) + b*(g*x)**n + c)**p/(g**S(2)*x**S(2) + S(1)), x), x, cot(d + e*x)/g)/e
    rule448 = ReplacementRule(pattern448, lambda a, n2, e, b, x, d, p, m, n, c : With448(a, n2, e, b, x, d, p, m, n, c))
    rubi.add(rule448)

    pattern449 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n2, n: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), )
    def With449(a, n2, e, b, x, d, p, m, n, c):
        g = FreeFactors(tan(d + e*x), x)
        return -g*Subst(Int((g*x)**(m - S(2)*n*p)*(a*(g*x)**(S(2)*n) + b*(g*x)**n + c)**p/(g**S(2)*x**S(2) + S(1)), x), x, tan(d + e*x)/g)/e
    rule449 = ReplacementRule(pattern449, lambda a, n2, e, b, x, d, p, m, n, c : With449(a, n2, e, b, x, d, p, m, n, c))
    rubi.add(rule449)

    pattern450 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule450 = ReplacementRule(pattern450, lambda a, A, e, b, x, d, B, n, c : S(4)**(-n)*c**(-n)*Int((A + B*tan(d + e*x))*(b + S(2)*c*tan(d + e*x))**(S(2)*n), x))
    rubi.add(rule450)

    pattern451 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule451 = ReplacementRule(pattern451, lambda a, A, e, b, x, d, B, n, c : S(4)**(-n)*c**(-n)*Int((A + B*cot(d + e*x))*(b + S(2)*c*cot(d + e*x))**(S(2)*n), x))
    rubi.add(rule451)

    pattern452 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule452 = ReplacementRule(pattern452, lambda a, A, e, b, x, d, B, n, c : (b + S(2)*c*tan(d + e*x))**(-S(2)*n)*(a + b*tan(d + e*x) + c*tan(d + e*x)**S(2))**n*Int((A + B*tan(d + e*x))*(b + S(2)*c*tan(d + e*x))**(S(2)*n), x))
    rubi.add(rule452)

    pattern453 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: Not(IntegerQ(n))))
    rule453 = ReplacementRule(pattern453, lambda a, A, e, b, x, d, B, n, c : (b + S(2)*c*cot(d + e*x))**(-S(2)*n)*(a + b*cot(d + e*x) + c*cot(d + e*x)**S(2))**n*Int((A + B*cot(d + e*x))*(b + S(2)*c*cot(d + e*x))**(S(2)*n), x))
    rubi.add(rule453)

    pattern454 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), )
    def With454(a, A, e, b, x, d, B, c):
        q = Rt(-S(4)*a*c + b**S(2), S(2))
        return (B - (-S(2)*A*c + B*b)/q)*Int(1/Simp(b + S(2)*c*tan(d + e*x) - q, x), x) + (B + (-S(2)*A*c + B*b)/q)*Int(1/Simp(b + S(2)*c*tan(d + e*x) + q, x), x)
    rule454 = ReplacementRule(pattern454, lambda a, A, e, b, x, d, B, c : With454(a, A, e, b, x, d, B, c))
    rubi.add(rule454)

    pattern455 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), )
    def With455(a, A, e, b, x, d, B, c):
        q = Rt(-S(4)*a*c + b**S(2), S(2))
        return (B - (-S(2)*A*c + B*b)/q)*Int(1/Simp(b + S(2)*c*cot(d + e*x) - q, x), x) + (B + (-S(2)*A*c + B*b)/q)*Int(1/Simp(b + S(2)*c*cot(d + e*x) + q, x), x)
    rule455 = ReplacementRule(pattern455, lambda a, A, e, b, x, d, B, c : With455(a, A, e, b, x, d, B, c))
    rubi.add(rule455)

    pattern456 = Pattern(Integral((A_ + WC('B', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule456 = ReplacementRule(pattern456, lambda a, A, e, b, x, d, B, n, c : Int(ExpandTrig((A + B*tan(d + e*x))*(a + b*tan(d + e*x) + c*tan(d + e*x)**S(2))**n, x), x))
    rubi.add(rule456)

    pattern457 = Pattern(Integral((A_ + WC('B', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, c, b: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule457 = ReplacementRule(pattern457, lambda a, A, e, b, x, d, B, n, c : Int(ExpandTrig((A + B*cot(d + e*x))*(a + b*cot(d + e*x) + c*cot(d + e*x)**S(2))**n, x), x))
    rubi.add(rule457)

    pattern458 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule458 = ReplacementRule(pattern458, lambda f, e, x, d, m, c : -S(2)*ImaginaryI*Int((c + d*x)**m*exp(S(2)*ImaginaryI*(e + f*x))/(exp(S(2)*ImaginaryI*(e + f*x)) + S(1)), x) + ImaginaryI*(c + d*x)**(m + S(1))/(d*(m + S(1))))
    rubi.add(rule458)

    pattern459 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule459 = ReplacementRule(pattern459, lambda f, e, x, d, m, c : -S(2)*ImaginaryI*Int((c + d*x)**m*exp(S(2)*ImaginaryI*(e + f*x))/(-exp(S(2)*ImaginaryI*(e + f*x)) + S(1)), x) - ImaginaryI*(c + d*x)**(m + S(1))/(d*(m + S(1))))
    rubi.add(rule459)

    pattern460 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Greater(m, S(0))))
    rule460 = ReplacementRule(pattern460, lambda f, e, b, x, d, m, n, c : -b**S(2)*Int((b*tan(e + f*x))**(n + S(-2))*(c + d*x)**m, x) - b*d*m*Int((b*tan(e + f*x))**(n + S(-1))*(c + d*x)**(m + S(-1)), x)/(f*(n + S(-1))) + b*(b*tan(e + f*x))**(n + S(-1))*(c + d*x)**m/(f*(n + S(-1))))
    rubi.add(rule460)

    pattern461 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Greater(m, S(0))))
    rule461 = ReplacementRule(pattern461, lambda f, e, b, x, d, m, n, c : -b**S(2)*Int((b*cot(e + f*x))**(n + S(-2))*(c + d*x)**m, x) + b*d*m*Int((b*cot(e + f*x))**(n + S(-1))*(c + d*x)**(m + S(-1)), x)/(f*(n + S(-1))) - b*(b*cot(e + f*x))**(n + S(-1))*(c + d*x)**m/(f*(n + S(-1))))
    rubi.add(rule461)

    pattern462 = Pattern(Integral((WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: Greater(m, S(0))))
    rule462 = ReplacementRule(pattern462, lambda f, e, b, x, d, m, n, c : -d*m*Int((b*tan(e + f*x))**(n + S(1))*(c + d*x)**(m + S(-1)), x)/(b*f*(n + S(1))) + (b*tan(e + f*x))**(n + S(1))*(c + d*x)**m/(b*f*(n + S(1))) - Int((b*tan(e + f*x))**(n + S(2))*(c + d*x)**m, x)/b**S(2))
    rubi.add(rule462)

    pattern463 = Pattern(Integral((WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: Greater(m, S(0))))
    rule463 = ReplacementRule(pattern463, lambda f, e, b, x, d, m, n, c : d*m*Int((b*cot(e + f*x))**(n + S(1))*(c + d*x)**(m + S(-1)), x)/(b*f*(n + S(1))) - (b*cot(e + f*x))**(n + S(1))*(c + d*x)**m/(b*f*(n + S(1))) - Int((b*cot(e + f*x))**(n + S(2))*(c + d*x)**m, x)/b**S(2))
    rubi.add(rule463)

    pattern464 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m, n: PositiveIntegerQ(m, n)))
    rule464 = ReplacementRule(pattern464, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (a + b*tan(e + f*x))**n, x), x))
    rubi.add(rule464)

    pattern465 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m, n: PositiveIntegerQ(m, n)))
    rule465 = ReplacementRule(pattern465, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (a + b*cot(e + f*x))**n, x), x))
    rubi.add(rule465)

    pattern466 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule466 = ReplacementRule(pattern466, lambda f, a, e, b, x, d, m, c : a*d*m*Int((c + d*x)**(m + S(-1))/(a + b*tan(e + f*x)), x)/(S(2)*b*f) - a*(c + d*x)**m/(S(2)*b*f*(a + b*tan(e + f*x))) + (c + d*x)**(m + S(1))/(S(2)*a*d*(m + S(1))))
    rubi.add(rule466)

    pattern467 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule467 = ReplacementRule(pattern467, lambda f, a, e, b, x, d, m, c : -a*d*m*Int((c + d*x)**(m + S(-1))/(a + b*cot(e + f*x)), x)/(S(2)*b*f) + a*(c + d*x)**m/(S(2)*b*f*(a + b*cot(e + f*x))) + (c + d*x)**(m + S(1))/(S(2)*a*d*(m + S(1))))
    rubi.add(rule467)

    pattern468 = Pattern(Integral(S(1)/((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(x_*WC('d', S(1)) + WC('c', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule468 = ReplacementRule(pattern468, lambda f, a, e, b, x, d, c : -S(1)/(d*(a + b*tan(e + f*x))*(c + d*x)) + f*Int(cos(S(2)*e + S(2)*f*x)/(c + d*x), x)/(b*d) - f*Int(sin(S(2)*e + S(2)*f*x)/(c + d*x), x)/(a*d))
    rubi.add(rule468)

    pattern469 = Pattern(Integral(S(1)/((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(x_*WC('d', S(1)) + WC('c', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule469 = ReplacementRule(pattern469, lambda f, a, e, b, x, d, c : -S(1)/(d*(a + b*cot(e + f*x))*(c + d*x)) + f*Int(cos(S(2)*e + S(2)*f*x)/(c + d*x), x)/(b*d) + f*Int(sin(S(2)*e + S(2)*f*x)/(c + d*x), x)/(a*d))
    rubi.add(rule469)

    pattern470 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: Unequal(m, S(-2))))
    rule470 = ReplacementRule(pattern470, lambda f, a, e, b, x, d, m, c : (c + d*x)**(m + S(1))/(d*(a + b*tan(e + f*x))*(m + S(1))) + f*(c + d*x)**(m + S(2))/(b*d**S(2)*(m + S(1))*(m + S(2))) + S(2)*b*f*Int((c + d*x)**(m + S(1))/(a + b*tan(e + f*x)), x)/(a*d*(m + S(1))))
    rubi.add(rule470)

    pattern471 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: Unequal(m, S(-2))))
    rule471 = ReplacementRule(pattern471, lambda f, a, e, b, x, d, m, c : (c + d*x)**(m + S(1))/(d*(a + b*cot(e + f*x))*(m + S(1))) - f*(c + d*x)**(m + S(2))/(b*d**S(2)*(m + S(1))*(m + S(2))) - S(2)*b*f*Int((c + d*x)**(m + S(1))/(a + b*cot(e + f*x)), x)/(a*d*(m + S(1))))
    rubi.add(rule471)

    pattern472 = Pattern(Integral(S(1)/((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule472 = ReplacementRule(pattern472, lambda f, a, e, b, x, d, c : Int(sin(S(2)*e + S(2)*f*x)/(c + d*x), x)/(S(2)*b) + Int(cos(S(2)*e + S(2)*f*x)/(c + d*x), x)/(S(2)*a) + log(c + d*x)/(S(2)*a*d))
    rubi.add(rule472)

    pattern473 = Pattern(Integral(S(1)/((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))))
    rule473 = ReplacementRule(pattern473, lambda f, a, e, b, x, d, c : Int(sin(S(2)*e + S(2)*f*x)/(c + d*x), x)/(S(2)*b) - Int(cos(S(2)*e + S(2)*f*x)/(c + d*x), x)/(S(2)*a) + log(c + d*x)/(S(2)*a*d))
    rubi.add(rule473)

    pattern474 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule474 = ReplacementRule(pattern474, lambda f, a, e, b, x, d, m, c : Int((c + d*x)**m*exp(S(2)*a*(e + f*x)/b), x)/(S(2)*a) + (c + d*x)**(m + S(1))/(S(2)*a*d*(m + S(1))))
    rubi.add(rule474)

    pattern475 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: Not(IntegerQ(m))))
    rule475 = ReplacementRule(pattern475, lambda f, a, e, b, x, d, m, c : -Int((c + d*x)**m*exp(-S(2)*a*(e + f*x)/b), x)/(S(2)*a) + (c + d*x)**(m + S(1))/(S(2)*a*d*(m + S(1))))
    rubi.add(rule475)

    pattern476 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(m, n)))
    rule476 = ReplacementRule(pattern476, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (sin(S(2)*e + S(2)*f*x)/(S(2)*b) + cos(S(2)*e + S(2)*f*x)/(S(2)*a) + S(1)/(S(2)*a))**(-n), x), x))
    rubi.add(rule476)

    pattern477 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(m, n)))
    rule477 = ReplacementRule(pattern477, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (sin(S(2)*e + S(2)*f*x)/(S(2)*b) - cos(S(2)*e + S(2)*f*x)/(S(2)*a) + S(1)/(S(2)*a))**(-n), x), x))
    rubi.add(rule477)

    pattern478 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule478 = ReplacementRule(pattern478, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (exp(S(2)*a*(e + f*x)/b)/(S(2)*a) + S(1)/(S(2)*a))**(-n), x), x))
    rubi.add(rule478)

    pattern479 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule479 = ReplacementRule(pattern479, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (S(1)/(S(2)*a) - exp(-S(2)*a*(e + f*x)/b)/(S(2)*a))**(-n), x), x))
    rubi.add(rule479)

    pattern480 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n + S(1))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), )
    def With480(f, a, e, b, x, d, m, n, c):
        u = IntHide((a + b*tan(e + f*x))**n, x)
        return -d*m*Int(Dist((c + d*x)**(m + S(-1)), u, x), x) + Dist((c + d*x)**m, u, x)
    rule480 = ReplacementRule(pattern480, lambda f, a, e, b, x, d, m, n, c : With480(f, a, e, b, x, d, m, n, c))
    rubi.add(rule480)

    pattern481 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n + S(1))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), )
    def With481(f, a, e, b, x, d, m, n, c):
        u = IntHide((a + b*cot(e + f*x))**n, x)
        return -d*m*Int(Dist((c + d*x)**(m + S(-1)), u, x), x) + Dist((c + d*x)**m, u, x)
    rule481 = ReplacementRule(pattern481, lambda f, a, e, b, x, d, m, n, c : With481(f, a, e, b, x, d, m, n, c))
    rubi.add(rule481)

    pattern482 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule482 = ReplacementRule(pattern482, lambda f, a, e, b, x, d, m, c : -S(2)*ImaginaryI*b*Int((c + d*x)**m/(a**S(2) + b**S(2) + (-ImaginaryI*b + a)**S(2)*exp(S(2)*ImaginaryI*(e + f*x))), x) + (c + d*x)**(m + S(1))/(d*(m + S(1))*(-ImaginaryI*b + a)))
    rubi.add(rule482)

    pattern483 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule483 = ReplacementRule(pattern483, lambda f, a, e, b, x, d, m, c : S(2)*ImaginaryI*b*Int((c + d*x)**m/(a**S(2) + b**S(2) - (ImaginaryI*b + a)**S(2)*exp(S(2)*ImaginaryI*(e + f*x))), x) + (c + d*x)**(m + S(1))/(d*(m + S(1))*(ImaginaryI*b + a)))
    rubi.add(rule483)

    pattern484 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))/(a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule484 = ReplacementRule(pattern484, lambda f, a, e, b, x, d, c : -b*(c + d*x)/(f*(a + b*tan(e + f*x))*(a**S(2) + b**S(2))) + Int((S(2)*a*c*f + S(2)*a*d*f*x + b*d)/(a + b*tan(e + f*x)), x)/(f*(a**S(2) + b**S(2))) - (c + d*x)**S(2)/(S(2)*d*(a**S(2) + b**S(2))))
    rubi.add(rule484)

    pattern485 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))/(a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))))
    rule485 = ReplacementRule(pattern485, lambda f, a, e, b, x, d, c : b*(c + d*x)/(f*(a + b*cot(e + f*x))*(a**S(2) + b**S(2))) - Int((-S(2)*a*c*f - S(2)*a*d*f*x + b*d)/(a + b*cot(e + f*x)), x)/(f*(a**S(2) + b**S(2))) - (c + d*x)**S(2)/(S(2)*d*(a**S(2) + b**S(2))))
    rubi.add(rule485)

    pattern486 = Pattern(Integral((a_ + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule486 = ReplacementRule(pattern486, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (-S(2)*ImaginaryI*b/(a**S(2) + b**S(2) + (-ImaginaryI*b + a)**S(2)*exp(S(2)*ImaginaryI*(e + f*x))) + 1/(-ImaginaryI*b + a))**(-n), x), x))
    rubi.add(rule486)

    pattern487 = Pattern(Integral((a_ + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda b, a: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule487 = ReplacementRule(pattern487, lambda f, a, e, b, x, d, m, n, c : Int(ExpandIntegrand((c + d*x)**m, (S(2)*ImaginaryI*b/(a**S(2) + b**S(2) - (ImaginaryI*b + a)**S(2)*exp(S(2)*ImaginaryI*(e + f*x))) + 1/(ImaginaryI*b + a))**(-n), x), x))
    rubi.add(rule487)

    pattern488 = Pattern(Integral(u_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(v_))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda u, v, x: LinearQ(List(u, v), x)), CustomConstraint(lambda u, v, x: Not(LinearMatchQ(List(u, v), x))))
    rule488 = ReplacementRule(pattern488, lambda v, a, b, x, u, m, n : Int((a + b*tan(ExpandToSum(v, x)))**n*ExpandToSum(u, x)**m, x))
    rubi.add(rule488)

    pattern489 = Pattern(Integral(u_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(v_))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda u, v, x: LinearQ(List(u, v), x)), CustomConstraint(lambda u, v, x: Not(LinearMatchQ(List(u, v), x))))
    rule489 = ReplacementRule(pattern489, lambda v, a, b, x, u, m, n : Int((a + b*cot(ExpandToSum(v, x)))**n*ExpandToSum(u, x)**m, x))
    rubi.add(rule489)

    pattern490 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule490 = ReplacementRule(pattern490, lambda f, a, e, b, x, d, m, n, c : Int((a + b*tan(e + f*x))**n*(c + d*x)**m, x))
    rubi.add(rule490)

    pattern491 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule491 = ReplacementRule(pattern491, lambda f, a, e, b, x, d, m, n, c : Int((a + b*cot(e + f*x))**n*(c + d*x)**m, x))
    rubi.add(rule491)

    pattern492 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: PositiveIntegerQ(1/n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule492 = ReplacementRule(pattern492, lambda a, b, x, d, p, n, c : Subst(Int(x**(S(-1) + 1/n)*(a + b*tan(c + d*x))**p, x), x, x**n)/n)
    rubi.add(rule492)

    pattern493 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: PositiveIntegerQ(1/n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule493 = ReplacementRule(pattern493, lambda a, b, x, d, p, n, c : Subst(Int(x**(S(-1) + 1/n)*(a + b*cot(c + d*x))**p, x), x, x**n)/n)
    rubi.add(rule493)

    pattern494 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule494 = ReplacementRule(pattern494, lambda a, b, x, d, p, n, c : Int((a + b*tan(c + d*x**n))**p, x))
    rubi.add(rule494)

    pattern495 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule495 = ReplacementRule(pattern495, lambda a, b, x, d, p, n, c : Int((a + b*cot(c + d*x**n))**p, x))
    rubi.add(rule495)

    pattern496 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(u_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda u, x: NonzeroQ(u - x)))
    rule496 = ReplacementRule(pattern496, lambda a, b, x, u, d, p, n, c : Subst(Int((a + b*tan(c + d*x**n))**p, x), x, u)/Coefficient(u, x, S(1)))
    rubi.add(rule496)

    pattern497 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(u_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda u, x: NonzeroQ(u - x)))
    rule497 = ReplacementRule(pattern497, lambda a, b, x, u, d, p, n, c : Subst(Int((a + b*cot(c + d*x**n))**p, x), x, u)/Coefficient(u, x, S(1)))
    rubi.add(rule497)

    pattern498 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*tan(u_))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: Not(BinomialMatchQ(u, x))))
    rule498 = ReplacementRule(pattern498, lambda a, x, b, u, p : Int((a + b*tan(ExpandToSum(u, x)))**p, x))
    rubi.add(rule498)

    pattern499 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cot(u_))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: Not(BinomialMatchQ(u, x))))
    rule499 = ReplacementRule(pattern499, lambda a, x, b, u, p : Int((a + b*cot(ExpandToSum(u, x)))**p, x))
    rubi.add(rule499)

    pattern500 = Pattern(Integral(x_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, n: PositiveIntegerQ((m + S(1))/n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule500 = ReplacementRule(pattern500, lambda a, b, x, d, p, m, n, c : Subst(Int(x**(S(-1) + (m + S(1))/n)*(a + b*tan(c + d*x))**p, x), x, x**n)/n)
    rubi.add(rule500)

    pattern501 = Pattern(Integral(x_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, n: PositiveIntegerQ((m + S(1))/n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule501 = ReplacementRule(pattern501, lambda a, b, x, d, p, m, n, c : Subst(Int(x**(S(-1) + (m + S(1))/n)*(a + b*cot(c + d*x))**p, x), x, x**n)/n)
    rubi.add(rule501)

    pattern502 = Pattern(Integral(x_**WC('m', S(1))*tan(x_**n_*WC('d', S(1)) + WC('c', S(0)))**S(2), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule502 = ReplacementRule(pattern502, lambda x, d, m, n, c : -Int(x**m, x) + x**(m - n + S(1))*tan(c + d*x**n)/(d*n) - (m - n + S(1))*Int(x**(m - n)*tan(c + d*x**n), x)/(d*n))
    rubi.add(rule502)

    pattern503 = Pattern(Integral(x_**WC('m', S(1))*cot(x_**n_*WC('d', S(1)) + WC('c', S(0)))**S(2), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule503 = ReplacementRule(pattern503, lambda x, d, m, n, c : -Int(x**m, x) - x**(m - n + S(1))*cot(c + d*x**n)/(d*n) + (m - n + S(1))*Int(x**(m - n)*cot(c + d*x**n), x)/(d*n))
    rubi.add(rule503)

    pattern504 = Pattern(Integral(x_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule504 = ReplacementRule(pattern504, lambda a, b, x, d, p, m, n, c : Int(x**m*(a + b*tan(c + d*x**n))**p, x))
    rubi.add(rule504)

    pattern505 = Pattern(Integral(x_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule505 = ReplacementRule(pattern505, lambda a, b, x, d, p, m, n, c : Int(x**m*(a + b*cot(c + d*x**n))**p, x))
    rubi.add(rule505)

    pattern506 = Pattern(Integral((e_*x_)**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule506 = ReplacementRule(pattern506, lambda a, e, b, x, d, p, m, n, c : e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*tan(c + d*x**n))**p, x))
    rubi.add(rule506)

    pattern507 = Pattern(Integral((e_*x_)**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(x_**n_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule507 = ReplacementRule(pattern507, lambda a, e, b, x, d, p, m, n, c : e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*cot(c + d*x**n))**p, x))
    rubi.add(rule507)

    pattern508 = Pattern(Integral((e_*x_)**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*tan(u_))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: Not(BinomialMatchQ(u, x))))
    rule508 = ReplacementRule(pattern508, lambda a, e, b, x, u, p, m : Int((e*x)**m*(a + b*tan(ExpandToSum(u, x)))**p, x))
    rubi.add(rule508)

    pattern509 = Pattern(Integral((e_*x_)**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*cot(u_))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: Not(BinomialMatchQ(u, x))))
    rule509 = ReplacementRule(pattern509, lambda a, e, b, x, u, p, m : Int((e*x)**m*(a + b*cot(ExpandToSum(u, x)))**p, x))
    rubi.add(rule509)

    pattern510 = Pattern(Integral(x_**WC('m', S(1))*tan(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('q', S(1))*sec(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda m, n: GreaterEqual(m - n, S(0))), CustomConstraint(lambda q: SameQ(q, S(1))))
    rule510 = ReplacementRule(pattern510, lambda a, q, b, x, p, m, n : x**(m - n + S(1))*sec(a + b*x**n)**p/(b*n*p) - (m - n + S(1))*Int(x**(m - n)*sec(a + b*x**n)**p, x)/(b*n*p))
    rubi.add(rule510)

    pattern511 = Pattern(Integral(x_**WC('m', S(1))*cot(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('q', S(1))*csc(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda m, n: GreaterEqual(m - n, S(0))), CustomConstraint(lambda q: SameQ(q, S(1))))
    rule511 = ReplacementRule(pattern511, lambda a, q, b, x, p, m, n : -x**(m - n + S(1))*csc(a + b*x**n)**p/(b*n*p) + (m - n + S(1))*Int(x**(m - n)*csc(a + b*x**n)**p, x)/(b*n*p))
    rubi.add(rule511)

    pattern512 = Pattern(Integral(tan(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule512 = ReplacementRule(pattern512, lambda a, x, b, n, c : Int(tan(a + b*x + c*x**S(2))**n, x))
    rubi.add(rule512)

    pattern513 = Pattern(Integral(cot(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule513 = ReplacementRule(pattern513, lambda a, x, b, n, c : Int(cot(a + b*x + c*x**S(2))**n, x))
    rubi.add(rule513)

    pattern514 = Pattern(Integral((d_ + x_*WC('e', S(1)))*tan(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda d, c, e, b: ZeroQ(-b*e + S(2)*c*d)))
    rule514 = ReplacementRule(pattern514, lambda a, e, b, x, d, c : -e*log(cos(a + b*x + c*x**S(2)))/(S(2)*c))
    rubi.add(rule514)

    pattern515 = Pattern(Integral((d_ + x_*WC('e', S(1)))*cot(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda d, c, e, b: ZeroQ(-b*e + S(2)*c*d)))
    rule515 = ReplacementRule(pattern515, lambda a, e, x, b, d, c : e*log(sin(a + b*x + c*x**S(2)))/(S(2)*c))
    rubi.add(rule515)

    pattern516 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))*tan(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda d, c, e, b: NonzeroQ(-b*e + S(2)*c*d)))
    rule516 = ReplacementRule(pattern516, lambda a, e, b, x, d, c : -e*log(cos(a + b*x + c*x**S(2)))/(S(2)*c) + (-b*e + S(2)*c*d)*Int(tan(a + b*x + c*x**S(2)), x)/(S(2)*c))
    rubi.add(rule516)

    pattern517 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))*cot(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda d, c, e, b: NonzeroQ(-b*e + S(2)*c*d)))
    rule517 = ReplacementRule(pattern517, lambda a, e, b, x, d, c : e*log(sin(a + b*x + c*x**S(2)))/(S(2)*c) + (-b*e + S(2)*c*d)*Int(cot(a + b*x + c*x**S(2)), x)/(S(2)*c))
    rubi.add(rule517)

    pattern518 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1))*tan(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule518 = ReplacementRule(pattern518, lambda a, e, b, x, d, m, n, c : Int((d + e*x)**m*tan(a + b*x + c*x**S(2))**n, x))
    rubi.add(rule518)

    pattern519 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1))*cot(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule519 = ReplacementRule(pattern519, lambda a, e, b, x, d, m, n, c : Int((d + e*x)**m*cot(a + b*x + c*x**S(2))**n, x))
    rubi.add(rule519)

    return rubi
