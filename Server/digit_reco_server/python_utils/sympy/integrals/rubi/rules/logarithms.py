from sympy.external import import_module
matchpy = import_module("matchpy")
from sympy.utilities.decorator import doctest_depends_on

if matchpy:
    from matchpy import Pattern, ReplacementRule, CustomConstraint
    from sympy.integrals.rubi.utility_function import (Int, LogIntegral, DerivativeDivides, Set, With, Module, Scan, MapAnd, FalseQ, ZeroQ, NegativeQ, NonzeroQ, FreeQ, NFreeQ, List, Log, PositiveQ, PositiveIntegerQ, NegativeIntegerQ, IntegerQ, IntegersQ, ComplexNumberQ, PureComplexNumberQ, RealNumericQ, PositiveOrZeroQ, NegativeOrZeroQ, FractionOrNegativeQ, NegQ, Equal, Unequal, IntPart, FracPart, RationalQ, ProductQ, SumQ, NonsumQ, Subst, First, Rest, SqrtNumberQ, SqrtNumberSumQ, LinearQ, Sqrt, ArcCosh, Coefficient, Denominator, Hypergeometric2F1, Not, Simplify, FractionalPart, IntegerPart, AppellF1, EllipticPi, EllipticE, EllipticF, ArcTan, ArcCot, ArcCoth, ArcTanh, ArcSin, ArcSinh, ArcCos, ArcCsc, ArcSec, ArcCsch, ArcSech, Sinh, Tanh, Cosh, Sech, Csch, Coth, LessEqual, Less, Greater, GreaterEqual, FractionQ, IntLinearcQ, Expand, IndependentQ, PowerQ, IntegerPowerQ, PositiveIntegerPowerQ, FractionalPowerQ, AtomQ, ExpQ, LogQ, Head, MemberQ, TrigQ, SinQ, CosQ, TanQ, CotQ, SecQ, CscQ, Sin, Cos, Tan, Cot, Sec, Csc, HyperbolicQ, SinhQ, CoshQ, TanhQ, CothQ, SechQ, CschQ, InverseTrigQ, SinCosQ, SinhCoshQ, LeafCount, Numerator, NumberQ, NumericQ, Length, ListQ, Im, Re, InverseHyperbolicQ, InverseFunctionQ, TrigHyperbolicFreeQ, InverseFunctionFreeQ, RealQ, EqQ, FractionalPowerFreeQ, ComplexFreeQ, PolynomialQ, FactorSquareFree, PowerOfLinearQ, Exponent, QuadraticQ, LinearPairQ, BinomialParts, TrinomialParts, PolyQ, EvenQ, OddQ, PerfectSquareQ, NiceSqrtAuxQ, NiceSqrtQ, Together, PosAux, PosQ, CoefficientList, ReplaceAll, ExpandLinearProduct, GCD, ContentFactor, NumericFactor, NonnumericFactors, MakeAssocList, GensymSubst, KernelSubst, ExpandExpression, Apart, SmartApart, MatchQ, PolynomialQuotientRemainder, FreeFactors, NonfreeFactors, RemoveContentAux, RemoveContent, FreeTerms, NonfreeTerms, ExpandAlgebraicFunction, CollectReciprocals, ExpandCleanup, AlgebraicFunctionQ, Coeff, LeadTerm, RemainingTerms, LeadFactor, RemainingFactors, LeadBase, LeadDegree, Numer, Denom, hypergeom, Expon, MergeMonomials, PolynomialDivide, BinomialQ, TrinomialQ, GeneralizedBinomialQ, GeneralizedTrinomialQ, FactorSquareFreeList, PerfectPowerTest, SquareFreeFactorTest, RationalFunctionQ, RationalFunctionFactors, NonrationalFunctionFactors, Reverse, RationalFunctionExponents, RationalFunctionExpand, ExpandIntegrand, SimplerQ, SimplerSqrtQ, SumSimplerQ, BinomialDegree, TrinomialDegree, CancelCommonFactors, SimplerIntegrandQ, GeneralizedBinomialDegree, GeneralizedBinomialParts, GeneralizedTrinomialDegree, GeneralizedTrinomialParts, MonomialQ, MonomialSumQ, MinimumMonomialExponent, MonomialExponent, LinearMatchQ, PowerOfLinearMatchQ, QuadraticMatchQ, CubicMatchQ, BinomialMatchQ, TrinomialMatchQ, GeneralizedBinomialMatchQ, GeneralizedTrinomialMatchQ, QuotientOfLinearsMatchQ, PolynomialTermQ, PolynomialTerms, NonpolynomialTerms, PseudoBinomialParts, NormalizePseudoBinomial, PseudoBinomialPairQ, PseudoBinomialQ, PolynomialGCD, PolyGCD, AlgebraicFunctionFactors, NonalgebraicFunctionFactors, QuotientOfLinearsP, QuotientOfLinearsParts, QuotientOfLinearsQ, Flatten, Sort, AbsurdNumberQ, AbsurdNumberFactors, NonabsurdNumberFactors, SumSimplerAuxQ, Prepend, Drop, CombineExponents, FactorInteger, FactorAbsurdNumber, SubstForInverseFunction, SubstForFractionalPower, SubstForFractionalPowerOfQuotientOfLinears, FractionalPowerOfQuotientOfLinears, SubstForFractionalPowerQ, SubstForFractionalPowerAuxQ, FractionalPowerOfSquareQ, FractionalPowerSubexpressionQ, Apply, FactorNumericGcd, MergeableFactorQ, MergeFactor, MergeFactors, TrigSimplifyQ, TrigSimplify, TrigSimplifyRecur, Order, FactorOrder, Smallest, OrderedQ, MinimumDegree, PositiveFactors, Sign, NonpositiveFactors, PolynomialInAuxQ, PolynomialInQ, ExponentInAux, ExponentIn, PolynomialInSubstAux, PolynomialInSubst, Distrib, DistributeDegree, FunctionOfPower, DivideDegreesOfFactors, MonomialFactor, FullSimplify, FunctionOfLinearSubst, FunctionOfLinear, NormalizeIntegrand, NormalizeIntegrandAux, NormalizeIntegrandFactor, NormalizeIntegrandFactorBase, NormalizeTogether, NormalizeLeadTermSigns, AbsorbMinusSign, NormalizeSumFactors, SignOfFactor, NormalizePowerOfLinear, SimplifyIntegrand, SimplifyTerm, TogetherSimplify, SmartSimplify, SubstForExpn, ExpandToSum, UnifySum, UnifyTerms, UnifyTerm, CalculusQ, FunctionOfInverseLinear, PureFunctionOfSinhQ, PureFunctionOfTanhQ, PureFunctionOfCoshQ, IntegerQuotientQ, OddQuotientQ, EvenQuotientQ, FindTrigFactor, FunctionOfSinhQ, FunctionOfCoshQ, OddHyperbolicPowerQ, FunctionOfTanhQ, FunctionOfTanhWeight, FunctionOfHyperbolicQ, SmartNumerator, SmartDenominator, SubstForAux, ActivateTrig, ExpandTrig, TrigExpand, SubstForTrig, SubstForHyperbolic, InertTrigFreeQ, LCM, SubstForFractionalPowerOfLinear, FractionalPowerOfLinear, InverseFunctionOfLinear, InertTrigQ, InertReciprocalQ, DeactivateTrig, FixInertTrigFunction, DeactivateTrigAux, PowerOfInertTrigSumQ, PiecewiseLinearQ, KnownTrigIntegrandQ, KnownSineIntegrandQ, KnownTangentIntegrandQ, KnownCotangentIntegrandQ, KnownSecantIntegrandQ, TryPureTanSubst, TryTanhSubst, TryPureTanhSubst, AbsurdNumberGCD, AbsurdNumberGCDList, ExpandTrigExpand, ExpandTrigReduce, ExpandTrigReduceAux, NormalizeTrig, TrigToExp, ExpandTrigToExp, TrigReduce, FunctionOfTrig, AlgebraicTrigFunctionQ, FunctionOfHyperbolic, FunctionOfQ, FunctionOfExpnQ, PureFunctionOfSinQ, PureFunctionOfCosQ, PureFunctionOfTanQ, PureFunctionOfCotQ, FunctionOfCosQ, FunctionOfSinQ, OddTrigPowerQ, FunctionOfTanQ, FunctionOfTanWeight, FunctionOfTrigQ, FunctionOfDensePolynomialsQ, FunctionOfLog, PowerVariableExpn, PowerVariableDegree, PowerVariableSubst, EulerIntegrandQ, FunctionOfSquareRootOfQuadratic, SquareRootOfQuadraticSubst, Divides, EasyDQ, ProductOfLinearPowersQ, Rt, NthRoot, AtomBaseQ, SumBaseQ, NegSumBaseQ, AllNegTermQ, SomeNegTermQ, TrigSquareQ, RtAux, TrigSquare, IntSum, IntTerm, Map2, ConstantFactor, SameQ, ReplacePart, CommonFactors, MostMainFactorPosition, FunctionOfExponentialQ, FunctionOfExponential, FunctionOfExponentialFunction, FunctionOfExponentialFunctionAux, FunctionOfExponentialTest, FunctionOfExponentialTestAux, stdev, rubi_test, If, IntQuadraticQ, IntBinomialQ, RectifyTangent, RectifyCotangent, Inequality, Condition, Simp, SimpHelp, SplitProduct, SplitSum, SubstFor, SubstForAux, FresnelS, FresnelC, Erfc, Erfi, Gamma, FunctionOfTrigOfLinearQ, ElementaryFunctionQ, Complex, UnsameQ, _SimpFixFactor, SimpFixFactor, _FixSimplify, FixSimplify, _SimplifyAntiderivativeSum, SimplifyAntiderivativeSum, _SimplifyAntiderivative, SimplifyAntiderivative, _TrigSimplifyAux, TrigSimplifyAux, Cancel, Part, PolyLog, D, Dist)
    from sympy import Integral, S, sqrt
    from sympy.integrals.rubi.symbol import WC
    from sympy.core.symbol import symbols, Symbol
    from sympy.functions import (log, sin, cos, tan, cot, csc, sec, sqrt, erf, exp, log)
    from sympy.functions.elementary.hyperbolic import (acosh, asinh, atanh, acoth, acsch, asech, cosh, sinh, tanh, coth, sech, csch)
    from sympy.functions.elementary.trigonometric import (atan, acsc, asin, acot, acos, asec)

    A_, B_, C_, F_, G_, H_, a_, b_, c_, d_, e_, f_, g_, h_, i_, j_, k_, l_, m_, n_, p_, q_, r_, t_, u_, v_, s_, w_, x_, y_, z_ = [WC(i) for i in 'ABCFGHabcdefghijklmnpqrtuvswxyz']
    a1_, a2_, b1_, b2_, c1_, c2_, d1_, d2_, n1_, n2_, e1_, e2_, f1_, f2_, g1_, g2_, n1_, n2_, n3_, Pq_, Pm_, Px_, Qm_, Qr_, Qx_, jn_, mn_, non2_, RFx_, RGx_ = [WC(i) for i in ['a1', 'a2', 'b1', 'b2', 'c1', 'c2', 'd1', 'd2', 'n1', 'n2', 'e1', 'e2', 'f1', 'f2', 'g1', 'g2', 'n1', 'n2', 'n3', 'Pq', 'Pm', 'Px', 'Qm', 'Qr', 'Qx', 'jn', 'mn', 'non2', 'RFx', 'RGx']]

    _UseGamma = False

def logarithms(rubi):

    pattern1 = Pattern(Integral(log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)))
    rule1 = ReplacementRule(pattern1, lambda c, f, d, q, x, e, p : -p*q*x + (e + f*x)*log(c*(d*(e + f*x)**p)**q)/f)
    rubi.add(rule1)

    pattern2 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule2 = ReplacementRule(pattern2, lambda c, f, d, a, q, x, n, e, p, b : -b*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1)), x) + (a + b*log(c*(d*(e + f*x)**p)**q))**n*(e + f*x)/f)
    rubi.add(rule2)

    pattern3 = Pattern(Integral(1/log((x_*WC('f', S(1)) + WC('e', S(0)))*WC('d', S(1))), x_), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule3 = ReplacementRule(pattern3, lambda x, e, f, d : LogIntegral(d*(e + f*x))/(d*f))
    rubi.add(rule3)

    pattern4 = Pattern(Integral(1/(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)))
    rule4 = ReplacementRule(pattern4, lambda c, f, d, a, q, x, e, p, b : (c*(d*(e + f*x)**p)**q)**(-S(1)/(p*q))*(e + f*x)*ExpIntegralEi((a + b*log(c*(d*(e + f*x)**p)**q))/(b*p*q))*exp(-a/(b*p*q))/(b*f*p*q))
    rubi.add(rule4)

    pattern5 = Pattern(Integral(1/sqrt(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda p, b, q: PosQ(b*p*q)))
    rule5 = ReplacementRule(pattern5, lambda c, f, d, a, q, x, e, p, b : sqrt(Pi)*(c*(d*(e + f*x)**p)**q)**(-S(1)/(p*q))*(e + f*x)*Erfi(sqrt(a + b*log(c*(d*(e + f*x)**p)**q))/Rt(b*p*q, S(2)))*Rt(b*p*q, S(2))*exp(-a/(b*p*q))/(b*f*p*q))
    rubi.add(rule5)

    pattern6 = Pattern(Integral(1/sqrt(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda p, b, q: NegQ(b*p*q)))
    rule6 = ReplacementRule(pattern6, lambda c, f, d, a, q, x, e, p, b : sqrt(Pi)*(c*(d*(e + f*x)**p)**q)**(-S(1)/(p*q))*(e + f*x)*Erf(sqrt(a + b*log(c*(d*(e + f*x)**p)**q))/Rt(-b*p*q, S(2)))*Rt(-b*p*q, S(2))*exp(-a/(b*p*q))/(b*f*p*q))
    rubi.add(rule6)

    pattern7 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule7 = ReplacementRule(pattern7, lambda c, f, d, a, q, x, n, e, p, b : -Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1)), x)/(b*p*q*(n + S(1))) + (a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1))*(e + f*x)/(b*f*p*q*(n + S(1))))
    rubi.add(rule7)

    pattern8 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda n: Not(IntegerQ(S(2)*n))))
    rule8 = ReplacementRule(pattern8, lambda c, f, d, a, q, x, n, e, p, b : (c*(d*(e + f*x)**p)**q)**(-S(1)/(p*q))*((-a - b*log(c*(d*(e + f*x)**p)**q))/(b*p*q))**(-n)*(a + b*log(c*(d*(e + f*x)**p)**q))**n*(e + f*x)*Gamma(n + S(1), (-a - b*log(c*(d*(e + f*x)**p)**q))/(b*p*q))*exp(-a/(b*p*q))/f)
    rubi.add(rule8)

    pattern9 = Pattern(Integral(S(1)/((x_*WC('h', S(1)) + WC('g', S(0)))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)))
    rule9 = ReplacementRule(pattern9, lambda g, c, f, d, a, q, x, e, h, p, b : log(RemoveContent(a + b*log(c*(d*(e + f*x)**p)**q), x))/(b*h*p*q))
    rubi.add(rule9)

    pattern10 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda n: NonzeroQ(n + S(1))))
    rule10 = ReplacementRule(pattern10, lambda g, c, f, d, a, q, n, x, e, h, p, b : (a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1))/(b*h*p*q*(n + S(1))))
    rubi.add(rule10)

    pattern11 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule11 = ReplacementRule(pattern11, lambda m, g, c, f, d, a, q, n, x, e, h, p, b : -b*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1))*(g + h*x)**m, x)/(m + S(1)) + (a + b*log(c*(d*(e + f*x)**p)**q))**n*(g + h*x)**(m + S(1))/(h*(m + S(1))))
    rubi.add(rule11)

    pattern12 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))/log((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1))), x_), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, p: ZeroQ(m - p + S(1))), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda p, f, h: IntegerQ(p) | PositiveQ(h/f)))
    rule12 = ReplacementRule(pattern12, lambda m, g, f, x, d, e, h, p : (h/f)**(p + S(-1))*LogIntegral(d*(e + f*x)**p)/(d*f*p))
    rubi.add(rule12)

    pattern13 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**m_/log((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1))), x_), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, p: ZeroQ(m - p + S(1))), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda p, f, h: Not(IntegerQ(p) | PositiveQ(h/f))))
    rule13 = ReplacementRule(pattern13, lambda m, g, f, x, d, e, h, p : (e + f*x)**(-p + S(1))*(g + h*x)**(p + S(-1))*Int((e + f*x)**(p + S(-1))/log(d*(e + f*x)**p), x))
    rubi.add(rule13)

    pattern14 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))/(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule14 = ReplacementRule(pattern14, lambda m, g, c, f, d, a, q, x, e, h, p, b : (c*(d*(e + f*x)**p)**q)**(-(m + S(1))/(p*q))*(g + h*x)**(m + S(1))*ExpIntegralEi((a + b*log(c*(d*(e + f*x)**p)**q))*(m + S(1))/(b*p*q))*exp(-a*(m + S(1))/(b*p*q))/(b*h*p*q))
    rubi.add(rule14)

    pattern15 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))/sqrt(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda m, p, b, q: PosQ((m + S(1))/(b*p*q))))
    rule15 = ReplacementRule(pattern15, lambda m, g, c, f, d, a, q, x, e, h, p, b : sqrt(Pi)*(c*(d*(e + f*x)**p)**q)**(-(m + S(1))/(p*q))*(g + h*x)**(m + S(1))*Erfi(sqrt(a + b*log(c*(d*(e + f*x)**p)**q))*Rt((m + S(1))/(b*p*q), S(2)))*exp(-a*(m + S(1))/(b*p*q))/(b*h*p*q*Rt((m + S(1))/(b*p*q), S(2))))
    rubi.add(rule15)

    pattern16 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))/sqrt(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda m, p, b, q: NegQ((m + S(1))/(b*p*q))))
    rule16 = ReplacementRule(pattern16, lambda m, g, c, f, d, a, q, x, e, h, p, b : sqrt(Pi)*(c*(d*(e + f*x)**p)**q)**(-(m + S(1))/(p*q))*(g + h*x)**(m + S(1))*Erf(sqrt(a + b*log(c*(d*(e + f*x)**p)**q))*Rt((-m + S(-1))/(b*p*q), S(2)))*exp(-a*(m + S(1))/(b*p*q))/(b*h*p*q*Rt((-m + S(-1))/(b*p*q), S(2))))
    rubi.add(rule16)

    pattern17 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule17 = ReplacementRule(pattern17, lambda m, g, c, f, d, a, q, x, n, e, h, p, b : -(m + S(1))*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1))*(g + h*x)**m, x)/(b*p*q*(n + S(1))) + (a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1))*(g + h*x)**(m + S(1))/(b*h*p*q*(n + S(1))))
    rubi.add(rule17)

    pattern18 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule18 = ReplacementRule(pattern18, lambda m, g, c, f, d, a, q, n, x, e, h, p, b : (c*(d*(e + f*x)**p)**q)**(-(m + S(1))/(p*q))*((a + b*log(c*(d*(e + f*x)**p)**q))*(-m + S(-1))/(b*p*q))**(-n)*(a + b*log(c*(d*(e + f*x)**p)**q))**n*(g + h*x)**(m + S(1))*Gamma(n + S(1), (a + b*log(c*(d*(e + f*x)**p)**q))*(-m + S(-1))/(b*p*q))*exp(-a*(m + S(1))/(b*p*q))/(h*(m + S(1))))
    rubi.add(rule18)

    pattern19 = Pattern(Integral(log((x_*WC('f', S(1)) + WC('e', S(0)))*WC('c', S(1)))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda g, c, f, e, h: ZeroQ(c*(-e*h + f*g) + h)))
    rule19 = ReplacementRule(pattern19, lambda g, c, f, x, e, h : -PolyLog(S(2), -c*f*(g + h*x)/h)/h)
    rubi.add(rule19)

    pattern20 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log((x_*WC('f', S(1)) + WC('e', S(0)))*WC('c', S(1))))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda g, c, f, e, h: NonzeroQ(c*(-e*h + f*g) + h)), CustomConstraint(lambda g, c, f, e, h: PositiveQ(c*(e - f*g/h))))
    rule20 = ReplacementRule(pattern20, lambda g, c, f, a, x, e, h, b : b*Int(log(-h*(e + f*x)/(-e*h + f*g))/(g + h*x), x) + (a + b*log(c*(e - f*g/h)))*log(g + h*x)/h)
    rubi.add(rule20)

    pattern21 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: NonzeroQ(-e*h + f*g)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule21 = ReplacementRule(pattern21, lambda g, c, f, d, a, q, n, x, e, h, p, b : -b*f*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1))*log(f*(g + h*x)/(-e*h + f*g))/(e + f*x), x)/h + (a + b*log(c*(d*(e + f*x)**p)**q))**n*log(f*(g + h*x)/(-e*h + f*g))/h)
    rubi.add(rule21)

    pattern22 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: NonzeroQ(-e*h + f*g)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule22 = ReplacementRule(pattern22, lambda m, g, c, f, d, a, q, x, e, h, p, b : -b*f*p*q*Int((g + h*x)**(m + S(1))/(e + f*x), x)/(h*(m + S(1))) + (a + b*log(c*(d*(e + f*x)**p)**q))*(g + h*x)**(m + S(1))/(h*(m + S(1))))
    rubi.add(rule22)

    pattern23 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_/(x_*WC('h', S(1)) + WC('g', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: NonzeroQ(-e*h + f*g)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule23 = ReplacementRule(pattern23, lambda g, c, f, d, a, q, x, n, e, h, p, b : -b*f*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1))/(g + h*x), x)/(-e*h + f*g) + (a + b*log(c*(d*(e + f*x)**p)**q))**n*(e + f*x)/((g + h*x)*(-e*h + f*g)))
    rubi.add(rule23)

    pattern24 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: NonzeroQ(-e*h + f*g)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m, n: Equal(n, S(1)) | Not(PositiveIntegerQ(m)) | (Equal(n, S(2)) & NonzeroQ(m + S(-1)))))
    rule24 = ReplacementRule(pattern24, lambda m, g, c, f, d, a, q, x, n, e, h, p, b : -b*f*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1))*(g + h*x)**(m + S(1))/(e + f*x), x)/(h*(m + S(1))) + (a + b*log(c*(d*(e + f*x)**p)**q))**n*(g + h*x)**(m + S(1))/(h*(m + S(1))))
    rubi.add(rule24)

    pattern25 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))/(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: NonzeroQ(-e*h + f*g)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule25 = ReplacementRule(pattern25, lambda m, g, c, f, d, a, q, x, e, h, p, b : Int(ExpandIntegrand((g + h*x)**m/(a + b*log(c*(d*(e + f*x)**p)**q)), x), x))
    rubi.add(rule25)

    pattern26 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: NonzeroQ(-e*h + f*g)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: Greater(m, S(0))))
    rule26 = ReplacementRule(pattern26, lambda m, g, c, f, d, a, q, x, n, e, h, p, b : -(m + S(1))*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1))*(g + h*x)**m, x)/(b*p*q*(n + S(1))) + m*(-e*h + f*g)*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1))*(g + h*x)**(m + S(-1)), x)/(b*f*p*q*(n + S(1))) + (a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(1))*(e + f*x)*(g + h*x)**m/(b*f*p*q*(n + S(1))))
    rubi.add(rule26)

    pattern27 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: NonzeroQ(-e*h + f*g)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule27 = ReplacementRule(pattern27, lambda m, g, c, f, d, a, q, x, n, e, h, p, b : Int(ExpandIntegrand((a + b*log(c*(d*(e + f*x)**p)**q))**n*(g + h*x)**m, x), x))
    rubi.add(rule27)

    pattern28 = Pattern(Integral(u_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log((v_**p_*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, v, u: LinearQ(List(u, v), x)), CustomConstraint(lambda x, v, u: Not(LinearMatchQ(List(u, v), x))))
    rule28 = ReplacementRule(pattern28, lambda m, c, n, d, a, q, x, u, p, v, b : Int((a + b*log(c*(d*ExpandToSum(v, x)**p)**q))**n*ExpandToSum(u, x)**m, x))
    rubi.add(rule28)

    pattern29 = Pattern(Integral((x_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)))
    rule29 = ReplacementRule(pattern29, lambda m, g, c, f, d, a, q, n, x, e, h, p, b : Int((a + b*log(c*(d*(e + f*x)**p)**q))**n*(g + h*x)**m, x))
    rubi.add(rule29)

    pattern30 = Pattern(Integral(log(WC('c', S(1))/(x_*WC('f', S(1)) + WC('e', S(0))))/((x_*WC('h', S(1)) + WC('g', S(0)))*(x_*WC('j', S(1)) + WC('i', S(0)))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda c, f, i, j, e: ZeroQ(f*i + j*(c - e))))
    rule30 = ReplacementRule(pattern30, lambda g, c, f, i, x, j, e, h : f*PolyLog(S(2), f*(i + j*x)/(j*(e + f*x)))/(h*(-e*j + f*i)))
    rubi.add(rule30)

    pattern31 = Pattern(Integral((a_ + WC('b', S(1))*log(WC('c', S(1))/(x_*WC('f', S(1)) + WC('e', S(0)))))/((x_*WC('h', S(1)) + WC('g', S(0)))*(x_*WC('j', S(1)) + WC('i', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda c, f, i, j, e: ZeroQ(f*i + j*(c - e))))
    rule31 = ReplacementRule(pattern31, lambda g, c, f, i, x, a, j, e, h, b : a*Int(S(1)/((g + h*x)*(i + j*x)), x) + b*Int(log(c/(e + f*x))/((g + h*x)*(i + j*x)), x))
    rubi.add(rule31)

    pattern32 = Pattern(Integral((x_*WC('j', S(1)) + WC('i', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: IntegerQ(m + S(1)/2)), )
    def With32(m, g, c, f, d, a, q, i, j, e, x, h, p, b):
        u = IntHide((i + j*x)**m/(g + h*x), x)
        return -b*h*p*q*Int(SimplifyIntegrand(u/(g + h*x), x), x) + Dist(a + b*log(c*(d*(e + f*x)**p)**q), u)
    rule32 = ReplacementRule(pattern32, lambda m, g, c, f, d, a, q, i, j, e, x, h, p, b : With32(m, g, c, f, d, a, q, i, j, e, x, h, p, b))
    rubi.add(rule32)

    pattern33 = Pattern(Integral((x_*WC('j', S(1)) + WC('i', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log((x_*WC('f', S(1)) + WC('e', S(0)))*WC('c', S(1))))**WC('n', S(1))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(-e*h + f*g)), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda m, n: IntegerQ(n) | Greater(m, S(0))))
    rule33 = ReplacementRule(pattern33, lambda m, g, c, f, a, n, i, j, x, e, h, b : c**(-m)*f**(-m)*Subst(Int((a + b*x)**n*(-c*e*j + c*f*i + j*exp(x))**m, x), x, log(c*(e + f*x)))/h)
    rubi.add(rule33)

    pattern34 = Pattern(Integral((x_*WC('j', S(1)) + WC('i', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda u, x: SumQ(u)))
    def With34(m, g, c, f, d, a, q, n, i, e, j, x, h, p, b):
        u = ExpandIntegrand((a + b*log(c*(d*(e + f*x)**p)**q))**n, (i + j*x)**m/(g + h*x), x)
        return Int(u, x)
    rule34 = ReplacementRule(pattern34, lambda m, g, c, f, d, a, q, n, i, e, j, x, h, p, b : With34(m, g, c, f, d, a, q, n, i, e, j, x, h, p, b))
    rubi.add(rule34)

    pattern35 = Pattern(Integral((x_*WC('j', S(1)) + WC('i', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)))
    rule35 = ReplacementRule(pattern35, lambda m, g, c, f, d, a, q, n, i, e, j, x, h, p, b : Int((a + b*log(c*(d*(e + f*x)**p)**q))**n*(i + j*x)**m/(g + h*x), x))
    rubi.add(rule35)

    pattern36 = Pattern(Integral(log(WC('c', S(1))/(x_*WC('f', S(1)) + WC('e', S(0))))/(g_ + x_**S(2)*WC('h', S(1))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(e**S(2)*h + f**S(2)*g)), CustomConstraint(lambda e, c: ZeroQ(c - S(2)*e)))
    rule36 = ReplacementRule(pattern36, lambda g, x, c, f, e, h : -f*PolyLog(S(2), (-e + f*x)/(e + f*x))/(S(2)*e*h))
    rubi.add(rule36)

    pattern37 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(WC('c', S(1))/(x_*WC('f', S(1)) + WC('e', S(0)))))/(g_ + x_**S(2)*WC('h', S(1))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda g, e, f, h: ZeroQ(e**S(2)*h + f**S(2)*g)), CustomConstraint(lambda e, c: PositiveQ(c/(S(2)*e))), CustomConstraint(lambda e, c, a: NonzeroQ(a) | NonzeroQ(c - S(2)*e)))
    rule37 = ReplacementRule(pattern37, lambda g, c, f, a, x, e, h, b : b*Int(log(S(2)*e/(e + f*x))/(g + h*x**S(2)), x) + (a + b*log(c/(S(2)*e)))*Int(1/(g + h*x**S(2)), x))
    rubi.add(rule37)

    pattern38 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))/(x_**S(2)*WC('i', S(1)) + x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, f, i, e, h: ZeroQ(e**S(2)*i - e*f*h + f**S(2)*g)))
    rule38 = ReplacementRule(pattern38, lambda g, c, f, d, a, q, i, x, e, h, p, b : e*f*Int((a + b*log(c*(d*(e + f*x)**p)**q))/((e + f*x)*(e*i*x + f*g)), x))
    rubi.add(rule38)

    pattern39 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((e_ + x_*WC('f', S(1)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))/(g_ + x_**S(2)*WC('i', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g, e, f, i: ZeroQ(e**S(2)*i + f**S(2)*g)))
    rule39 = ReplacementRule(pattern39, lambda g, c, f, d, a, q, i, x, e, p, b : e*f*Int((a + b*log(c*(d*(e + f*x)**p)**q))/((e + f*x)*(e*i*x + f*g)), x))
    rubi.add(rule39)

    pattern40 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))/sqrt(g_ + x_**S(2)*WC('h', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g: PositiveQ(g)), )
    def With40(g, c, f, d, a, q, x, e, h, p, b):
        u = IntHide(1/sqrt(g + h*x**S(2)), x)
        return -b*f*p*q*Int(SimplifyIntegrand(u/(e + f*x), x), x) + u*(a + b*log(c*(d*(e + f*x)**p)**q))
    rule40 = ReplacementRule(pattern40, lambda g, c, f, d, a, q, x, e, h, p, b : With40(g, c, f, d, a, q, x, e, h, p, b))
    rubi.add(rule40)

    pattern41 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))/(sqrt(g1_ + x_*WC('h1', S(1)))*sqrt(g2_ + x_*WC('h2', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g1, x: FreeQ(g1, x)), CustomConstraint(lambda h1, x: FreeQ(h1, x)), CustomConstraint(lambda g2, x: FreeQ(g2, x)), CustomConstraint(lambda h2, x: FreeQ(h2, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda h2, h1, g2, g1: ZeroQ(g1*h2 + g2*h1)), CustomConstraint(lambda g1: PositiveQ(g1)), CustomConstraint(lambda g2: PositiveQ(g2)), )
    def With41(c, f, d, a, q, h1, x, e, p, g2, g1, b, h2):
        u = IntHide(1/sqrt(g1*g2 + h1*h2*x**S(2)), x)
        return -b*f*p*q*Int(SimplifyIntegrand(u/(e + f*x), x), x) + u*(a + b*log(c*(d*(e + f*x)**p)**q))
    rule41 = ReplacementRule(pattern41, lambda c, f, d, a, q, h1, x, e, p, g2, g1, b, h2 : With41(c, f, d, a, q, h1, x, e, p, g2, g1, b, h2))
    rubi.add(rule41)

    pattern42 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))/sqrt(g_ + x_**S(2)*WC('h', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda g: Not(PositiveQ(g))))
    rule42 = ReplacementRule(pattern42, lambda g, c, f, d, a, q, x, e, h, p, b : sqrt(S(1) + h*x**S(2)/g)*Int((a + b*log(c*(d*(e + f*x)**p)**q))/sqrt(S(1) + h*x**S(2)/g), x)/sqrt(g + h*x**S(2)))
    rubi.add(rule42)

    pattern43 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))/(sqrt(g1_ + x_*WC('h1', S(1)))*sqrt(g2_ + x_*WC('h2', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g1, x: FreeQ(g1, x)), CustomConstraint(lambda h1, x: FreeQ(h1, x)), CustomConstraint(lambda g2, x: FreeQ(g2, x)), CustomConstraint(lambda h2, x: FreeQ(h2, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda h2, h1, g2, g1: ZeroQ(g1*h2 + g2*h1)))
    rule43 = ReplacementRule(pattern43, lambda c, f, d, a, q, h1, x, e, p, g2, g1, b, h2 : sqrt(S(1) + h1*h2*x**S(2)/(g1*g2))*Int((a + b*log(c*(d*(e + f*x)**p)**q))/sqrt(S(1) + h1*h2*x**S(2)/(g1*g2)), x)/(sqrt(g1 + h1*x)*sqrt(g2 + h2*x)))
    rubi.add(rule43)

    pattern44 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))*log((x_*WC('k', S(1)) + WC('j', S(0)))*WC('i', S(1)))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda k, x: FreeQ(k, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda g, k, i, j, h: ZeroQ(h - i*(-g*k + h*j))))
    rule44 = ReplacementRule(pattern44, lambda g, k, c, i, a, d, f, j, q, e, n, x, h, p, b : b*f*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1))*PolyLog(S(2), -i*(j + k*x) + S(1))/(e + f*x), x)/h - (a + b*log(c*(d*(e + f*x)**p)**q))**n*PolyLog(S(2), -i*(j + k*x) + S(1))/h)
    rubi.add(rule44)

    pattern45 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))*log((x_*WC('k', S(1)) + WC('j', S(0)))**WC('m', S(1))*WC('i', S(1)) + S(1))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda k, x: FreeQ(k, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda j, g, k, h: ZeroQ(-g*k + h*j)))
    rule45 = ReplacementRule(pattern45, lambda m, g, k, c, i, a, d, f, j, q, e, n, x, h, p, b : b*f*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1))*PolyLog(S(2), -i*(j + k*x)**m)/(e + f*x), x)/(h*m) - (a + b*log(c*(d*(e + f*x)**p)**q))**n*PolyLog(S(2), -i*(j + k*x)**m)/(h*m))
    rubi.add(rule45)

    pattern46 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))*PolyLog(r_, (x_*WC('k', S(1)) + WC('j', S(0)))**WC('m', S(1))*WC('i', S(1)))/(x_*WC('h', S(1)) + WC('g', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda i, x: FreeQ(i, x)), CustomConstraint(lambda j, x: FreeQ(j, x)), CustomConstraint(lambda k, x: FreeQ(k, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda r, x: FreeQ(r, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda j, g, k, h: ZeroQ(-g*k + h*j)))
    rule46 = ReplacementRule(pattern46, lambda m, g, k, c, f, d, a, q, n, i, e, j, x, h, p, r, b : -b*f*n*p*q*Int((a + b*log(c*(d*(e + f*x)**p)**q))**(n + S(-1))*PolyLog(r + S(1), i*(j + k*x)**m)/(e + f*x), x)/(h*m) + (a + b*log(c*(d*(e + f*x)**p)**q))**n*PolyLog(r + S(1), i*(j + k*x)**m)/(h*m))
    rubi.add(rule46)

    pattern47 = Pattern(Integral(F_**(x_*WC('h', S(1)) + WC('g', S(0)))*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))*WC('Px', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, Px: PolynomialQ(Px, x)), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda F: MemberQ(List(Log, ArcSin, ArcCos, ArcTan, ArcCot, ArcSinh, ArcCosh, ArcTanh, ArcCoth), F)), )
    def With47(m, g, c, f, d, a, q, x, F, e, h, p, b, Px):
        u = IntHide(Px*F(g + h*x)**m, x)
        return -b*f*p*q*Int(SimplifyIntegrand(u/(e + f*x), x), x) + Dist(a + b*log(c*(d*(e + f*x)**p)**q), u, x)
    rule47 = ReplacementRule(pattern47, lambda m, g, c, f, d, a, q, x, F, e, h, p, b, Px : With47(m, g, c, f, d, a, q, x, F, e, h, p, b, Px))
    rubi.add(rule47)

    pattern48 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((e_ + x_**m_*WC('f', S(1)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))/x_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule48 = ReplacementRule(pattern48, lambda m, c, f, d, a, q, n, x, e, p, b : Subst(Int((a + b*log(c*(d*(e + f*x)**p)**q))**n/x, x), x, x**m)/m)
    rubi.add(rule48)

    pattern49 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_**m_*(f_ + x_**WC('r', S(1))*WC('e', S(1))))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))/x_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda m, r: ZeroQ(m + r)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule49 = ReplacementRule(pattern49, lambda m, r, c, n, d, a, q, x, f, e, p, b : Subst(Int((a + b*log(c*(d*(e + f*x)**p)**q))**n/x, x), x, x**m)/m)
    rubi.add(rule49)

    pattern50 = Pattern(Integral(x_**WC('r1', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_**r_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda r, x: FreeQ(r, x)), CustomConstraint(lambda r1, r: ZeroQ(-r + r1 + S(1))))
    rule50 = ReplacementRule(pattern50, lambda r, c, f, d, a, q, n, x, e, p, r1, b : Subst(Int((a + b*log(c*(d*(e + f*x)**p)**q))**n, x), x, x**r)/r)
    rubi.add(rule50)

    pattern51 = Pattern(Integral(x_**WC('r1', S(1))*(x_**r_*WC('h', S(1)) + WC('g', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(((x_**r_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda r, x: FreeQ(r, x)), CustomConstraint(lambda r1, r: ZeroQ(-r + r1 + S(1))))
    rule51 = ReplacementRule(pattern51, lambda m, g, r, c, f, d, a, q, n, x, e, h, p, r1, b : Subst(Int((a + b*log(c*(d*(e + f*x)**p)**q))**n*(g + h*x)**m, x), x, x**r)/r)
    rubi.add(rule51)

    pattern52 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(x_**WC('n', S(1))*WC('c', S(1))))/(d_ + x_**S(2)*WC('e', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), )
    def With52(n, c, a, x, d, e, b):
        u = IntHide(1/(d + e*x**S(2)), x)
        return -b*n*Int(u/x, x) + Dist(a + b*log(c*x**n), u)
    rule52 = ReplacementRule(pattern52, lambda n, c, a, x, d, e, b : With52(n, c, a, x, d, e, b))
    rubi.add(rule52)

    pattern53 = Pattern(Integral(log((x_**mn_*WC('b', S(1)) + WC('a', S(0)))*WC('c', S(1)))/(x_*(d_ + x_**WC('n', S(1))*WC('e', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda mn, n: ZeroQ(mn + n)), CustomConstraint(lambda c, d, a, e, b: ZeroQ(-a*c*d + b*c*e + d)))
    rule53 = ReplacementRule(pattern53, lambda n, c, a, x, d, e, mn, b : PolyLog(S(2), -b*c*x**(-n)*(d + e*x**n)/d)/(d*n))
    rubi.add(rule53)

    pattern54 = Pattern(Integral(log(x_**mn_*(x_**WC('n', S(1))*WC('a', S(1)) + WC('b', S(0)))*WC('c', S(1)))/(x_*(d_ + x_**WC('n', S(1))*WC('e', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda mn, n: ZeroQ(mn + n)), CustomConstraint(lambda c, d, a, e, b: ZeroQ(-a*c*d + b*c*e + d)))
    rule54 = ReplacementRule(pattern54, lambda n, c, a, x, d, e, mn, b : PolyLog(S(2), -b*c*x**(-n)*(d + e*x**n)/d)/(d*n))
    rubi.add(rule54)

    pattern55 = Pattern(Integral(Px_*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, Px: PolynomialQ(Px, x)))
    rule55 = ReplacementRule(pattern55, lambda c, f, d, a, q, n, x, e, p, b, Px : Int(ExpandIntegrand(Px*(a + b*log(c*(d*(e + f*x)**p)**q))**n, x), x))
    rubi.add(rule55)

    pattern56 = Pattern(Integral(RFx_*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda u, x: SumQ(u)))
    def With56(c, f, d, a, q, n, x, e, RFx, p, b):
        u = ExpandIntegrand((a + b*log(c*(d*(e + f*x)**p)**q))**n, RFx, x)
        return Int(u, x)
    rule56 = ReplacementRule(pattern56, lambda c, f, d, a, q, n, x, e, RFx, p, b : With56(c, f, d, a, q, n, x, e, RFx, p, b))
    rubi.add(rule56)

    pattern57 = Pattern(Integral(RFx_*(WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda u, x: SumQ(u)))
    def With57(c, f, d, a, q, n, x, e, RFx, p, b):
        u = ExpandIntegrand(RFx*(a + b*log(c*(d*(e + f*x)**p)**q))**n, x)
        return Int(u, x)
    rule57 = ReplacementRule(pattern57, lambda c, f, d, a, q, n, x, e, RFx, p, b : With57(c, f, d, a, q, n, x, e, RFx, p, b))
    rubi.add(rule57)

    pattern58 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_**S(2)*WC('g', S(1)) + x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))*WC('u', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda g, e, f: ZeroQ(-S(4)*e*g + f**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule58 = ReplacementRule(pattern58, lambda g, c, f, d, a, q, n, x, e, u, p, b : Int(u*(a + b*log(c*(S(4)**(-p)*d*g**(-p)*(f + S(2)*g*x)**(S(2)*p))**q))**n, x))
    rubi.add(rule58)

    pattern59 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log((v_**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**WC('n', S(1))*WC('u', S(1)), x_), CustomConstraint(lambda cc, x: FreeQ(cc, x)), CustomConstraint(lambda dd, x: FreeQ(dd, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda pp, x: FreeQ(pp, x)), CustomConstraint(lambda qq, x: FreeQ(qq, x)), CustomConstraint(lambda x, v: LinearQ(v, x)), CustomConstraint(lambda c, x, d, q, p, v: Not(MatchQ(c*(d*v**p)**q, Condition(((x*Optional(Pattern(f, Blank)) + Optional(Pattern(e, Blank)))**Optional(Pattern(pp, Blank))*Optional(Pattern(dd, Blank)))**Optional(Pattern(qq, Blank))*Optional(Pattern(cc, Blank)))))))
    rule59 = ReplacementRule(pattern59, lambda c, n, d, a, q, x, u, p, v, b : Int(u*(a + b*log(c*(d*ExpandToSum(v, x)**p)**q))**n, x))
    rubi.add(rule59)

    pattern60 = Pattern(Integral(log(((x_**WC('n', S(1))*WC('c', S(1)))**p_*WC('b', S(1)))**q_*WC('a', S(1)))**WC('r', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda r, x: FreeQ(r, x)))
    rule60 = ReplacementRule(pattern60, lambda r, n, c, a, x, q, p, b : Subst(Int(log(x**(n*p*q))**r, x), x**(n*p*q), a*(b*(c*x**n)**p)**q))
    rubi.add(rule60)

    pattern61 = Pattern(Integral(x_**WC('m', S(1))*log(((x_**WC('n', S(1))*WC('c', S(1)))**p_*WC('b', S(1)))**q_*WC('a', S(1)))**WC('r', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda r, x: FreeQ(r, x)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda n, x, q, a, c, p, b: Not(SameQ(x**(n*p*q), a*(b*(c*x**n)**p)**q))))
    rule61 = ReplacementRule(pattern61, lambda m, r, n, c, a, x, q, p, b : Subst(Int(x**m*log(x**(n*p*q))**r, x), x**(n*p*q), a*(b*(c*x**n)**p)**q))
    rubi.add(rule61)

    pattern62 = Pattern(Integral(WC('u', S(1))*log(((x_*WC('b', S(1)) + WC('a', S(0)))*WC('e1', S(1))/(x_*WC('d', S(1)) + WC('c', S(0))))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda d, b, c, a: ZeroQ(-a*d + b*c)))
    rule62 = ReplacementRule(pattern62, lambda c, n, e1, a, d, x, e, u, p, b : Int(u, x)*log(e*(b*e1/d)**n)**p)
    rubi.add(rule62)

    pattern63 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule63 = ReplacementRule(pattern63, lambda c, n, e1, a, d, x, n2, n1, e, p, b : -n*n1*p*(-a*d + b*c)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**(p + S(-1))/(c + d*x), x)/b + (a + b*x)*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/b)
    rubi.add(rule63)

    pattern64 = Pattern(Integral(log((x_*WC('b', S(1)) + WC('a', S(0)))*WC('e', S(1))/(x_*WC('d', S(1)) + WC('c', S(0))))/(x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: ZeroQ(-c*g + d*f)), CustomConstraint(lambda b, e, d: ZeroQ(-b*e + d)))
    rule64 = ReplacementRule(pattern64, lambda g, c, f, d, a, x, e, b : PolyLog(S(2), (-a*e + c)/(c + d*x))/g)
    rubi.add(rule64)

    pattern65 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: ZeroQ(-c*g + d*f)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule65 = ReplacementRule(pattern65, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : n*n1*p*(-a*d + b*c)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**(p + S(-1))*log((-a*d + b*c)/(b*(c + d*x)))/((a + b*x)*(c + d*x)), x)/g - log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p*log((-a*d + b*c)/(b*(c + d*x)))/g)
    rubi.add(rule65)

    pattern66 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, f, a, g: ZeroQ(-a*g + b*f)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule66 = ReplacementRule(pattern66, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : n*n1*p*(-a*d + b*c)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**(p + S(-1))*log((a*d - b*c)/(d*(a + b*x)))/((a + b*x)*(c + d*x)), x)/g - log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p*log((a*d - b*c)/(d*(a + b*x)))/g)
    rubi.add(rule66)

    pattern67 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))/(x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: NonzeroQ(-c*g + d*f)))
    rule67 = ReplacementRule(pattern67, lambda g, c, n, e1, a, d, f, x, n1, e, n2, b : -n*n1*(-a*d + b*c)*Int(log(f + g*x)/((a + b*x)*(c + d*x)), x)/g + log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)*log(f + g*x)/g)
    rubi.add(rule67)

    pattern68 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**p_/(x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: NonzeroQ(-c*g + d*f)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule68 = ReplacementRule(pattern68, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : d*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/(c + d*x), x)/g - (-c*g + d*f)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/((c + d*x)*(f + g*x)), x)/g)
    rubi.add(rule68)

    pattern69 = Pattern(Integral(S(1)/((x_*WC('g', S(1)) + WC('f', S(0)))**S(2)*log((x_*WC('b', S(1)) + WC('a', S(0)))*WC('e', S(1))/(x_*WC('d', S(1)) + WC('c', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: ZeroQ(-c*g + d*f)))
    rule69 = ReplacementRule(pattern69, lambda g, c, f, d, a, x, e, b : d**S(2)*LogIntegral(e*(a + b*x)/(c + d*x))/(e*g**S(2)*(-a*d + b*c)))
    rubi.add(rule69)

    pattern70 = Pattern(Integral(S(1)/((x_*WC('g', S(1)) + WC('f', S(0)))**S(2)*log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: ZeroQ(-c*g + d*f)))
    rule70 = ReplacementRule(pattern70, lambda g, c, n, e1, a, d, f, x, n1, e, n2, b : d**S(2)*(e*(e1*(a + b*x)**n1*(c + d*x)**n2)**n)**(-S(1)/(n*n1))*(a + b*x)*ExpIntegralEi(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)/(n*n1))/(g**S(2)*n*n1*(c + d*x)*(-a*d + b*c)))
    rubi.add(rule70)

    pattern71 = Pattern(Integral(S(1)/((x_*WC('g', S(1)) + WC('f', S(0)))**S(2)*log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, f, a, g: ZeroQ(-a*g + b*f)))
    rule71 = ReplacementRule(pattern71, lambda g, c, n, e1, a, d, f, x, n1, e, n2, b : b**S(2)*(e*(e1*(a + b*x)**n1*(c + d*x)**n2)**n)**(S(1)/(n*n1))*(c + d*x)*ExpIntegralEi(-log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)/(n*n1))/(g**S(2)*n*n1*(a + b*x)*(-a*d + b*c)))
    rubi.add(rule71)

    pattern72 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_*WC('g', S(1)) + WC('f', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, f, a, g: NonzeroQ(-a*g + b*f)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule72 = ReplacementRule(pattern72, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : -n*n1*p*(-a*d + b*c)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**(p + S(-1))/((c + d*x)*(f + g*x)), x)/(-a*g + b*f) + (a + b*x)*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/((f + g*x)*(-a*g + b*f)))
    rubi.add(rule72)

    pattern73 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_*WC('g', S(1)) + WC('f', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: NonzeroQ(-c*g + d*f)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule73 = ReplacementRule(pattern73, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : -n*n1*p*(-a*d + b*c)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**(p + S(-1))/((a + b*x)*(f + g*x)), x)/(-c*g + d*f) + (c + d*x)*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/((f + g*x)*(-c*g + d*f)))
    rubi.add(rule73)

    pattern74 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**p_/(x_*WC('g', S(1)) + WC('f', S(0)))**S(3), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, f, a, g: NonzeroQ(-a*g + b*f)), CustomConstraint(lambda c, g, f, d: ZeroQ(-c*g + d*f)))
    rule74 = ReplacementRule(pattern74, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : b*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/(f + g*x)**S(2), x)/(-a*g + b*f) - g*Int((a + b*x)*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/(f + g*x)**S(3), x)/(-a*g + b*f))
    rubi.add(rule74)

    pattern75 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**p_/(x_*WC('g', S(1)) + WC('f', S(0)))**S(3), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: NonzeroQ(-c*g + d*f)), CustomConstraint(lambda b, f, a, g: ZeroQ(-a*g + b*f)))
    rule75 = ReplacementRule(pattern75, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : d*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/(f + g*x)**S(2), x)/(-c*g + d*f) - g*Int((c + d*x)*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/(f + g*x)**S(3), x)/(-c*g + d*f))
    rubi.add(rule75)

    pattern76 = Pattern(Integral((x_*WC('g', S(1)) + WC('f', S(0)))**WC('m', S(1))*log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: PositiveIntegerQ(p)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule76 = ReplacementRule(pattern76, lambda m, g, c, n, e1, a, d, f, x, n1, e, n2, p, b : -n*n1*p*(-a*d + b*c)*Int((f + g*x)**(m + S(1))*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**(p + S(-1))/((a + b*x)*(c + d*x)), x)/(g*(m + S(1))) + (f + g*x)**(m + S(1))*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/(g*(m + S(1))))
    rubi.add(rule76)

    pattern77 = Pattern(Integral((x_*WC('b', S(1)) + WC('a', S(0)))**WC('m', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m2', S(1))*log(u_**n_*WC('e', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda x, c, a, d, u, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda m, m2: ZeroQ(m + m2 + S(2))), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(0))))
    rule77 = ReplacementRule(pattern77, lambda m, c, n, a, d, x, e, u, p, m2, b : -n*p*Int((a + b*x)**m*(c + d*x)**(-m + S(-2))*log(e*u**n)**(p + S(-1)), x)/(m + S(1)) + (a + b*x)**(m + S(1))*(c + d*x)**(-m + S(-1))*log(e*u**n)**p/((m + S(1))*(-a*d + b*c)))
    rubi.add(rule77)

    pattern78 = Pattern(Integral((x_*WC('b', S(1)) + WC('a', S(0)))**WC('m', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m2', S(1))*log(u_)**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda x, c, a, d, u, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda m, m2: ZeroQ(m + m2 + S(2))), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(0))))
    rule78 = ReplacementRule(pattern78, lambda m, c, x, a, d, u, p, m2, b : -p*Int((a + b*x)**m*(c + d*x)**(-m + S(-2))*log(u)**(p + S(-1)), x)/(m + S(1)) + (a + b*x)**(m + S(1))*(c + d*x)**(-m + S(-1))*log(u)**p/((m + S(1))*(-a*d + b*c)))
    rubi.add(rule78)

    pattern79 = Pattern(Integral((x_*WC('b', S(1)) + WC('a', S(0)))**WC('m', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m2', S(1))/log(u_**n_*WC('e', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda x, c, a, d, u, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda m, m2: ZeroQ(m + m2 + S(2))), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule79 = ReplacementRule(pattern79, lambda m, c, n, a, d, x, e, u, m2, b : (e*u**n)**(-(m + S(1))/n)*(a + b*x)**(m + S(1))*(c + d*x)**(-m + S(-1))*ExpIntegralEi((m + S(1))*log(e*u**n)/n)/(n*(-a*d + b*c)))
    rubi.add(rule79)

    pattern80 = Pattern(Integral((x_*WC('b', S(1)) + WC('a', S(0)))**WC('m', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m2', S(1))/log(u_), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda x, c, a, d, u, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda m, m2: ZeroQ(m + m2 + S(2))), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule80 = ReplacementRule(pattern80, lambda m, c, x, d, a, u, m2, b : u**(-m + S(-1))*(a + b*x)**(m + S(1))*(c + d*x)**(-m + S(-1))*ExpIntegralEi((m + S(1))*log(u))/(-a*d + b*c))
    rubi.add(rule80)

    pattern81 = Pattern(Integral((x_*WC('b', S(1)) + WC('a', S(0)))**WC('m', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m2', S(1))*log(u_**n_*WC('e', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda x, c, a, d, u, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda m, m2: ZeroQ(m + m2 + S(2))), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule81 = ReplacementRule(pattern81, lambda m, c, n, a, d, x, e, u, p, m2, b : (a + b*x)**(m + S(1))*(c + d*x)**(-m + S(-1))*log(e*u**n)**(p + S(1))/(n*(p + S(1))*(-a*d + b*c)) - (m + S(1))*Int((a + b*x)**m*(c + d*x)**(-m + S(-2))*log(e*u**n)**(p + S(1)), x)/(n*(p + S(1))))
    rubi.add(rule81)

    pattern82 = Pattern(Integral((x_*WC('b', S(1)) + WC('a', S(0)))**WC('m', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m2', S(1))*log(u_)**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda x, c, a, d, u, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda m, m2: ZeroQ(m + m2 + S(2))), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule82 = ReplacementRule(pattern82, lambda m, c, x, a, d, u, p, m2, b : (a + b*x)**(m + S(1))*(c + d*x)**(-m + S(-1))*log(u)**(p + S(1))/((p + S(1))*(-a*d + b*c)) - (m + S(1))*Int((a + b*x)**m*(c + d*x)**(-m + S(-2))*log(u)**(p + S(1)), x)/(p + S(1)))
    rubi.add(rule82)

    pattern83 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/((x_*WC('d', S(1)) + WC('c', S(0)))*(x_*WC('g', S(1)) + WC('f', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, f, a, g: NonzeroQ(-a*g + b*f)), CustomConstraint(lambda c, g, f, d: ZeroQ(-c*g + d*f)))
    rule83 = ReplacementRule(pattern83, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : d*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/(c + d*x)**S(2), x)/g)
    rubi.add(rule83)

    pattern84 = Pattern(Integral(log((x_*WC('b', S(1)) + WC('a', S(0)))*WC('e', S(1))/(x_*WC('d', S(1)) + WC('c', S(0))))/((x_*WC('d', S(1)) + WC('c', S(0)))*(x_*WC('g', S(1)) + WC('f', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, f, a, g: NonzeroQ(-a*g + b*f)), CustomConstraint(lambda c, g, f, d: NonzeroQ(-c*g + d*f)), CustomConstraint(lambda g, c, f, d, a, e, b: ZeroQ(-c*g + d*f - e*(-a*g + b*f))))
    rule84 = ReplacementRule(pattern84, lambda g, c, f, d, a, x, e, b : PolyLog(S(2), -(f + g*x)*(a*e - c)/(f*(c + d*x)))/(-c*g + d*f))
    rubi.add(rule84)

    pattern85 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/((x_*WC('d', S(1)) + WC('c', S(0)))*(x_*WC('g', S(1)) + WC('f', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda b, f, a, g: NonzeroQ(-a*g + b*f)), CustomConstraint(lambda c, g, f, d: NonzeroQ(-c*g + d*f)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule85 = ReplacementRule(pattern85, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : n*n1*p*(-a*d + b*c)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**(p + S(-1))*log((f + g*x)*(-a*d + b*c)/((c + d*x)*(-a*g + b*f)))/((a + b*x)*(c + d*x)), x)/(-c*g + d*f) - log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p*log((f + g*x)*(-a*d + b*c)/((c + d*x)*(-a*g + b*f)))/(-c*g + d*f))
    rubi.add(rule85)

    pattern86 = Pattern(Integral(log((x_*WC('b', S(1)) + WC('a', S(0)))*WC('e', S(1))/(x_*WC('d', S(1)) + WC('c', S(0))))/(f_ + x_**S(2)*WC('g', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda c, g, f, d: ZeroQ(c**S(2)*g + d**S(2)*f)), CustomConstraint(lambda c, d, a, e, b: ZeroQ(-a*d*e - b*c*e + S(2)*c*d)))
    rule86 = ReplacementRule(pattern86, lambda g, c, x, d, a, f, e, b : c*PolyLog(S(2), -(c - d*x)*(a*e - c)/(c*(c + d*x)))/(S(2)*d*f))
    rubi.add(rule86)

    pattern87 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_**S(2)*WC('h', S(1)) + x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda g, c, f, d, h: ZeroQ(c**S(2)*h - c*d*g + d**S(2)*f)))
    rule87 = ReplacementRule(pattern87, lambda g, c, n, e1, a, d, f, x, n1, e, n2, h, p, b : d**S(2)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/((c + d*x)*(-c*h + d*g + d*h*x)), x))
    rubi.add(rule87)

    pattern88 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_**S(2)*WC('h', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, f, h, d: ZeroQ(c**S(2)*h + d**S(2)*f)))
    rule88 = ReplacementRule(pattern88, lambda c, n, e1, a, d, f, x, n1, e, n2, h, p, b : -d**S(2)*Int(log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/((c - d*x)*(c + d*x)), x)/h)
    rubi.add(rule88)

    pattern89 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/((x_*WC('d', S(1)) + WC('c', S(0)))*(x_*WC('g', S(1)) + WC('f', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, g, f, d: NonzeroQ(-c*g + d*f)), CustomConstraint(lambda b, f, a, g: ZeroQ(-a*g + b*f)))
    rule89 = ReplacementRule(pattern89, lambda g, c, n, e1, a, d, f, x, n1, e, n2, p, b : b*Subst(Int(x**p, x), x, log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n))/(g*n*n1*(-a*d + b*c)))
    rubi.add(rule89)

    pattern90 = Pattern(Integral(log(v_)*log(u_**n_*WC('e', S(1)))**WC('p', S(1))/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(Add(S(1), Mul(S(-1), v)), S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(0))))
    rule90 = ReplacementRule(pattern90, lambda c, n, a, d, x, e, u, p, v, b : n*p*Int(PolyLog(S(2), -v + S(1))*log(e*u**n)**(p + S(-1))/((a + b*x)*(c + d*x)), x) - PolyLog(S(2), -v + S(1))*log(e*u**n)**p/(-a*d + b*c))
    rubi.add(rule90)

    pattern91 = Pattern(Integral(log(u_)**WC('p', S(1))*log(v_)/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(Add(S(1), Mul(S(-1), v)), S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(0))))
    rule91 = ReplacementRule(pattern91, lambda c, x, d, a, u, p, v, b : p*Int(PolyLog(S(2), -v + S(1))*log(u)**(p + S(-1))/((a + b*x)*(c + d*x)), x) - PolyLog(S(2), -v + S(1))*log(u)**p/(-a*d + b*c))
    rubi.add(rule91)

    pattern92 = Pattern(Integral(log(v_)*log(u_**n_*WC('e', S(1)))**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(Add(S(1), Mul(S(-1), v)), S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), )
    def With92(c, n, d, a, x, e, u, p, v, b):
        f = (-v + S(1))/u
        return f*Int(log(e*u**n)**(p + S(1))/((c + d*x)*(-a*f - b*f + c + d)), x)/(n*(p + S(1))) + log(v)*log(e*u**n)**(p + S(1))/(n*(p + S(1))*(-a*d + b*c))
    rule92 = ReplacementRule(pattern92, lambda c, n, d, a, x, e, u, p, v, b : With92(c, n, d, a, x, e, u, p, v, b))
    rubi.add(rule92)

    pattern93 = Pattern(Integral(log(u_)**p_*log(v_)/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(Add(S(1), Mul(S(-1), v)), S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), )
    def With93(c, x, d, a, u, p, v, b):
        f = (-v + S(1))/u
        return f*Int(log(u)**(p + S(1))/((c + d*x)*(-a*f - b*f + c + d)), x)/(p + S(1)) + log(u)**(p + S(1))*log(v)/((p + S(1))*(-a*d + b*c))
    rule93 = ReplacementRule(pattern93, lambda c, x, d, a, u, p, v, b : With93(c, x, d, a, u, p, v, b))
    rubi.add(rule93)

    pattern94 = Pattern(Integral(log(v_)*log(u_**n_*WC('e', S(1)))**WC('p', S(1))/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Add(S(1), Mul(S(-1), v)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(0))))
    rule94 = ReplacementRule(pattern94, lambda c, n, a, d, x, e, u, p, v, b : -n*p*Int(PolyLog(S(2), -v + S(1))*log(e*u**n)**(p + S(-1))/((a + b*x)*(c + d*x)), x) + PolyLog(S(2), -v + S(1))*log(e*u**n)**p/(-a*d + b*c))
    rubi.add(rule94)

    pattern95 = Pattern(Integral(log(u_)**WC('p', S(1))*log(v_)/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Add(S(1), Mul(S(-1), v)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(0))))
    rule95 = ReplacementRule(pattern95, lambda c, x, d, a, u, p, v, b : -p*Int(PolyLog(S(2), -v + S(1))*log(u)**(p + S(-1))/((a + b*x)*(c + d*x)), x) + PolyLog(S(2), -v + S(1))*log(u)**p/(-a*d + b*c))
    rubi.add(rule95)

    pattern96 = Pattern(Integral(log(v_)*log(u_**n_*WC('e', S(1)))**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Add(S(1), Mul(S(-1), v)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), )
    def With96(c, n, d, a, x, e, u, p, v, b):
        f = u*(-v + S(1))
        return -f*Int(log(e*u**n)**(p + S(1))/((a + b*x)*(a + b - c*f - d*f)), x)/(n*(p + S(1))) + log(v)*log(e*u**n)**(p + S(1))/(n*(p + S(1))*(-a*d + b*c))
    rule96 = ReplacementRule(pattern96, lambda c, n, d, a, x, e, u, p, v, b : With96(c, n, d, a, x, e, u, p, v, b))
    rubi.add(rule96)

    pattern97 = Pattern(Integral(log(u_)**p_*log(v_)/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Add(S(1), Mul(S(-1), v)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), )
    def With97(c, x, d, a, u, p, v, b):
        f = u*(-v + S(1))
        return -f*Int(log(u)**(p + S(1))/((a + b*x)*(a + b - c*f - d*f)), x)/(p + S(1)) + log(u)**(p + S(1))*log(v)/((p + S(1))*(-a*d + b*c))
    rule97 = ReplacementRule(pattern97, lambda c, x, d, a, u, p, v, b : With97(c, x, d, a, u, p, v, b))
    rubi.add(rule97)

    pattern98 = Pattern(Integral(PolyLog(q_, v_)*log(u_**n_*WC('e', S(1)))**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(v, S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule98 = ReplacementRule(pattern98, lambda c, n, d, a, x, q, e, u, p, v, b : -n*p*Int(PolyLog(q + S(1), v)*log(e*u**n)**(p + S(-1))/((a + b*x)*(c + d*x)), x) + PolyLog(q + S(1), v)*log(e*u**n)**p/(-a*d + b*c))
    rubi.add(rule98)

    pattern99 = Pattern(Integral(PolyLog(q_, v_)*log(u_)**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(v, S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule99 = ReplacementRule(pattern99, lambda c, x, d, a, q, u, p, v, b : -p*Int(PolyLog(q + S(1), v)*log(u)**(p + S(-1))/((a + b*x)*(c + d*x)), x) + PolyLog(q + S(1), v)*log(u)**p/(-a*d + b*c))
    rubi.add(rule99)

    pattern100 = Pattern(Integral(PolyLog(q_, v_)*log(u_**n_*WC('e', S(1)))**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(v, S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule100 = ReplacementRule(pattern100, lambda c, n, d, a, x, q, e, u, p, v, b : -Int(PolyLog(q + S(-1), v)*log(e*u**n)**(p + S(1))/((a + b*x)*(c + d*x)), x)/(n*(p + S(1))) + PolyLog(q, v)*log(e*u**n)**(p + S(1))/(n*(p + S(1))*(-a*d + b*c)))
    rubi.add(rule100)

    pattern101 = Pattern(Integral(PolyLog(q_, v_)*log(u_)**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Pow(v, S(-1)))), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule101 = ReplacementRule(pattern101, lambda c, x, d, a, q, u, p, v, b : -Int(PolyLog(q + S(-1), v)*log(u)**(p + S(1))/((a + b*x)*(c + d*x)), x)/(p + S(1)) + PolyLog(q, v)*log(u)**(p + S(1))/((p + S(1))*(-a*d + b*c)))
    rubi.add(rule101)

    pattern102 = Pattern(Integral(PolyLog(q_, v_)*log(u_**n_*WC('e', S(1)))**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, v)), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule102 = ReplacementRule(pattern102, lambda c, n, d, a, x, q, e, u, p, v, b : n*p*Int(PolyLog(q + S(1), v)*log(e*u**n)**(p + S(-1))/((a + b*x)*(c + d*x)), x) - PolyLog(q + S(1), v)*log(e*u**n)**p/(-a*d + b*c))
    rubi.add(rule102)

    pattern103 = Pattern(Integral(PolyLog(q_, v_)*log(u_)**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, v)), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule103 = ReplacementRule(pattern103, lambda c, x, d, a, q, u, p, v, b : p*Int(PolyLog(q + S(1), v)*log(u)**(p + S(-1))/((a + b*x)*(c + d*x)), x) - PolyLog(q + S(1), v)*log(u)**p/(-a*d + b*c))
    rubi.add(rule103)

    pattern104 = Pattern(Integral(PolyLog(q_, v_)*log(u_**n_*WC('e', S(1)))**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, v)), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule104 = ReplacementRule(pattern104, lambda c, n, d, a, x, q, e, u, p, v, b : Int(PolyLog(q + S(-1), v)*log(e*u**n)**(p + S(1))/((a + b*x)*(c + d*x)), x)/(n*(p + S(1))) + PolyLog(q, v)*log(e*u**n)**(p + S(1))/(n*(p + S(1))*(-a*d + b*c)))
    rubi.add(rule104)

    pattern105 = Pattern(Integral(PolyLog(q_, v_)*log(u_)**p_/((x_*WC('b', S(1)) + WC('a', S(0)))*(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, v)), x)), CustomConstraint(lambda x, c, a, d, u, v, b: FreeQ(simplify(Mul(u, Mul(Add(c, Mul(d, x)), Pow(Add(a, Mul(b, x)), S(-1))))), x)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule105 = ReplacementRule(pattern105, lambda c, x, d, a, q, u, p, v, b : Int(PolyLog(q + S(-1), v)*log(u)**(p + S(1))/((a + b*x)*(c + d*x)), x)/(p + S(1)) + PolyLog(q, v)*log(u)**(p + S(1))/((p + S(1))*(-a*d + b*c)))
    rubi.add(rule105)

    pattern106 = Pattern(Integral(WC('u', S(1))*log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_**S(2)*WC('h', S(1)) + x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, f, d, a, h, b: ZeroQ(-a*c*h + b*d*f)), CustomConstraint(lambda g, c, d, a, h, b: ZeroQ(-a*d*h - b*c*h + b*d*g)))
    rule106 = ReplacementRule(pattern106, lambda g, c, n, e1, a, d, f, x, n1, e, n2, h, u, p, b : b*d*Int(u*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/((a + b*x)*(c + d*x)), x)/h)
    rubi.add(rule106)

    pattern107 = Pattern(Integral(WC('u', S(1))*log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1))/(x_**S(2)*WC('h', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda d, b, c, a: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda c, f, d, a, h, b: ZeroQ(-a*c*h + b*d*f)), CustomConstraint(lambda d, b, c, a: ZeroQ(a*d + b*c)))
    rule107 = ReplacementRule(pattern107, lambda c, n, e1, a, d, f, x, n1, e, n2, h, u, p, b : b*d*Int(u*log(e*(e1*(a + b*x)**n1*(c + d*x)**(-n1))**n)**p/((a + b*x)*(c + d*x)), x)/h)
    rubi.add(rule107)

    pattern108 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))/(f_ + x_**S(2)*WC('h', S(1)) + x_*WC('g', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), )
    def With108(g, c, n, e1, a, d, x, n2, n1, e, f, h, b):
        u = IntHide(1/(f + g*x + h*x**S(2)), x)
        return -n*(-a*d + b*c)*Int(u/((a + b*x)*(c + d*x)), x) + u*log(e*(e1*(a + b*x)**n1*(c + d*x)**n2)**n)
    rule108 = ReplacementRule(pattern108, lambda g, c, n, e1, a, d, x, n2, n1, e, f, h, b : With108(g, c, n, e1, a, d, x, n2, n1, e, f, h, b))
    rubi.add(rule108)

    pattern109 = Pattern(Integral(log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))/(f_ + x_**S(2)*WC('h', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda h, x: FreeQ(h, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), )
    def With109(c, n, e1, a, d, x, n2, n1, e, f, h, b):
        u = IntHide(1/(f + h*x**S(2)), x)
        return -n*(-a*d + b*c)*Int(u/((a + b*x)*(c + d*x)), x) + u*log(e*(e1*(a + b*x)**n1*(c + d*x)**n2)**n)
    rule109 = ReplacementRule(pattern109, lambda c, n, e1, a, d, x, n2, n1, e, f, h, b : With109(c, n, e1, a, d, x, n2, n1, e, f, h, b))
    rubi.add(rule109)

    pattern110 = Pattern(Integral(RFx_*log(((x_*WC('b', S(1)) + WC('a', S(0)))**WC('n1', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**n2_*WC('e1', S(1)))**WC('n', S(1))*WC('e', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda e1, x: FreeQ(e1, x)), CustomConstraint(lambda n1, x: FreeQ(n1, x)), CustomConstraint(lambda n2, n1: ZeroQ(n1 + n2)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)), CustomConstraint(lambda u, x: SumQ(u)))
    def With110(c, n, e1, a, d, x, n2, n1, e, RFx, p, b):
        u = ExpandIntegrand(log(e*(e1*(a + b*x)**n1*(c + d*x)**n2)**n)**p, RFx, x)
        return Int(u, x)
    rule110 = ReplacementRule(pattern110, lambda c, n, e1, a, d, x, n2, n1, e, RFx, p, b : With110(c, n, e1, a, d, x, n2, n1, e, RFx, p, b))
    rubi.add(rule110)

    pattern111 = Pattern(Integral(WC('u', S(1))*log(v_)**WC('p', S(1)), x_), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda x, v: QuotientOfLinearsQ(v, x)), CustomConstraint(lambda x, v: Not(QuotientOfLinearsMatchQ(v, x))), CustomConstraint(lambda x, lst, p, u: Not(OneQ(p) & ZeroQ(Part(lst, S(3))))))
    def With111(p, x, v, u):
        lst = QuotientOfLinearsParts(v, x)
        return Int(u*log((x*Part(lst, S(2)) + Part(lst, S(1)))/(x*Part(lst, S(4)) + Part(lst, S(3))))**p, x)
    rule111 = ReplacementRule(pattern111, lambda p, x, v, u : With111(p, x, v, u))
    rubi.add(rule111)

    pattern112 = Pattern(Integral(log((x_**n_*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1))*WC('c', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule112 = ReplacementRule(pattern112, lambda c, x, a, n, p, b : -b*n*p*Int(x**n/(a + b*x**n), x) + x*log(c*(a + b*x**n)**p))
    rubi.add(rule112)

    pattern113 = Pattern(Integral(log(v_**WC('p', S(1))*WC('c', S(1))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda x, v: BinomialQ(v, x)), CustomConstraint(lambda x, v: Not(BinomialMatchQ(v, x))))
    rule113 = ReplacementRule(pattern113, lambda p, x, c, v : Int(log(c*ExpandToSum(v, x)**p), x))
    rubi.add(rule113)

    pattern114 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log((x_**n_*WC('e', S(1)) + WC('d', S(0)))**WC('p', S(1))*WC('c', S(1))))/(x_*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule114 = ReplacementRule(pattern114, lambda g, c, f, d, a, x, n, e, p, b : -b*e*n*p*Int(x**(n + S(-1))*log(f + g*x)/(d + e*x**n), x)/g + (a + b*log(c*(d + e*x**n)**p))*log(f + g*x)/g)
    rubi.add(rule114)

    pattern115 = Pattern(Integral((x_*WC('g', S(1)) + WC('f', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log((x_**n_*WC('e', S(1)) + WC('d', S(0)))**WC('p', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule115 = ReplacementRule(pattern115, lambda m, g, c, f, d, a, x, n, e, p, b : -b*e*n*p*Int(x**(n + S(-1))*(f + g*x)**(m + S(1))/(d + e*x**n), x)/(g*(m + S(1))) + (a + b*log(c*(d + e*x**n)**p))*(f + g*x)**(m + S(1))/(g*(m + S(1))))
    rubi.add(rule115)

    pattern116 = Pattern(Integral(u_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(v_**WC('p', S(1))*WC('c', S(1)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda x, u: LinearQ(u, x)), CustomConstraint(lambda x, v: BinomialQ(v, x)), CustomConstraint(lambda x, v, u: Not(BinomialMatchQ(v, x) & LinearMatchQ(u, x))))
    rule116 = ReplacementRule(pattern116, lambda m, c, x, a, u, p, v, b : Int((a + b*log(c*ExpandToSum(v, x)**p))*ExpandToSum(u, x)**m, x))
    rubi.add(rule116)

    pattern117 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log((x_**n_*WC('e', S(1)) + WC('d', S(0)))**WC('p', S(1))*WC('c', S(1))))*asin(x_*WC('g', S(1)) + WC('f', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: PositiveIntegerQ(m)), )
    def With117(m, g, c, f, a, d, x, n, e, p, b):
        w = IntHide(asin(f + g*x)**m, x)
        return -b*e*n*p*Int(SimplifyIntegrand(w*x**(n + S(-1))/(d + e*x**n), x), x) + Dist(a + b*log(c*(d + e*x**n)**p), w, x)
    rule117 = ReplacementRule(pattern117, lambda m, g, c, f, a, d, x, n, e, p, b : With117(m, g, c, f, a, d, x, n, e, p, b))
    rubi.add(rule117)

    pattern118 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log((x_**S(2)*WC('e', S(1)) + WC('d', S(0)))**WC('p', S(1))*WC('c', S(1))))/(x_**S(2)*WC('g', S(1)) + WC('f', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), )
    def With118(g, c, f, d, a, x, e, p, b):
        u = IntHide(1/(f + g*x**S(2)), x)
        return -S(2)*b*e*p*Int(u*x/(d + e*x**S(2)), x) + u*(a + b*log(c*(d + e*x**S(2))**p))
    rule118 = ReplacementRule(pattern118, lambda g, c, f, d, a, x, e, p, b : With118(g, c, f, d, a, x, e, p, b))
    rubi.add(rule118)

    pattern119 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log((d_ + x_**S(2)*WC('e', S(1)))**WC('p', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule119 = ReplacementRule(pattern119, lambda c, x, a, d, n, e, p, b : -S(2)*b*e*n*p*Int(x**S(2)*(a + b*log(c*(d + e*x**S(2))**p))**(n + S(-1))/(d + e*x**S(2)), x) + x*(a + b*log(c*(d + e*x**S(2))**p))**n)
    rubi.add(rule119)

    pattern120 = Pattern(Integral(x_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log((d_ + x_**S(2)*WC('e', S(1)))**WC('p', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)))
    rule120 = ReplacementRule(pattern120, lambda m, c, x, a, d, n, e, p, b : Subst(Int(x**(m/S(2) + S(-1)/2)*(a + b*log(c*(d + e*x)**p))**n, x), x, x**S(2))/S(2))
    rubi.add(rule120)

    pattern121 = Pattern(Integral(x_**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log((d_ + x_**S(2)*WC('e', S(1)))**WC('p', S(1))*WC('c', S(1))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: Not(IntegerQ(m/S(2) + S(-1)/2))))
    rule121 = ReplacementRule(pattern121, lambda m, c, x, a, d, n, e, p, b : -S(2)*b*e*n*p*Int(x**(m + S(2))*(a + b*log(c*(d + e*x**S(2))**p))**(n + S(-1))/(d + e*x**S(2)), x)/(m + S(1)) + x**(m + S(1))*(a + b*log(c*(d + e*x**S(2))**p))**n/(m + S(1)))
    rubi.add(rule121)

    pattern122 = Pattern(Integral(u_*log(v_), x_), CustomConstraint(lambda w, v: Not(FalseQ(w))))
    def With122(x, v, u):
        w = DerivativeDivides(v, u*(-v + S(1)), x)
        return w*PolyLog(S(2), -v + S(1))
    rule122 = ReplacementRule(pattern122, lambda x, v, u : With122(x, v, u))
    rubi.add(rule122)

    pattern123 = Pattern(Integral(w_*(WC('a', S(0)) + WC('b', S(1))*log(u_))*log(v_), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda x, u: InverseFunctionFreeQ(u, x)), CustomConstraint(lambda z, x, v, b, a, u: Not(FalseQ(z))))
    def With123(x, a, w, u, v, b):
        z = DerivativeDivides(v, w*(-v + S(1)), x)
        return -b*Int(SimplifyIntegrand(z*D(u, x)*PolyLog(S(2), -v + S(1))/u, x), x) + z*(a + b*log(u))*PolyLog(S(2), -v + S(1))
    rule123 = ReplacementRule(pattern123, lambda x, a, w, u, v, b : With123(x, a, w, u, v, b))
    rubi.add(rule123)

    pattern124 = Pattern(Integral(log((a_ + (x_*WC('e', S(1)) + WC('d', S(0)))**n_*WC('b', S(1)))**WC('p', S(1))*WC('c', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))))
    rule124 = ReplacementRule(pattern124, lambda c, x, d, a, n, e, p, b : -b*n*p*Int(1/(a*(d + e*x)**(-n) + b), x) + (d + e*x)*log(c*(a + b*(d + e*x)**n)**p)/e)
    rubi.add(rule124)

    pattern125 = Pattern(Integral(log((a_ + (x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1))*WC('b', S(1)))**WC('p', S(1))*WC('c', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: Not(RationalQ(n) & Less(n, S(0)))))
    rule125 = ReplacementRule(pattern125, lambda n, c, d, a, x, e, p, b : a*n*p*Int(1/(a + b*(d + e*x)**n), x) - n*p*x + (d + e*x)*log(c*(a + b*(d + e*x)**n)**p)/e)
    rubi.add(rule125)

    pattern126 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log((d_ + WC('e', S(1))/(x_*WC('g', S(1)) + WC('f', S(0))))**WC('p', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule126 = ReplacementRule(pattern126, lambda g, c, f, a, n, d, x, e, p, b : -b*e*n*p*Subst(Int((a + b*log(c*(d + e*x)**p))**(n + S(-1))/x, x), x, 1/(f + g*x))/(d*g) + (a + b*log(c*(d + e/(f + g*x))**p))**n*(d*(f + g*x) + e)/(d*g))
    rubi.add(rule126)

    pattern127 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(RFx_**WC('p', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule127 = ReplacementRule(pattern127, lambda n, c, a, x, RFx, p, b : -b*n*p*Int(SimplifyIntegrand(x*(a + b*log(RFx**p*c))**(n + S(-1))*D(RFx, x)/RFx, x), x) + x*(a + b*log(RFx**p*c))**n)
    rubi.add(rule127)

    pattern128 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(RFx_**WC('p', S(1))*WC('c', S(1))))**WC('n', S(1))/(x_*WC('e', S(1)) + WC('d', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule128 = ReplacementRule(pattern128, lambda n, c, a, d, x, RFx, e, p, b : -b*n*p*Int((a + b*log(RFx**p*c))**(n + S(-1))*D(RFx, x)*log(d + e*x)/RFx, x)/e + (a + b*log(RFx**p*c))**n*log(d + e*x)/e)
    rubi.add(rule128)

    pattern129 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1))*(WC('a', S(0)) + WC('b', S(1))*log(RFx_**WC('p', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m, n: IntegerQ(m) | Equal(n, S(1))), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule129 = ReplacementRule(pattern129, lambda m, n, c, a, d, x, RFx, e, p, b : -b*n*p*Int(SimplifyIntegrand((a + b*log(RFx**p*c))**(n + S(-1))*(d + e*x)**(m + S(1))*D(RFx, x)/RFx, x), x)/(e*(m + S(1))) + (a + b*log(RFx**p*c))**n*(d + e*x)**(m + S(1))/(e*(m + S(1))))
    rubi.add(rule129)

    pattern130 = Pattern(Integral(log(RFx_**WC('n', S(1))*WC('c', S(1)))/(d_ + x_**S(2)*WC('e', S(1))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda RFx, x: Not(PolynomialQ(RFx, x))), )
    def With130(n, c, d, x, RFx, e):
        u = IntHide(1/(d + e*x**S(2)), x)
        return -n*Int(SimplifyIntegrand(u*D(RFx, x)/RFx, x), x) + u*log(RFx**n*c)
    rule130 = ReplacementRule(pattern130, lambda n, c, d, x, RFx, e : With130(n, c, d, x, RFx, e))
    rubi.add(rule130)

    pattern131 = Pattern(Integral(log(Px_**WC('n', S(1))*WC('c', S(1)))/Qx_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda Qx, x, Px: QuadraticQ(List(Qx, Px), x)), CustomConstraint(lambda Qx, x, Px: ZeroQ(D(Px/Qx, x))), )
    def With131(n, x, c, Qx, Px):
        u = IntHide(1/Qx, x)
        return -n*Int(SimplifyIntegrand(u*D(Px, x)/Px, x), x) + u*log(Px**n*c)
    rule131 = ReplacementRule(pattern131, lambda n, x, c, Qx, Px : With131(n, x, c, Qx, Px))
    rubi.add(rule131)

    pattern132 = Pattern(Integral(RGx_*(WC('a', S(0)) + WC('b', S(1))*log(RFx_**WC('p', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda x, RGx: RationalFunctionQ(RGx, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda u, x: SumQ(u)))
    def With132(n, c, a, x, RFx, RGx, p, b):
        u = ExpandIntegrand((a + b*log(RFx**p*c))**n, RGx, x)
        return Int(u, x)
    rule132 = ReplacementRule(pattern132, lambda n, c, a, x, RFx, RGx, p, b : With132(n, c, a, x, RFx, RGx, p, b))
    rubi.add(rule132)

    pattern133 = Pattern(Integral(RGx_*(WC('a', S(0)) + WC('b', S(1))*log(RFx_**WC('p', S(1))*WC('c', S(1))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda x, RGx: RationalFunctionQ(RGx, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda u, x: SumQ(u)))
    def With133(n, c, a, x, RFx, RGx, p, b):
        u = ExpandIntegrand(RGx*(a + b*log(RFx**p*c))**n, x)
        return Int(u, x)
    rule133 = ReplacementRule(pattern133, lambda n, c, a, x, RFx, RGx, p, b : With133(n, c, a, x, RFx, RGx, p, b))
    rubi.add(rule133)

    pattern134 = Pattern(Integral(RFx_*(WC('a', S(0)) + WC('b', S(1))*log(u_)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda RFx, x: RationalFunctionQ(RFx, x)), CustomConstraint(lambda x, lst: Not(FalseQ(lst))))
    def With134(x, a, RFx, u, b):
        lst = SubstForFractionalPowerOfLinear(RFx*(a + b*log(u)), x)
        return Part(lst, S(2))*Part(lst, S(4))*Subst(Int(Part(lst, S(1)), x), x, Part(lst, S(3))**(1/Part(lst, S(2))))
    rule134 = ReplacementRule(pattern134, lambda x, a, RFx, u, b : With134(x, a, RFx, u, b))
    rubi.add(rule134)

    pattern135 = Pattern(Integral((x_*WC('g', S(1)) + WC('f', S(0)))**WC('m', S(1))*log((F_**((x_*WC('b', S(1)) + WC('a', S(0)))*WC('c', S(1))))**WC('n', S(1))*WC('e', S(1)) + S(1)), x_), CustomConstraint(lambda F, x: FreeQ(F, x)), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule135 = ReplacementRule(pattern135, lambda m, g, n, c, a, f, F, x, e, b : g*m*Int((f + g*x)**(m + S(-1))*PolyLog(S(2), -e*(F**(c*(a + b*x)))**n), x)/(b*c*n*log(F)) - (f + g*x)**m*PolyLog(S(2), -e*(F**(c*(a + b*x)))**n)/(b*c*n*log(F)))
    rubi.add(rule135)

    pattern136 = Pattern(Integral((x_*WC('g', S(1)) + WC('f', S(0)))**WC('m', S(1))*log(d_ + (F_**((x_*WC('b', S(1)) + WC('a', S(0)))*WC('c', S(1))))**WC('n', S(1))*WC('e', S(1))), x_), CustomConstraint(lambda F, x: FreeQ(F, x)), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda d: NonzeroQ(d + S(-1))))
    rule136 = ReplacementRule(pattern136, lambda m, g, n, c, a, f, d, F, x, e, b : Int((f + g*x)**m*log(S(1) + e*(F**(c*(a + b*x)))**n/d), x) - (f + g*x)**(m + S(1))*log(S(1) + e*(F**(c*(a + b*x)))**n/d)/(g*(m + S(1))) + (f + g*x)**(m + S(1))*log(d + e*(F**(c*(a + b*x)))**n)/(g*(m + S(1))))
    rubi.add(rule136)

    pattern137 = Pattern(Integral(log(x_*WC('e', S(1)) + sqrt(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))*WC('f', S(1)) + WC('d', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, c, f: ZeroQ(-c*f**S(2) + e**S(2))))
    rule137 = ReplacementRule(pattern137, lambda f, c, d, a, x, e, b : f**S(2)*(-S(2)*a*c + b**S(2)/S(2))*Int(x/(-f*sqrt(a + b*x + c*x**S(2))*(-S(2)*a*e + b*d + x*(-b*e + S(2)*c*d)) + (-b*f**S(2) + S(2)*d*e)*(a + b*x + c*x**S(2))), x) + x*log(d + e*x + f*sqrt(a + b*x + c*x**S(2))))
    rubi.add(rule137)

    pattern138 = Pattern(Integral(log(x_*WC('e', S(1)) + sqrt(x_**S(2)*WC('c', S(1)) + WC('a', S(0)))*WC('f', S(1)) + WC('d', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, c, f: ZeroQ(-c*f**S(2) + e**S(2))))
    rule138 = ReplacementRule(pattern138, lambda c, f, d, a, x, e : -a*c*f**S(2)*Int(x/(d*e*(a + c*x**S(2)) + f*sqrt(a + c*x**S(2))*(a*e - c*d*x)), x) + x*log(d + e*x + f*sqrt(a + c*x**S(2))))
    rubi.add(rule138)

    pattern139 = Pattern(Integral((x_*WC('g', S(1)))**WC('m', S(1))*log(x_*WC('e', S(1)) + sqrt(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))*WC('f', S(1)) + WC('d', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda e, c, f: ZeroQ(-c*f**S(2) + e**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule139 = ReplacementRule(pattern139, lambda m, g, f, c, d, a, x, e, b : f**S(2)*(-S(4)*a*c + b**S(2))*Int((g*x)**(m + S(1))/(-f*sqrt(a + b*x + c*x**S(2))*(-S(2)*a*e + b*d + x*(-b*e + S(2)*c*d)) + (-b*f**S(2) + S(2)*d*e)*(a + b*x + c*x**S(2))), x)/(S(2)*g*(m + S(1))) + (g*x)**(m + S(1))*log(d + e*x + f*sqrt(a + b*x + c*x**S(2)))/(g*(m + S(1))))
    rubi.add(rule139)

    pattern140 = Pattern(Integral((x_*WC('g', S(1)))**WC('m', S(1))*log(x_*WC('e', S(1)) + sqrt(x_**S(2)*WC('c', S(1)) + WC('a', S(0)))*WC('f', S(1)) + WC('d', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda e, c, f: ZeroQ(-c*f**S(2) + e**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule140 = ReplacementRule(pattern140, lambda m, g, c, f, d, a, x, e : -a*c*f**S(2)*Int((g*x)**(m + S(1))/(d*e*(a + c*x**S(2)) + f*sqrt(a + c*x**S(2))*(a*e - c*d*x)), x)/(g*(m + S(1))) + (g*x)**(m + S(1))*log(d + e*x + f*sqrt(a + c*x**S(2)))/(g*(m + S(1))))
    rubi.add(rule140)

    pattern141 = Pattern(Integral(WC('v', S(1))*log(sqrt(u_)*WC('f', S(1)) + x_*WC('e', S(1)) + WC('d', S(0))), x_), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda x, u: QuadraticQ(u, x)), CustomConstraint(lambda x, u: Not(QuadraticMatchQ(u, x))), CustomConstraint(lambda x, v: ZeroQ(v + S(-1)) | MatchQ(v, Condition((x*Optional(Pattern(g, Blank)))**Optional(Pattern(m, Blank))))))
    rule141 = ReplacementRule(pattern141, lambda f, x, d, e, u, v : Int(v*log(d + e*x + f*sqrt(ExpandToSum(u, x))), x))
    rubi.add(rule141)

    pattern142 = Pattern(Integral(log(u_), x_), CustomConstraint(lambda x, u: InverseFunctionFreeQ(u, x)))
    rule142 = ReplacementRule(pattern142, lambda x, u : x*log(u) - Int(SimplifyIntegrand(x*D(u, x)/u, x), x))
    rubi.add(rule142)

    pattern143 = Pattern(Integral(log(u_)/(x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda x, u: RationalFunctionQ(D(u, x)/u, x)), CustomConstraint(lambda x, a, u: NonzeroQ(a) | Not(BinomialQ(u, x) & ZeroQ(BinomialDegree(u, x)**S(2) + S(-1)))))
    rule143 = ReplacementRule(pattern143, lambda b, x, a, u : -Int(SimplifyIntegrand(D(u, x)*log(a + b*x)/u, x), x)/b + log(u)*log(a + b*x)/b)
    rubi.add(rule143)

    pattern144 = Pattern(Integral((x_*WC('b', S(1)) + WC('a', S(0)))**WC('m', S(1))*log(u_), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda x, u: InverseFunctionFreeQ(u, x)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule144 = ReplacementRule(pattern144, lambda m, x, a, u, b : (a + b*x)**(m + S(1))*log(u)/(b*(m + S(1))) - Int(SimplifyIntegrand((a + b*x)**(m + S(1))*D(u, x)/u, x), x)/(b*(m + S(1))))
    rubi.add(rule144)

    pattern145 = Pattern(Integral(log(u_)/Qx_, x_), CustomConstraint(lambda Qx, x: QuadraticQ(Qx, x)), CustomConstraint(lambda x, u: InverseFunctionFreeQ(u, x)), )
    def With145(Qx, x, u):
        v = IntHide(1/Qx, x)
        return v*log(u) - Int(SimplifyIntegrand(v*D(u, x)/u, x), x)
    rule145 = ReplacementRule(pattern145, lambda Qx, x, u : With145(Qx, x, u))
    rubi.add(rule145)

    pattern146 = Pattern(Integral(u_**(x_*WC('a', S(1)))*log(u_), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda x, u: InverseFunctionFreeQ(u, x)))
    rule146 = ReplacementRule(pattern146, lambda x, a, u : -Int(SimplifyIntegrand(u**(a*x + S(-1))*x*D(u, x), x), x) + u**(a*x)/a)
    rubi.add(rule146)

    pattern147 = Pattern(Integral(v_*log(u_), x_), CustomConstraint(lambda x, u: InverseFunctionFreeQ(u, x)), CustomConstraint(lambda x, w, u: InverseFunctionFreeQ(w, x)))
    def With147(x, v, u):
        w = IntHide(v, x)
        return Dist(log(u), w, x) - Int(SimplifyIntegrand(w*D(u, x)/u, x), x)
    rule147 = ReplacementRule(pattern147, lambda x, v, u : With147(x, v, u))
    rubi.add(rule147)

    pattern148 = Pattern(Integral(log(v_)*log(w_), x_), CustomConstraint(lambda x, v: InverseFunctionFreeQ(v, x)), CustomConstraint(lambda x, w: InverseFunctionFreeQ(w, x)))
    rule148 = ReplacementRule(pattern148, lambda x, w, v : x*log(v)*log(w) - Int(SimplifyIntegrand(x*D(v, x)*log(w)/v, x), x) - Int(SimplifyIntegrand(x*D(w, x)*log(v)/w, x), x))
    rubi.add(rule148)

    pattern149 = Pattern(Integral(u_*log(v_)*log(w_), x_), CustomConstraint(lambda x, v: InverseFunctionFreeQ(v, x)), CustomConstraint(lambda x, w: InverseFunctionFreeQ(w, x)), CustomConstraint(lambda z, x, v, w: InverseFunctionFreeQ(z, x)))
    def With149(x, w, v, u):
        z = IntHide(u, x)
        return Dist(log(v)*log(w), z, x) - Int(SimplifyIntegrand(z*D(v, x)*log(w)/v, x), x) - Int(SimplifyIntegrand(z*D(w, x)*log(v)/w, x), x)
    rule149 = ReplacementRule(pattern149, lambda x, w, v, u : With149(x, w, v, u))
    rubi.add(rule149)

    pattern150 = Pattern(Integral(log(WC('a', S(1))*log(x_**WC('n', S(1))*WC('b', S(1)))**WC('p', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule150 = ReplacementRule(pattern150, lambda n, x, a, p, b : -n*p*Int(1/log(b*x**n), x) + x*log(a*log(b*x**n)**p))
    rubi.add(rule150)

    pattern151 = Pattern(Integral(log(WC('a', S(1))*log(x_**WC('n', S(1))*WC('b', S(1)))**WC('p', S(1)))/x_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule151 = ReplacementRule(pattern151, lambda n, x, a, p, b : (-p + log(a*log(b*x**n)**p))*log(b*x**n)/n)
    rubi.add(rule151)

    pattern152 = Pattern(Integral(x_**WC('m', S(1))*log(WC('a', S(1))*log(x_**WC('n', S(1))*WC('b', S(1)))**WC('p', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule152 = ReplacementRule(pattern152, lambda m, n, x, a, p, b : -n*p*Int(x**m/log(b*x**n), x)/(m + S(1)) + x**(m + S(1))*log(a*log(b*x**n)**p)/(m + S(1)))
    rubi.add(rule152)

    pattern153 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*log(x_*WC('d', S(1)) + WC('c', S(0))))/sqrt(a_ + WC('b', S(1))*log(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b, B, A, a: NonzeroQ(A*b - B*a)))
    rule153 = ReplacementRule(pattern153, lambda A, c, x, d, a, B, b : B*Int(sqrt(a + b*log(c + d*x)), x)/b + (A*b - B*a)*Int(1/sqrt(a + b*log(c + d*x)), x)/b)
    rubi.add(rule153)

    pattern154 = Pattern(Integral(f_**(WC('a', S(1))*log(u_)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule154 = ReplacementRule(pattern154, lambda x, f, a, u : Int(u**(a*log(f)), x))
    rubi.add(rule154)

    pattern155 = Pattern(Integral(u_, x_), CustomConstraint(lambda u: NonsumQ(u)), CustomConstraint(lambda x, lst: Not(FalseQ(lst))))
    def With155(x, u):
        lst = FunctionOfLog(u*x, x)
        return Subst(Int(Part(lst, S(1)), x), x, log(Part(lst, S(2))))/Part(lst, S(3))
    rule155 = ReplacementRule(pattern155, lambda x, u : With155(x, u))
    #rubi.add(rule155)

    pattern156 = Pattern(Integral(WC('u', S(1))*log(Gamma(v_)), x_))
    rule156 = ReplacementRule(pattern156, lambda x, v, u : (-LogGamma(v) + log(Gamma(v)))*Int(u, x) + Int(u*LogGamma(v), x))
    rubi.add(rule156)

    pattern157 = Pattern(Integral((w_*WC('a', S(1)) + w_*WC('b', S(1))*log(v_)**WC('n', S(1)))**WC('p', S(1))*WC('u', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)))
    rule157 = ReplacementRule(pattern157, lambda n, x, a, w, u, p, v, b : Int(u*w**p*(a + b*log(v)**n)**p, x))
    rubi.add(rule157)

    pattern158 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*log(((x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1))*WC('d', S(1)))**WC('q', S(1))*WC('c', S(1))))**n_*WC('u', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda q, x: FreeQ(q, x)), CustomConstraint(lambda x, u: AlgebraicFunctionQ(u, x)))
    rule158 = ReplacementRule(pattern158, lambda c, f, d, a, q, x, n, e, u, p, b : Int(u*(a + b*log(c*(d*(e + f*x)**p)**q))**n, x))
    rubi.add(rule158)

    return rubi
